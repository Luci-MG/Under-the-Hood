
<!doctype html>
<html lang="en" class="no-js">
  <head>
    
      <meta charset="utf-8">
      <meta name="viewport" content="width=device-width,initial-scale=1">
      
        <meta name="description" content="Dive deep into tech with in-depth explorations of patterns, languages, distributed systems, databases, their concepts and more all in one place.">
      
      
        <meta name="author" content="Mrudhul Guda">
      
      
        <link rel="canonical" href="https://luci-mg.github.io/Under-the-Hood/techdives/DistrubutedSystems/ElasticSearch/">
      
      
        <link rel="prev" href="../Kafka/">
      
      
        <link rel="next" href="../Redis/">
      
      
      <link rel="icon" href="../../../assets/favicon.png">
      <meta name="generator" content="mkdocs-1.6.1, mkdocs-material-9.5.49">
    
    
      
        <title>Elasticsearch - Under the Hood</title>
      
    
    
      <link rel="stylesheet" href="../../../assets/stylesheets/main.6f8fc17f.min.css">
      
        
        <link rel="stylesheet" href="../../../assets/stylesheets/palette.06af60db.min.css">
      
      


    
    
      
    
    
      
        
        
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
        <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Noto+Sans+Oriya:300,300i,400,400i,700,700i%7CNoto+Sans+Mono:400,400i,700,700i&display=fallback">
        <style>:root{--md-text-font:"Noto Sans Oriya";--md-code-font:"Noto Sans Mono"}</style>
      
    
    
    <script>__md_scope=new URL("../../..",location),__md_hash=e=>[...e].reduce(((e,_)=>(e<<5)-e+_.charCodeAt(0)),0),__md_get=(e,_=localStorage,t=__md_scope)=>JSON.parse(_.getItem(t.pathname+"."+e)),__md_set=(e,_,t=localStorage,a=__md_scope)=>{try{t.setItem(a.pathname+"."+e,JSON.stringify(_))}catch(e){}}</script>
    
      

    
    
    
  <link rel="stylesheet" href="../../../assets/stylesheets/custom.7c86dd97.min.css">

  </head>
  
  
    
    
      
    
    
    
    
    <body dir="ltr" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo">
  
    
    <input class="md-toggle" data-md-toggle="drawer" type="checkbox" id="__drawer" autocomplete="off">
    <input class="md-toggle" data-md-toggle="search" type="checkbox" id="__search" autocomplete="off">
    <label class="md-overlay" for="__drawer"></label>
    <div data-md-component="skip">
      
        
        <a href="#elasticsearch" class="md-skip">
          Skip to content
        </a>
      
    </div>
    <div data-md-component="announce">
      
    </div>
    
      <div data-md-color-scheme="default" data-md-component="outdated" hidden>
        
      </div>
    
    
      

<header class="md-header" data-md-component="header">
  <nav class="md-header__inner md-grid" aria-label="Header">
    <a href="../../.." title="Under the Hood" class="md-header__button md-logo" aria-label="Under the Hood" data-md-component="logo">
      
  <img src="../../../assets/favicon.png" alt="logo">

    </a>
    <label class="md-header__button md-icon" for="__drawer">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M3 6h18v2H3zm0 5h18v2H3zm0 5h18v2H3z"/></svg>
    </label>
    <div class="md-header__title" data-md-component="header-title">
      <div class="md-header__ellipsis">
        <div class="md-header__topic">
          <a href="../../..">
            <span class="md-ellipsis">
              Under the Hood
            </span>
          </a>
        </div>
        <div class="md-header__topic" data-md-component="header-topic">
          <span class="md-ellipsis">
            
              Elasticsearch
            
          </span>
        </div>
      </div>
    </div>
    
      
        <form class="md-header__option" data-md-component="palette">
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme)" data-md-color-scheme="default" data-md-color-primary="indigo" data-md-color-accent="indigo"  aria-label="Switch to light mode"  type="radio" name="__palette" id="__palette_0">
    
      <label class="md-header__button md-icon" title="Switch to light mode" for="__palette_1" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m14.3 16-.7-2h-3.2l-.7 2H7.8L11 7h2l3.2 9zM20 8.69V4h-4.69L12 .69 8.69 4H4v4.69L.69 12 4 15.31V20h4.69L12 23.31 15.31 20H20v-4.69L23.31 12zm-9.15 3.96h2.3L12 9z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: light)" data-md-color-scheme="default" data-md-color-primary="teal" data-md-color-accent="teal"  aria-label="Switch to dark mode"  type="radio" name="__palette" id="__palette_1">
    
      <label class="md-header__button md-icon" title="Switch to dark mode" for="__palette_2" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 7a5 5 0 0 1 5 5 5 5 0 0 1-5 5 5 5 0 0 1-5-5 5 5 0 0 1 5-5m0 2a3 3 0 0 0-3 3 3 3 0 0 0 3 3 3 3 0 0 0 3-3 3 3 0 0 0-3-3m0-7 2.39 3.42C13.65 5.15 12.84 5 12 5s-1.65.15-2.39.42zM3.34 7l4.16-.35A7.2 7.2 0 0 0 5.94 8.5c-.44.74-.69 1.5-.83 2.29zm.02 10 1.76-3.77a7.131 7.131 0 0 0 2.38 4.14zM20.65 7l-1.77 3.79a7.02 7.02 0 0 0-2.38-4.15zm-.01 10-4.14.36c.59-.51 1.12-1.14 1.54-1.86.42-.73.69-1.5.83-2.29zM12 22l-2.41-3.44c.74.27 1.55.44 2.41.44.82 0 1.63-.17 2.37-.44z"/></svg>
      </label>
    
  
    
    
    
    <input class="md-option" data-md-color-media="(prefers-color-scheme: dark)" data-md-color-scheme="slate" data-md-color-primary="black" data-md-color-accent="indigo"  aria-label="Switch to system preference"  type="radio" name="__palette" id="__palette_2">
    
      <label class="md-header__button md-icon" title="Switch to system preference" for="__palette_0" hidden>
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="m17.75 4.09-2.53 1.94.91 3.06-2.63-1.81-2.63 1.81.91-3.06-2.53-1.94L12.44 4l1.06-3 1.06 3zm3.5 6.91-1.64 1.25.59 1.98-1.7-1.17-1.7 1.17.59-1.98L15.75 11l2.06-.05L18.5 9l.69 1.95zm-2.28 4.95c.83-.08 1.72 1.1 1.19 1.85-.32.45-.66.87-1.08 1.27C15.17 23 8.84 23 4.94 19.07c-3.91-3.9-3.91-10.24 0-14.14.4-.4.82-.76 1.27-1.08.75-.53 1.93.36 1.85 1.19-.27 2.86.69 5.83 2.89 8.02a9.96 9.96 0 0 0 8.02 2.89m-1.64 2.02a12.08 12.08 0 0 1-7.8-3.47c-2.17-2.19-3.33-5-3.49-7.82-2.81 3.14-2.7 7.96.31 10.98 3.02 3.01 7.84 3.12 10.98.31"/></svg>
      </label>
    
  
</form>
      
    
    
      <script>var palette=__md_get("__palette");if(palette&&palette.color){if("(prefers-color-scheme)"===palette.color.media){var media=matchMedia("(prefers-color-scheme: light)"),input=document.querySelector(media.matches?"[data-md-color-media='(prefers-color-scheme: light)']":"[data-md-color-media='(prefers-color-scheme: dark)']");palette.color.media=input.getAttribute("data-md-color-media"),palette.color.scheme=input.getAttribute("data-md-color-scheme"),palette.color.primary=input.getAttribute("data-md-color-primary"),palette.color.accent=input.getAttribute("data-md-color-accent")}for(var[key,value]of Object.entries(palette.color))document.body.setAttribute("data-md-color-"+key,value)}</script>
    
    
    
      <label class="md-header__button md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
      </label>
      <div class="md-search" data-md-component="search" role="dialog">
  <label class="md-search__overlay" for="__search"></label>
  <div class="md-search__inner" role="search">
    <form class="md-search__form" name="search">
      <input type="text" class="md-search__input" name="query" aria-label="Search" placeholder="Search" autocapitalize="off" autocorrect="off" autocomplete="off" spellcheck="false" data-md-component="search-query" required>
      <label class="md-search__icon md-icon" for="__search">
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M9.5 3A6.5 6.5 0 0 1 16 9.5c0 1.61-.59 3.09-1.56 4.23l.27.27h.79l5 5-1.5 1.5-5-5v-.79l-.27-.27A6.52 6.52 0 0 1 9.5 16 6.5 6.5 0 0 1 3 9.5 6.5 6.5 0 0 1 9.5 3m0 2C7 5 5 7 5 9.5S7 14 9.5 14 14 12 14 9.5 12 5 9.5 5"/></svg>
        
        <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
      </label>
      <nav class="md-search__options" aria-label="Search">
        
          <a href="javascript:void(0)" class="md-search__icon md-icon" title="Share" aria-label="Share" data-clipboard data-clipboard-text="" data-md-component="search-share" tabindex="-1">
            
            <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M18 16.08c-.76 0-1.44.3-1.96.77L8.91 12.7c.05-.23.09-.46.09-.7s-.04-.47-.09-.7l7.05-4.11c.54.5 1.25.81 2.04.81a3 3 0 0 0 3-3 3 3 0 0 0-3-3 3 3 0 0 0-3 3c0 .24.04.47.09.7L8.04 9.81C7.5 9.31 6.79 9 6 9a3 3 0 0 0-3 3 3 3 0 0 0 3 3c.79 0 1.5-.31 2.04-.81l7.12 4.15c-.05.21-.08.43-.08.66 0 1.61 1.31 2.91 2.92 2.91s2.92-1.3 2.92-2.91A2.92 2.92 0 0 0 18 16.08"/></svg>
          </a>
        
        <button type="reset" class="md-search__icon md-icon" title="Clear" aria-label="Clear" tabindex="-1">
          
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M19 6.41 17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
        </button>
      </nav>
      
        <div class="md-search__suggest" data-md-component="search-suggest"></div>
      
    </form>
    <div class="md-search__output">
      <div class="md-search__scrollwrap" tabindex="0" data-md-scrollfix>
        <div class="md-search-result" data-md-component="search-result">
          <div class="md-search-result__meta">
            Initializing search
          </div>
          <ol class="md-search-result__list" role="presentation"></ol>
        </div>
      </div>
    </div>
  </div>
</div>
    
    
      <div class="md-header__source">
        <a href="https://github.com/Luci-MG/Under-the-Hood" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Luci-MG/Under-the-Hood
  </div>
</a>
      </div>
    
  </nav>
  
</header>
    
    <div class="md-container" data-md-component="container">
      
      
        
          
            
<nav class="md-tabs" aria-label="Tabs" data-md-component="tabs">
  <div class="md-grid">
    <ul class="md-tabs__list">
      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../.." class="md-tabs__link">
        
  
    
  
  Home

      </a>
    </li>
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../fundamentaldives/FundamentalConcepts/ConcurrencyParallelism/" class="md-tabs__link">
          
  
    
  
  Fundamental Dives

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../langdives/Java/JDK-JRE-JVM/" class="md-tabs__link">
          
  
    
  
  Language Dives

        </a>
      </li>
    
  

    
  

      
        
  
  
    
  
  
    
    
      
  
  
    
  
  
    
    
      <li class="md-tabs__item md-tabs__item--active">
        <a href="../../GeneralConcepts/git/" class="md-tabs__link">
          
  
    
  
  Tech Dives

        </a>
      </li>
    
  

    
  

      
        
  
  
  
    
    
      <li class="md-tabs__item">
        <a href="../../../blog/" class="md-tabs__link">
          
  
    
  
  Blog

        </a>
      </li>
    
  

      
        
  
  
  
    <li class="md-tabs__item">
      <a href="../../../changelog/" class="md-tabs__link">
        
  
    
  
  Change Log

      </a>
    </li>
  

      
    </ul>
  </div>
</nav>
          
        
      
      <main class="md-main" data-md-component="main">
        <div class="md-main__inner md-grid">
          
            
              
              <div class="md-sidebar md-sidebar--primary" data-md-component="sidebar" data-md-type="navigation" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    


  


<nav class="md-nav md-nav--primary md-nav--lifted" aria-label="Navigation" data-md-level="0">
  <label class="md-nav__title" for="__drawer">
    <a href="../../.." title="Under the Hood" class="md-nav__button md-logo" aria-label="Under the Hood" data-md-component="logo">
      
  <img src="../../../assets/favicon.png" alt="logo">

    </a>
    Under the Hood
  </label>
  
    <div class="md-nav__source">
      <a href="https://github.com/Luci-MG/Under-the-Hood" title="Go to repository" class="md-source" data-md-component="source">
  <div class="md-source__icon md-icon">
    
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M439.55 236.05 244 40.45a28.87 28.87 0 0 0-40.81 0l-40.66 40.63 51.52 51.52c27.06-9.14 52.68 16.77 43.39 43.68l49.66 49.66c34.23-11.8 61.18 31 35.47 56.69-26.49 26.49-70.21-2.87-56-37.34L240.22 199v121.85c25.3 12.54 22.26 41.85 9.08 55a34.34 34.34 0 0 1-48.55 0c-17.57-17.6-11.07-46.91 11.25-56v-123c-20.8-8.51-24.6-30.74-18.64-45L142.57 101 8.45 235.14a28.86 28.86 0 0 0 0 40.81l195.61 195.6a28.86 28.86 0 0 0 40.8 0l194.69-194.69a28.86 28.86 0 0 0 0-40.81"/></svg>
  </div>
  <div class="md-source__repository">
    Luci-MG/Under-the-Hood
  </div>
</a>
    </div>
  
  <ul class="md-nav__list" data-md-scrollfix>
    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Home
  </span>
  

      </a>
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2" >
        
          
          <label class="md-nav__link" for="__nav_2" id="__nav_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Fundamental Dives
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2">
            <span class="md-nav__icon md-icon"></span>
            Fundamental Dives
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_1" >
        
          
          <label class="md-nav__link" for="__nav_2_1" id="__nav_2_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Fundamental Concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_1">
            <span class="md-nav__icon md-icon"></span>
            Fundamental Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/FundamentalConcepts/ConcurrencyParallelism/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Concurrency and Parallelism
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_2" >
        
          
          <label class="md-nav__link" for="__nav_2_2" id="__nav_2_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Fundamental Principles
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_2">
            <span class="md-nav__icon md-icon"></span>
            Fundamental Principles
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/FundamentalPrinciples/SOLID/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    SOLID
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/FundamentalPrinciples/KISS/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    KISS
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/FundamentalPrinciples/DRY/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DRY
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/FundamentalPrinciples/YAGNI/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    YAGNI
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_2_3" >
        
          
          <label class="md-nav__link" for="__nav_2_3" id="__nav_2_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Design Patterns
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_2_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_2_3">
            <span class="md-nav__icon md-icon"></span>
            Design Patterns
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Singleton/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Singleton
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/FactoryMethod/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Factory Method
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/AbstractFactory/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Abstract Factory
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Builder/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Builder
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Prototype/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Prototype
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Adapter/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Adapter
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Bridge/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Bridge
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Composite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Composite
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Decorator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Decorater
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Facade/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Facade
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Iterator/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Iterator
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/Strategy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Strategy
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../fundamentaldives/DesignPatterns/CircuitBreakers/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Circuit Breakers
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3" >
        
          
          <label class="md-nav__link" for="__nav_3" id="__nav_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Language Dives
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_3_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3">
            <span class="md-nav__icon md-icon"></span>
            Language Dives
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_1" >
        
          
          <label class="md-nav__link" for="__nav_3_1" id="__nav_3_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Java
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_1">
            <span class="md-nav__icon md-icon"></span>
            Java
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/JDK-JRE-JVM/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    JDK, JRE, JVM
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Maven/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maven
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Gradle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Gradle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/MavenVsGradle/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Maven vs Gradle
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/MemoryModel/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Memory Model
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/4Pillars/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    4 Pillars
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/AccessModifPPPPP/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Access modifiers
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/KeyWordsTerminolgies/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Keywords/Terminologies
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/PrimitiveReferenceTypes/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Primitives References
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/ReferenceTypesInDepth/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reference Types Indepth
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/JavaPassBy/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Pass By Value
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Collections-JCF/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Collections JCF
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/StreamsLambdas/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Streams and Lambas
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Threads/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threads
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Threads-Atomicity/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Threads - Atomicity
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/ThreadPools/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thread Pools
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/ThreadPoolTuning/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Thread Pool Tuning
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Locking-Intrinsic/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intrinsic Locking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Locking-Reentrant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Reentrant Locking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/LockingIntrinsicReentrant/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Intrinsic vs Reentrant Locking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Locking-ReentrantReadWrite/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    ReentrantRW Locking
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Locking-Issues-DeadLock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    DeadLock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Locking-Issues-LiveLock/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    LiveLock
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Locking-Issues-Starvation/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Starvation
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Locking-Issues-Others/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Other Locking issues
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/GarbageCollection/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Garbage Collection(rs)
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Java8vs11vs17vs21/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Java 8 vs 11 vs 17 vs 21
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
          
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_3_2" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../langdives/Java/Spring/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Spring
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_3_2" id="__nav_3_2_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_3_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_3_2">
            <span class="md-nav__icon md-icon"></span>
            Spring
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Spring/SpringCoreFramework/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring Core Framework
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Spring/SpringBoot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring Boot
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Spring/SpringAnnotations/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring Boot Annotations
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../langdives/Java/Spring/SpringFrameworkVsSpringBoot/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Spring Framework vs Boot
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
    
    
      
        
        
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--section md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4" checked>
        
          
          <label class="md-nav__link" for="__nav_4" id="__nav_4_label" tabindex="">
            
  
  <span class="md-ellipsis">
    Tech Dives
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_4_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4">
            <span class="md-nav__icon md-icon"></span>
            Tech Dives
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_1" >
        
          
          <label class="md-nav__link" for="__nav_4_1" id="__nav_4_1_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    General Concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_1_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_1">
            <span class="md-nav__icon md-icon"></span>
            General Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../GeneralConcepts/git/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Git
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    
    
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_4_2" >
        
          
          <label class="md-nav__link" for="__nav_4_2" id="__nav_4_2_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Distributed Concepts
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_2_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_4_2">
            <span class="md-nav__icon md-icon"></span>
            Distributed Concepts
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../DistrubutedConcepts/HighAvailabilityFaultTolerance/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    High Availability and Fault Tolerance
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
              
                
  
  
    
  
  
  
    
    
      
        
      
        
      
        
      
        
      
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--active md-nav__item--nested">
      
        
        
        <input class="md-nav__toggle md-toggle " type="checkbox" id="__nav_4_3" checked>
        
          
          <label class="md-nav__link" for="__nav_4_3" id="__nav_4_3_label" tabindex="0">
            
  
  <span class="md-ellipsis">
    Distributed Systems
  </span>
  

            <span class="md-nav__icon md-icon"></span>
          </label>
        
        <nav class="md-nav" data-md-level="2" aria-labelledby="__nav_4_3_label" aria-expanded="true">
          <label class="md-nav__title" for="__nav_4_3">
            <span class="md-nav__icon md-icon"></span>
            Distributed Systems
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../DockerAndK8s/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Docker & K8s
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../S3/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Simple Storage Service - S3
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Kafka/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Kafka
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
    
  
  
  
    <li class="md-nav__item md-nav__item--active">
      
      <input class="md-nav__toggle md-toggle" type="checkbox" id="__toc">
      
      
        
      
      
        <label class="md-nav__link md-nav__link--active" for="__toc">
          
  
  <span class="md-ellipsis">
    Elasticsearch
  </span>
  

          <span class="md-nav__icon md-icon"></span>
        </label>
      
      <a href="./" class="md-nav__link md-nav__link--active">
        
  
  <span class="md-ellipsis">
    Elasticsearch
  </span>
  

      </a>
      
        

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elasticsearch-basics-and-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      ElasticSearch Basics and Fundamentals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ElasticSearch Basics and Fundamentals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      1. Core Concepts:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-documents-and-indices" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Documents and Indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-mapping-and-types" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Mapping and Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-shards-and-replicas" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Shards and Replicas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-cluster-nodes-and-roles" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 Cluster, Nodes, and Roles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-elasticsearch-api-actions-crud" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 Elasticsearch API Actions (CRUD)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-the-core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of the Core Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      2. Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#21-core-structure-of-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. Core Structure of Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-building-the-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. Building the Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-how-searches-work" class="md-nav__link">
    <span class="md-ellipsis">
      2.3. How Searches Work
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      2.4. Optimizations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      2.5. Benefits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-the-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of the Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      3. Analyzers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-what-is-an-analyzer" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. What is an Analyzer?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-components-of-an-analyzer" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Components of an Analyzer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-built-in-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      3.3. Built-in Analyzers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-custom-analyzer-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      3.4. Custom Analyzer Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-usage-during-indexing-and-querying" class="md-nav__link">
    <span class="md-ellipsis">
      3.5. Usage During Indexing and Querying
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-practical-applications-of-custom-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      3.6. Practical Applications of Custom Analyzers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37-benefits-of-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      3.7. Benefits of Analyzers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Analyzers.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-elasticsearch-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4. ElasticSearch Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#41-leaf-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Leaf Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#411-match-queries-for-full-text-search" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.1 Match Queries (for Full-Text Search)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-term-queries-for-structured-data" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.2. Term Queries (for Structured Data)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-compound-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Compound Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#421-bool-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.1. Bool Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422-dis-max-query-disjunction-max" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.2. Dis Max Query (disjunction max):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-geo-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Geo Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#431-geo-bounding-box-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.1 Geo Bounding Box Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#432-geo-distance-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.2 Geo Distance Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#433-geo-polygon-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.3 Geo Polygon Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#434-geo-shape-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.4 Geo Shape Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#435-using-geo-filters-with-bool-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.5 Using Geo Filters with Bool Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-elastic-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Elastic Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5. Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#51-metrics-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Metrics Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-bucket-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Bucket Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-combining-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5.3. Combining Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6. Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#61-basic-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.1. Basic Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-field-based-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.2. Field-based Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-multiple-sort-fields" class="md-nav__link">
    <span class="md-ellipsis">
      6.3. Multiple Sort Fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-nested-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.4. Nested Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-geolocation-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.5. Geolocation Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#66-script-based-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.6. Script-based Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#67-missing-values" class="md-nav__link">
    <span class="md-ellipsis">
      6.7. Missing Values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#68-sorting-in-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      6.8. Sorting in Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-relevance-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      7. Relevance Scoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71-scoring-mechanism-and-bm25-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      7.1. Scoring Mechanism and BM25 Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-calculating-the-bm25-score" class="md-nav__link">
    <span class="md-ellipsis">
      7.2. Calculating the BM25 Score
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-understanding-scoring-in-elasticsearch-queries" class="md-nav__link">
    <span class="md-ellipsis">
      7.3. Understanding Scoring in Elasticsearch Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-improving-relevance-with-advanced-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      7.4. Improving Relevance with Advanced Techniques
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75-practical-use-cases-for-bm25-in-elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      7.5. Practical Use Cases for BM25 in Elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-relevance-score" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Relevance Score
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-pagination-and-cursors" class="md-nav__link">
    <span class="md-ellipsis">
      8. Pagination and Cursors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#81-basic-pagination-with-from-and-size" class="md-nav__link">
    <span class="md-ellipsis">
      8.1. Basic Pagination with from and size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-search-after-for-deep-pagination" class="md-nav__link">
    <span class="md-ellipsis">
      8.2. Search After for Deep Pagination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-scroll-api-for-bulk-data-retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      8.3. Scroll API for Bulk Data Retrieval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-point-in-time-pit-for-real-time-pagination-with-consistency" class="md-nav__link">
    <span class="md-ellipsis">
      8.4. Point-in-Time (PIT) for Real-time Pagination with Consistency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#85-limitations-and-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      8.5. Limitations and Considerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#86-summary-table-of-pagination-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      8.6. Summary Table of Pagination Techniques
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-facets-and-filters" class="md-nav__link">
    <span class="md-ellipsis">
      9. Facets and Filters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#91-facets-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      9.1. Facets (Aggregations)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-filters-filtering-without-scoring-impact" class="md-nav__link">
    <span class="md-ellipsis">
      9.2. Filters: Filtering without Scoring Impact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-combining-facets-and-filters-in-search-applications" class="md-nav__link">
    <span class="md-ellipsis">
      9.3. Combining Facets and Filters in Search Applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94-sample-implementations" class="md-nav__link">
    <span class="md-ellipsis">
      9.4. Sample Implementations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95-performance-optimization-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      9.5. Performance Optimization Techniques
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cluster Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cluster-overview-and-node-responsibilities" class="md-nav__link">
    <span class="md-ellipsis">
      1. Cluster Overview and Node Responsibilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-cluster-hierarchy-overview" class="md-nav__link">
    <span class="md-ellipsis">
      2. Cluster Hierarchy Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-elasticsearch-request-flow-and-processing" class="md-nav__link">
    <span class="md-ellipsis">
      3. Elasticsearch Request Flow and Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-receiving-a-request" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Receiving a Request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-breaking-down-the-request" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Breaking Down the Request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-execution-at-shard-level" class="md-nav__link">
    <span class="md-ellipsis">
      3.3. Execution at Shard Level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-response-consolidation" class="md-nav__link">
    <span class="md-ellipsis">
      3.4. Response Consolidation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-indexing-flow-details" class="md-nav__link">
    <span class="md-ellipsis">
      3.5. Indexing Flow Details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-request-flow-and-cluster-operations-summary" class="md-nav__link">
    <span class="md-ellipsis">
      3.6. Request Flow and Cluster Operations Summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37-additional-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      3.7. Additional Considerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-lucene-segments-and-index-structures" class="md-nav__link">
    <span class="md-ellipsis">
      4. Lucene, Segments, and Index Structures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#41-lucene-and-segments" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Lucene and Segments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-lucenes-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Lucene’s Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-bkd-trees-and-doc-values" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. BKD Trees and Doc Values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-advanced-data-structures-in-lucene" class="md-nav__link">
    <span class="md-ellipsis">
      4.4. Advanced Data Structures in Lucene
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-how-lucenes-structures-fit-into-elasticsearchs-query-flow" class="md-nav__link">
    <span class="md-ellipsis">
      4.5. How Lucene's Structures Fit into Elasticsearch’s Query Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-visual-representation-of-cluster-architecture-hierarchy-flow" class="md-nav__link">
    <span class="md-ellipsis">
      5. Visual Representation of Cluster Architecture (Hierarchy Flow)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-summary-of-cluster-roles-and-data-flow" class="md-nav__link">
    <span class="md-ellipsis">
      6. Summary of Cluster Roles and Data Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thread-pools" class="md-nav__link">
    <span class="md-ellipsis">
      Thread Pools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Thread Pools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    <span class="md-ellipsis">
      1. Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-detailed-breakdown-of-key-pools" class="md-nav__link">
    <span class="md-ellipsis">
      2. Detailed Breakdown of Key Pools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configuring-and-tuning-thread-pools" class="md-nav__link">
    <span class="md-ellipsis">
      3. Configuring and Tuning Thread Pools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-monitoring-metrics-for-thread-pools" class="md-nav__link">
    <span class="md-ellipsis">
      4. Monitoring Metrics for Thread Pools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-example-scenarios-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      5. Example Scenarios and Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-summary-table-of-pools" class="md-nav__link">
    <span class="md-ellipsis">
      6. Summary Table of Pools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching" class="md-nav__link">
    <span class="md-ellipsis">
      Caching
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-types-of-caches-in-elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      1. Types of Caches in Elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-filesystem-cache-os-level" class="md-nav__link">
    <span class="md-ellipsis">
      2. Filesystem Cache (OS-level)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-shard-level-cache" class="md-nav__link">
    <span class="md-ellipsis">
      3. Shard-level Cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-node-level-cache" class="md-nav__link">
    <span class="md-ellipsis">
      4. Node-level Cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-cache-tuning-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      5. Cache Tuning and Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-summary-table-of-caching-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      6. Summary Table of Caching Mechanisms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index-life-management-ilm" class="md-nav__link">
    <span class="md-ellipsis">
      Index Life Management - ILM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Index Life Management - ILM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-purpose-of-hot-warm-cold-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      1. Purpose of Hot-Warm-Cold Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-phases-in-ilm-index-lifecycle-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Phases in ILM (Index Lifecycle Management)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hot-phase-high-performance-node-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      3. Hot Phase (High-Performance Node Configuration)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-warm-phase-mid-performance-node-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      4. Warm Phase (Mid-Performance Node Configuration)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-cold-phase-cost-effective-node-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      5. Cold Phase (Cost-Effective Node Configuration)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-frozen-phase-archival-node-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      6. Frozen Phase (Archival Node Configuration)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-delete-phase-optional-phase" class="md-nav__link">
    <span class="md-ellipsis">
      7. Delete Phase (Optional Phase)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-setting-up-ilm-policies" class="md-nav__link">
    <span class="md-ellipsis">
      8. Setting Up ILM Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-cluster-resource-optimization-with-hot-warm-cold-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      9. Cluster Resource Optimization with Hot-Warm-Cold Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-example-ilm-policy" class="md-nav__link">
    <span class="md-ellipsis">
      10. Example ILM Policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-advantages-of-hot-warm-cold-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      11. Advantages of Hot-Warm-Cold Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      12. Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-summary-table" class="md-nav__link">
    <span class="md-ellipsis">
      13. Summary Table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-of-rest-apis" class="md-nav__link">
    <span class="md-ellipsis">
      List of REST APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="List of REST APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capacity-planning-cluster-design" class="md-nav__link">
    <span class="md-ellipsis">
      Capacity Planning &amp; Cluster Design
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#questions" class="md-nav__link">
    <span class="md-ellipsis">
      Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-sql-or-nosql" class="md-nav__link">
    <span class="md-ellipsis">
      1. SQL or NoSQL:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-main-feature-origin-and-design" class="md-nav__link">
    <span class="md-ellipsis">
      2. Main Feature, Origin, and Design:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-olap-or-oltp" class="md-nav__link">
    <span class="md-ellipsis">
      3. OLAP or OLTP:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-acid-or-base" class="md-nav__link">
    <span class="md-ellipsis">
      4. ACID or BASE:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-cap-theorem" class="md-nav__link">
    <span class="md-ellipsis">
      5. CAP Theorem:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-cluster-structure" class="md-nav__link">
    <span class="md-ellipsis">
      6. Cluster Structure:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-fundamental-building-blocks" class="md-nav__link">
    <span class="md-ellipsis">
      7. Fundamental Building Blocks:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-multi-master-support" class="md-nav__link">
    <span class="md-ellipsis">
      8. Multi-Master Support:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-master-data-node-relation" class="md-nav__link">
    <span class="md-ellipsis">
      9. Master-Data Node Relation:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-node-structures-in-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      10. Node Structures in Cluster:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-cluster-scaling-support" class="md-nav__link">
    <span class="md-ellipsis">
      11. Cluster Scaling Support:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      12. High Availability:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-fault-tolerance" class="md-nav__link">
    <span class="md-ellipsis">
      13. Fault Tolerance:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-replication" class="md-nav__link">
    <span class="md-ellipsis">
      14. Replication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-partition" class="md-nav__link">
    <span class="md-ellipsis">
      15. Partition:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      16. Sharding:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-caching-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      17. Caching in Depth:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-storage-type" class="md-nav__link">
    <span class="md-ellipsis">
      18. Storage Type:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#19-segmentpage-approach" class="md-nav__link">
    <span class="md-ellipsis">
      19. Segment/Page Approach:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-trees-for-storage" class="md-nav__link">
    <span class="md-ellipsis">
      20. Trees for Storage:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#21-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      21. Indexing:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-routing" class="md-nav__link">
    <span class="md-ellipsis">
      22. Routing:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-latency" class="md-nav__link">
    <span class="md-ellipsis">
      23. Latency:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-versioning" class="md-nav__link">
    <span class="md-ellipsis">
      24. Versioning:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-locking-and-concurrency" class="md-nav__link">
    <span class="md-ellipsis">
      25. Locking and Concurrency:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-write-ahead-log-wal" class="md-nav__link">
    <span class="md-ellipsis">
      26. Write-Ahead Log (WAL):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-change-data-capture-cdc" class="md-nav__link">
    <span class="md-ellipsis">
      27. Change Data Capture (CDC):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-query-type-and-query" class="md-nav__link">
    <span class="md-ellipsis">
      28. Query Type and Query:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#29-query-optimizers" class="md-nav__link">
    <span class="md-ellipsis">
      29. Query Optimizers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#30-sql-support" class="md-nav__link">
    <span class="md-ellipsis">
      30. SQL Support:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-circuit-breakers" class="md-nav__link">
    <span class="md-ellipsis">
      31. Circuit Breakers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-data-retention-lifecycle-management" class="md-nav__link">
    <span class="md-ellipsis">
      32. Data Retention / Lifecycle Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-other-features" class="md-nav__link">
    <span class="md-ellipsis">
      33. Other Features:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-modules-or-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      34. Modules or Libraries:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-optimization-and-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      35. Optimization and Tuning:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-backup-and-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      36. Backup and Recovery:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37-security" class="md-nav__link">
    <span class="md-ellipsis">
      37. Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#38-migration" class="md-nav__link">
    <span class="md-ellipsis">
      38. Migration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#39-recommended-cluster-setup" class="md-nav__link">
    <span class="md-ellipsis">
      39. Recommended Cluster Setup:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#40-basic-cluster-setup" class="md-nav__link">
    <span class="md-ellipsis">
      40. Basic Cluster Setup:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
      
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Redis/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Redis
  </span>
  

      </a>
    </li>
  

              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../Cassandra.md" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Cassandra
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    
    
      
        
          
        
      
        
      
    
    
      
      
    
    
    <li class="md-nav__item md-nav__item--nested">
      
        
        
          
        
        <input class="md-nav__toggle md-toggle md-toggle--indeterminate" type="checkbox" id="__nav_5" >
        
          
          
          <div class="md-nav__link md-nav__container">
            <a href="../../../blog/" class="md-nav__link ">
              
  
  <span class="md-ellipsis">
    Blog
  </span>
  

            </a>
            
              
              <label class="md-nav__link " for="__nav_5" id="__nav_5_label" tabindex="0">
                <span class="md-nav__icon md-icon"></span>
              </label>
            
          </div>
        
        <nav class="md-nav" data-md-level="1" aria-labelledby="__nav_5_label" aria-expanded="false">
          <label class="md-nav__title" for="__nav_5">
            <span class="md-nav__icon md-icon"></span>
            Blog
          </label>
          <ul class="md-nav__list" data-md-scrollfix>
            
              
            
              
                
  
  
  
  
    <li class="md-nav__item">
      <a href="../../.." class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Archive
  </span>
  

      </a>
    </li>
  

              
            
          </ul>
        </nav>
      
    </li>
  

    
      
      
  
  
  
  
    <li class="md-nav__item">
      <a href="../../../changelog/" class="md-nav__link">
        
  
  <span class="md-ellipsis">
    Change Log
  </span>
  

      </a>
    </li>
  

    
  </ul>
</nav>
                  </div>
                </div>
              </div>
            
            
              
              <div class="md-sidebar md-sidebar--secondary" data-md-component="sidebar" data-md-type="toc" >
                <div class="md-sidebar__scrollwrap">
                  <div class="md-sidebar__inner">
                    

  

<nav class="md-nav md-nav--secondary" aria-label="On this page">
  
  
  
    
  
  
    <label class="md-nav__title" for="__toc">
      <span class="md-nav__icon md-icon"></span>
      On this page
    </label>
    <ul class="md-nav__list" data-md-component="toc" data-md-scrollfix>
      
        <li class="md-nav__item">
  <a href="#elasticsearch-basics-and-fundamentals" class="md-nav__link">
    <span class="md-ellipsis">
      ElasticSearch Basics and Fundamentals
    </span>
  </a>
  
    <nav class="md-nav" aria-label="ElasticSearch Basics and Fundamentals">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      1. Core Concepts:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-documents-and-indices" class="md-nav__link">
    <span class="md-ellipsis">
      1.1 Documents and Indices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-mapping-and-types" class="md-nav__link">
    <span class="md-ellipsis">
      1.2 Mapping and Types
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-shards-and-replicas" class="md-nav__link">
    <span class="md-ellipsis">
      1.3 Shards and Replicas
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-cluster-nodes-and-roles" class="md-nav__link">
    <span class="md-ellipsis">
      1.4 Cluster, Nodes, and Roles
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-elasticsearch-api-actions-crud" class="md-nav__link">
    <span class="md-ellipsis">
      1.5 Elasticsearch API Actions (CRUD)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-the-core-concepts" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of the Core Concepts
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      2. Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#21-core-structure-of-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      2.1. Core Structure of Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-building-the-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      2.2. Building the Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-how-searches-work" class="md-nav__link">
    <span class="md-ellipsis">
      2.3. How Searches Work
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-optimizations" class="md-nav__link">
    <span class="md-ellipsis">
      2.4. Optimizations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-benefits" class="md-nav__link">
    <span class="md-ellipsis">
      2.5. Benefits
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-the-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of the Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      3. Analyzers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-what-is-an-analyzer" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. What is an Analyzer?
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-components-of-an-analyzer" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Components of an Analyzer
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-built-in-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      3.3. Built-in Analyzers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-custom-analyzer-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      3.4. Custom Analyzer Configuration
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-usage-during-indexing-and-querying" class="md-nav__link">
    <span class="md-ellipsis">
      3.5. Usage During Indexing and Querying
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-practical-applications-of-custom-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      3.6. Practical Applications of Custom Analyzers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37-benefits-of-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      3.7. Benefits of Analyzers
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-analyzers" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Analyzers.
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-elasticsearch-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4. ElasticSearch Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#41-leaf-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.1 Leaf Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#411-match-queries-for-full-text-search" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.1 Match Queries (for Full-Text Search)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#412-term-queries-for-structured-data" class="md-nav__link">
    <span class="md-ellipsis">
      4.1.2. Term Queries (for Structured Data)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-compound-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Compound Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#421-bool-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.1. Bool Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#422-dis-max-query-disjunction-max" class="md-nav__link">
    <span class="md-ellipsis">
      4.2.2. Dis Max Query (disjunction max):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-geo-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.3 Geo Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#431-geo-bounding-box-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.1 Geo Bounding Box Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#432-geo-distance-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.2 Geo Distance Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#433-geo-polygon-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.3 Geo Polygon Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#434-geo-shape-query" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.4 Geo Shape Query
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#435-using-geo-filters-with-bool-queries" class="md-nav__link">
    <span class="md-ellipsis">
      4.3.5 Using Geo Filters with Bool Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-elastic-queries" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Elastic Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5. Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#51-metrics-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5.1. Metrics Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#52-bucket-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5.2. Bucket Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#53-combining-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      5.3. Combining Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6. Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#61-basic-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.1. Basic Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#62-field-based-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.2. Field-based Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#63-multiple-sort-fields" class="md-nav__link">
    <span class="md-ellipsis">
      6.3. Multiple Sort Fields
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#64-nested-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.4. Nested Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#65-geolocation-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.5. Geolocation Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#66-script-based-sorting" class="md-nav__link">
    <span class="md-ellipsis">
      6.6. Script-based Sorting
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#67-missing-values" class="md-nav__link">
    <span class="md-ellipsis">
      6.7. Missing Values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#68-sorting-in-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      6.8. Sorting in Aggregations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-relevance-scoring" class="md-nav__link">
    <span class="md-ellipsis">
      7. Relevance Scoring
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#71-scoring-mechanism-and-bm25-algorithm" class="md-nav__link">
    <span class="md-ellipsis">
      7.1. Scoring Mechanism and BM25 Algorithm
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#72-calculating-the-bm25-score" class="md-nav__link">
    <span class="md-ellipsis">
      7.2. Calculating the BM25 Score
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#73-understanding-scoring-in-elasticsearch-queries" class="md-nav__link">
    <span class="md-ellipsis">
      7.3. Understanding Scoring in Elasticsearch Queries
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#74-improving-relevance-with-advanced-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      7.4. Improving Relevance with Advanced Techniques
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#75-practical-use-cases-for-bm25-in-elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      7.5. Practical Use Cases for BM25 in Elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#summary-of-relevance-score" class="md-nav__link">
    <span class="md-ellipsis">
      Summary of Relevance Score
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-pagination-and-cursors" class="md-nav__link">
    <span class="md-ellipsis">
      8. Pagination and Cursors
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#81-basic-pagination-with-from-and-size" class="md-nav__link">
    <span class="md-ellipsis">
      8.1. Basic Pagination with from and size
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#82-search-after-for-deep-pagination" class="md-nav__link">
    <span class="md-ellipsis">
      8.2. Search After for Deep Pagination
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#83-scroll-api-for-bulk-data-retrieval" class="md-nav__link">
    <span class="md-ellipsis">
      8.3. Scroll API for Bulk Data Retrieval
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#84-point-in-time-pit-for-real-time-pagination-with-consistency" class="md-nav__link">
    <span class="md-ellipsis">
      8.4. Point-in-Time (PIT) for Real-time Pagination with Consistency
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#85-limitations-and-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      8.5. Limitations and Considerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#86-summary-table-of-pagination-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      8.6. Summary Table of Pagination Techniques
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-facets-and-filters" class="md-nav__link">
    <span class="md-ellipsis">
      9. Facets and Filters
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#91-facets-aggregations" class="md-nav__link">
    <span class="md-ellipsis">
      9.1. Facets (Aggregations)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#92-filters-filtering-without-scoring-impact" class="md-nav__link">
    <span class="md-ellipsis">
      9.2. Filters: Filtering without Scoring Impact
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#93-combining-facets-and-filters-in-search-applications" class="md-nav__link">
    <span class="md-ellipsis">
      9.3. Combining Facets and Filters in Search Applications
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#94-sample-implementations" class="md-nav__link">
    <span class="md-ellipsis">
      9.4. Sample Implementations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#95-performance-optimization-techniques" class="md-nav__link">
    <span class="md-ellipsis">
      9.5. Performance Optimization Techniques
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#cluster-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      Cluster Architecture
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Cluster Architecture">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-cluster-overview-and-node-responsibilities" class="md-nav__link">
    <span class="md-ellipsis">
      1. Cluster Overview and Node Responsibilities
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-cluster-hierarchy-overview" class="md-nav__link">
    <span class="md-ellipsis">
      2. Cluster Hierarchy Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-elasticsearch-request-flow-and-processing" class="md-nav__link">
    <span class="md-ellipsis">
      3. Elasticsearch Request Flow and Processing
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-receiving-a-request" class="md-nav__link">
    <span class="md-ellipsis">
      3.1. Receiving a Request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-breaking-down-the-request" class="md-nav__link">
    <span class="md-ellipsis">
      3.2. Breaking Down the Request
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-execution-at-shard-level" class="md-nav__link">
    <span class="md-ellipsis">
      3.3. Execution at Shard Level
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-response-consolidation" class="md-nav__link">
    <span class="md-ellipsis">
      3.4. Response Consolidation
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-indexing-flow-details" class="md-nav__link">
    <span class="md-ellipsis">
      3.5. Indexing Flow Details
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-request-flow-and-cluster-operations-summary" class="md-nav__link">
    <span class="md-ellipsis">
      3.6. Request Flow and Cluster Operations Summary
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37-additional-considerations" class="md-nav__link">
    <span class="md-ellipsis">
      3.7. Additional Considerations
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-lucene-segments-and-index-structures" class="md-nav__link">
    <span class="md-ellipsis">
      4. Lucene, Segments, and Index Structures
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#41-lucene-and-segments" class="md-nav__link">
    <span class="md-ellipsis">
      4.1. Lucene and Segments
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#42-lucenes-inverted-index" class="md-nav__link">
    <span class="md-ellipsis">
      4.2. Lucene’s Inverted Index
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#43-bkd-trees-and-doc-values" class="md-nav__link">
    <span class="md-ellipsis">
      4.3. BKD Trees and Doc Values
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#44-advanced-data-structures-in-lucene" class="md-nav__link">
    <span class="md-ellipsis">
      4.4. Advanced Data Structures in Lucene
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#45-how-lucenes-structures-fit-into-elasticsearchs-query-flow" class="md-nav__link">
    <span class="md-ellipsis">
      4.5. How Lucene's Structures Fit into Elasticsearch’s Query Flow
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-visual-representation-of-cluster-architecture-hierarchy-flow" class="md-nav__link">
    <span class="md-ellipsis">
      5. Visual Representation of Cluster Architecture (Hierarchy Flow)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-summary-of-cluster-roles-and-data-flow" class="md-nav__link">
    <span class="md-ellipsis">
      6. Summary of Cluster Roles and Data Flow
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#thread-pools" class="md-nav__link">
    <span class="md-ellipsis">
      Thread Pools
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Thread Pools">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-overview" class="md-nav__link">
    <span class="md-ellipsis">
      1. Overview
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-detailed-breakdown-of-key-pools" class="md-nav__link">
    <span class="md-ellipsis">
      2. Detailed Breakdown of Key Pools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-configuring-and-tuning-thread-pools" class="md-nav__link">
    <span class="md-ellipsis">
      3. Configuring and Tuning Thread Pools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-monitoring-metrics-for-thread-pools" class="md-nav__link">
    <span class="md-ellipsis">
      4. Monitoring Metrics for Thread Pools
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-example-scenarios-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      5. Example Scenarios and Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-summary-table-of-pools" class="md-nav__link">
    <span class="md-ellipsis">
      6. Summary Table of Pools
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#caching" class="md-nav__link">
    <span class="md-ellipsis">
      Caching
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Caching">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-types-of-caches-in-elasticsearch" class="md-nav__link">
    <span class="md-ellipsis">
      1. Types of Caches in Elasticsearch
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-filesystem-cache-os-level" class="md-nav__link">
    <span class="md-ellipsis">
      2. Filesystem Cache (OS-level)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-shard-level-cache" class="md-nav__link">
    <span class="md-ellipsis">
      3. Shard-level Cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-node-level-cache" class="md-nav__link">
    <span class="md-ellipsis">
      4. Node-level Cache
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-cache-tuning-and-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      5. Cache Tuning and Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-summary-table-of-caching-mechanisms" class="md-nav__link">
    <span class="md-ellipsis">
      6. Summary Table of Caching Mechanisms
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#index-life-management-ilm" class="md-nav__link">
    <span class="md-ellipsis">
      Index Life Management - ILM
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Index Life Management - ILM">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-purpose-of-hot-warm-cold-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      1. Purpose of Hot-Warm-Cold Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-phases-in-ilm-index-lifecycle-management" class="md-nav__link">
    <span class="md-ellipsis">
      2. Phases in ILM (Index Lifecycle Management)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-hot-phase-high-performance-node-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      3. Hot Phase (High-Performance Node Configuration)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-warm-phase-mid-performance-node-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      4. Warm Phase (Mid-Performance Node Configuration)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-cold-phase-cost-effective-node-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      5. Cold Phase (Cost-Effective Node Configuration)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-frozen-phase-archival-node-configuration" class="md-nav__link">
    <span class="md-ellipsis">
      6. Frozen Phase (Archival Node Configuration)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-delete-phase-optional-phase" class="md-nav__link">
    <span class="md-ellipsis">
      7. Delete Phase (Optional Phase)
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-setting-up-ilm-policies" class="md-nav__link">
    <span class="md-ellipsis">
      8. Setting Up ILM Policies
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-cluster-resource-optimization-with-hot-warm-cold-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      9. Cluster Resource Optimization with Hot-Warm-Cold Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-example-ilm-policy" class="md-nav__link">
    <span class="md-ellipsis">
      10. Example ILM Policy
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-advantages-of-hot-warm-cold-architecture" class="md-nav__link">
    <span class="md-ellipsis">
      11. Advantages of Hot-Warm-Cold Architecture
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-best-practices" class="md-nav__link">
    <span class="md-ellipsis">
      12. Best Practices
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-summary-table" class="md-nav__link">
    <span class="md-ellipsis">
      13. Summary Table
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#list-of-rest-apis" class="md-nav__link">
    <span class="md-ellipsis">
      List of REST APIs
    </span>
  </a>
  
    <nav class="md-nav" aria-label="List of REST APIs">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#additional-notes" class="md-nav__link">
    <span class="md-ellipsis">
      Additional Notes
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#capacity-planning-cluster-design" class="md-nav__link">
    <span class="md-ellipsis">
      Capacity Planning &amp; Cluster Design
    </span>
  </a>
  
</li>
      
        <li class="md-nav__item">
  <a href="#questions" class="md-nav__link">
    <span class="md-ellipsis">
      Questions
    </span>
  </a>
  
    <nav class="md-nav" aria-label="Questions">
      <ul class="md-nav__list">
        
          <li class="md-nav__item">
  <a href="#1-sql-or-nosql" class="md-nav__link">
    <span class="md-ellipsis">
      1. SQL or NoSQL:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#2-main-feature-origin-and-design" class="md-nav__link">
    <span class="md-ellipsis">
      2. Main Feature, Origin, and Design:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#3-olap-or-oltp" class="md-nav__link">
    <span class="md-ellipsis">
      3. OLAP or OLTP:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#4-acid-or-base" class="md-nav__link">
    <span class="md-ellipsis">
      4. ACID or BASE:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#5-cap-theorem" class="md-nav__link">
    <span class="md-ellipsis">
      5. CAP Theorem:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#6-cluster-structure" class="md-nav__link">
    <span class="md-ellipsis">
      6. Cluster Structure:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#7-fundamental-building-blocks" class="md-nav__link">
    <span class="md-ellipsis">
      7. Fundamental Building Blocks:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#8-multi-master-support" class="md-nav__link">
    <span class="md-ellipsis">
      8. Multi-Master Support:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#9-master-data-node-relation" class="md-nav__link">
    <span class="md-ellipsis">
      9. Master-Data Node Relation:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#10-node-structures-in-cluster" class="md-nav__link">
    <span class="md-ellipsis">
      10. Node Structures in Cluster:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#11-cluster-scaling-support" class="md-nav__link">
    <span class="md-ellipsis">
      11. Cluster Scaling Support:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#12-high-availability" class="md-nav__link">
    <span class="md-ellipsis">
      12. High Availability:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#13-fault-tolerance" class="md-nav__link">
    <span class="md-ellipsis">
      13. Fault Tolerance:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#14-replication" class="md-nav__link">
    <span class="md-ellipsis">
      14. Replication:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#15-partition" class="md-nav__link">
    <span class="md-ellipsis">
      15. Partition:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#16-sharding" class="md-nav__link">
    <span class="md-ellipsis">
      16. Sharding:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#17-caching-in-depth" class="md-nav__link">
    <span class="md-ellipsis">
      17. Caching in Depth:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#18-storage-type" class="md-nav__link">
    <span class="md-ellipsis">
      18. Storage Type:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#19-segmentpage-approach" class="md-nav__link">
    <span class="md-ellipsis">
      19. Segment/Page Approach:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#20-trees-for-storage" class="md-nav__link">
    <span class="md-ellipsis">
      20. Trees for Storage:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#21-indexing" class="md-nav__link">
    <span class="md-ellipsis">
      21. Indexing:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#22-routing" class="md-nav__link">
    <span class="md-ellipsis">
      22. Routing:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#23-latency" class="md-nav__link">
    <span class="md-ellipsis">
      23. Latency:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#24-versioning" class="md-nav__link">
    <span class="md-ellipsis">
      24. Versioning:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#25-locking-and-concurrency" class="md-nav__link">
    <span class="md-ellipsis">
      25. Locking and Concurrency:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#26-write-ahead-log-wal" class="md-nav__link">
    <span class="md-ellipsis">
      26. Write-Ahead Log (WAL):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#27-change-data-capture-cdc" class="md-nav__link">
    <span class="md-ellipsis">
      27. Change Data Capture (CDC):
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#28-query-type-and-query" class="md-nav__link">
    <span class="md-ellipsis">
      28. Query Type and Query:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#29-query-optimizers" class="md-nav__link">
    <span class="md-ellipsis">
      29. Query Optimizers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#30-sql-support" class="md-nav__link">
    <span class="md-ellipsis">
      30. SQL Support:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#31-circuit-breakers" class="md-nav__link">
    <span class="md-ellipsis">
      31. Circuit Breakers:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#32-data-retention-lifecycle-management" class="md-nav__link">
    <span class="md-ellipsis">
      32. Data Retention / Lifecycle Management:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#33-other-features" class="md-nav__link">
    <span class="md-ellipsis">
      33. Other Features:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#34-modules-or-libraries" class="md-nav__link">
    <span class="md-ellipsis">
      34. Modules or Libraries:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#35-optimization-and-tuning" class="md-nav__link">
    <span class="md-ellipsis">
      35. Optimization and Tuning:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#36-backup-and-recovery" class="md-nav__link">
    <span class="md-ellipsis">
      36. Backup and Recovery:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#37-security" class="md-nav__link">
    <span class="md-ellipsis">
      37. Security:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#38-migration" class="md-nav__link">
    <span class="md-ellipsis">
      38. Migration:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#39-recommended-cluster-setup" class="md-nav__link">
    <span class="md-ellipsis">
      39. Recommended Cluster Setup:
    </span>
  </a>
  
</li>
        
          <li class="md-nav__item">
  <a href="#40-basic-cluster-setup" class="md-nav__link">
    <span class="md-ellipsis">
      40. Basic Cluster Setup:
    </span>
  </a>
  
</li>
        
      </ul>
    </nav>
  
</li>
      
        <li class="md-nav__item">
  <a href="#references" class="md-nav__link">
    <span class="md-ellipsis">
      References
    </span>
  </a>
  
</li>
      
    </ul>
  
</nav>
                  </div>
                </div>
              </div>
            
          
          
            <div class="md-content" data-md-component="content">
              <article class="md-content__inner md-typeset">
                
                  

  
    <a href="https://github.com/Luci-MG/Under-the-Hood/edit/main/docs/techdives/DistrubutedSystems/ElasticSearch.md" title="Edit this page" class="md-content__button md-icon">
      
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20.71 7.04c.39-.39.39-1.04 0-1.41l-2.34-2.34c-.37-.39-1.02-.39-1.41 0l-1.84 1.83 3.75 3.75M3 17.25V21h3.75L17.81 9.93l-3.75-3.75z"/></svg>
    </a>
  
  


<h1 id="elasticsearch">ElasticSearch<a class="headerlink" href="#elasticsearch" title="Permanent link">&para;</a></h1>
<p>Elasticsearch is a search engine based on Apache Lucene. It provides a distributed, multitenant-capable full-text search engine with an HTTP web interface and schema-free JSON documents.</p>
<hr />
<h2 id="elasticsearch-basics-and-fundamentals">ElasticSearch Basics and Fundamentals<a class="headerlink" href="#elasticsearch-basics-and-fundamentals" title="Permanent link">&para;</a></h2>
<h3 id="1-core-concepts">1. Core Concepts:<a class="headerlink" href="#1-core-concepts" title="Permanent link">&para;</a></h3>
<hr />
<p>Diving into Elasticsearch's <strong>core concepts</strong> is essential for understanding its architecture and functionality. </p>
<h3 id="11-documents-and-indices">1.1 <strong>Documents and Indices</strong><a class="headerlink" href="#11-documents-and-indices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Document</strong>: A JSON object with fields representing data.<ul>
<li>Example:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-0-1"><a id="__codelineno-0-1" name="__codelineno-0-1" href="#__codelineno-0-1"></a><span class="p">{</span>
</span><span id="__span-0-2"><a id="__codelineno-0-2" name="__codelineno-0-2" href="#__codelineno-0-2"></a><span class="w">  </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Learning Elasticsearch&quot;</span><span class="p">,</span>
</span><span id="__span-0-3"><a id="__codelineno-0-3" name="__codelineno-0-3" href="#__codelineno-0-3"></a><span class="w">  </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
</span><span id="__span-0-4"><a id="__codelineno-0-4" name="__codelineno-0-4" href="#__codelineno-0-4"></a><span class="w">  </span><span class="nt">&quot;published_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-01-15&quot;</span>
</span><span id="__span-0-5"><a id="__codelineno-0-5" name="__codelineno-0-5" href="#__codelineno-0-5"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
<li><strong>Index</strong>: A collection of documents, e.g., "books" index.<ul>
<li>Creating an index example:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-1-1"><a id="__codelineno-1-1" name="__codelineno-1-1" href="#__codelineno-1-1"></a><span class="err">PUT</span><span class="w"> </span><span class="err">/books</span>
</span></code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="12-mapping-and-types">1.2 <strong>Mapping and Types</strong><a class="headerlink" href="#12-mapping-and-types" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Mapping</strong>: Defines field types and structure.<ul>
<li>Example:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-2-1"><a id="__codelineno-2-1" name="__codelineno-2-1" href="#__codelineno-2-1"></a><span class="err">PUT</span><span class="w"> </span><span class="err">/books/_mappi</span><span class="kc">n</span><span class="err">g</span>
</span><span id="__span-2-2"><a id="__codelineno-2-2" name="__codelineno-2-2" href="#__codelineno-2-2"></a><span class="p">{</span>
</span><span id="__span-2-3"><a id="__codelineno-2-3" name="__codelineno-2-3" href="#__codelineno-2-3"></a><span class="w">  </span><span class="nt">&quot;properties&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-2-4"><a id="__codelineno-2-4" name="__codelineno-2-4" href="#__codelineno-2-4"></a><span class="w">    </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;text&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-2-5"><a id="__codelineno-2-5" name="__codelineno-2-5" href="#__codelineno-2-5"></a><span class="w">    </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;keyword&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-2-6"><a id="__codelineno-2-6" name="__codelineno-2-6" href="#__codelineno-2-6"></a><span class="w">    </span><span class="nt">&quot;published_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;date&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-2-7"><a id="__codelineno-2-7" name="__codelineno-2-7" href="#__codelineno-2-7"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-2-8"><a id="__codelineno-2-8" name="__codelineno-2-8" href="#__codelineno-2-8"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
<li><strong>Type</strong>: No longer applicable as each index now supports only one type.</li>
</ul>
<h3 id="13-shards-and-replicas">1.3 <strong>Shards and Replicas</strong><a class="headerlink" href="#13-shards-and-replicas" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Shards</strong>: Elasticsearch divides indices into shards to scale horizontally.<ul>
<li>Example: Creating an index with custom shards and replicas.
   <div class="language-json highlight"><pre><span></span><code><span id="__span-3-1"><a id="__codelineno-3-1" name="__codelineno-3-1" href="#__codelineno-3-1"></a><span class="err">PUT</span><span class="w"> </span><span class="err">/books</span>
</span><span id="__span-3-2"><a id="__codelineno-3-2" name="__codelineno-3-2" href="#__codelineno-3-2"></a><span class="p">{</span>
</span><span id="__span-3-3"><a id="__codelineno-3-3" name="__codelineno-3-3" href="#__codelineno-3-3"></a><span class="w">  </span><span class="nt">&quot;settings&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-3-4"><a id="__codelineno-3-4" name="__codelineno-3-4" href="#__codelineno-3-4"></a><span class="w">    </span><span class="nt">&quot;number_of_shards&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">3</span><span class="p">,</span>
</span><span id="__span-3-5"><a id="__codelineno-3-5" name="__codelineno-3-5" href="#__codelineno-3-5"></a><span class="w">    </span><span class="nt">&quot;number_of_replicas&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-3-6"><a id="__codelineno-3-6" name="__codelineno-3-6" href="#__codelineno-3-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-3-7"><a id="__codelineno-3-7" name="__codelineno-3-7" href="#__codelineno-3-7"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="14-cluster-nodes-and-roles">1.4 <strong>Cluster, Nodes, and Roles</strong><a class="headerlink" href="#14-cluster-nodes-and-roles" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Cluster</strong>: A named grouping of nodes.</li>
<li><strong>Nodes</strong>: Instances within a cluster, each assigned specific roles.<ul>
<li><strong>Master Node</strong>: Manages configurations and updates.</li>
<li><strong>Data Node</strong>: Manages data storage and processing.</li>
<li><strong>Client/Coordinator Node</strong>: Routes queries, doesn't store data.</li>
</ul>
</li>
</ul>
<h3 id="15-elasticsearch-api-actions-crud">1.5 <strong>Elasticsearch API Actions (CRUD)</strong><a class="headerlink" href="#15-elasticsearch-api-actions-crud" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Indexing</strong> (Create/Update):
     <div class="language-json highlight"><pre><span></span><code><span id="__span-4-1"><a id="__codelineno-4-1" name="__codelineno-4-1" href="#__codelineno-4-1"></a><span class="err">POST</span><span class="w"> </span><span class="err">/books/_doc/</span><span class="mi">1</span>
</span><span id="__span-4-2"><a id="__codelineno-4-2" name="__codelineno-4-2" href="#__codelineno-4-2"></a><span class="p">{</span>
</span><span id="__span-4-3"><a id="__codelineno-4-3" name="__codelineno-4-3" href="#__codelineno-4-3"></a><span class="w">  </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Learning Elasticsearch&quot;</span><span class="p">,</span>
</span><span id="__span-4-4"><a id="__codelineno-4-4" name="__codelineno-4-4" href="#__codelineno-4-4"></a><span class="w">  </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;John Doe&quot;</span><span class="p">,</span>
</span><span id="__span-4-5"><a id="__codelineno-4-5" name="__codelineno-4-5" href="#__codelineno-4-5"></a><span class="w">  </span><span class="nt">&quot;published_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-01-15&quot;</span>
</span><span id="__span-4-6"><a id="__codelineno-4-6" name="__codelineno-4-6" href="#__codelineno-4-6"></a><span class="p">}</span>
</span></code></pre></div></li>
<li><strong>Retrieving</strong>:
     <div class="language-json highlight"><pre><span></span><code><span id="__span-5-1"><a id="__codelineno-5-1" name="__codelineno-5-1" href="#__codelineno-5-1"></a><span class="err">GET</span><span class="w"> </span><span class="err">/books/_doc/</span><span class="mi">1</span>
</span></code></pre></div></li>
<li><strong>Updating</strong>:
     <div class="language-json highlight"><pre><span></span><code><span id="__span-6-1"><a id="__codelineno-6-1" name="__codelineno-6-1" href="#__codelineno-6-1"></a><span class="err">POST</span><span class="w"> </span><span class="err">/books/_doc/</span><span class="mi">1</span><span class="err">/_upda</span><span class="kc">te</span>
</span><span id="__span-6-2"><a id="__codelineno-6-2" name="__codelineno-6-2" href="#__codelineno-6-2"></a><span class="p">{</span>
</span><span id="__span-6-3"><a id="__codelineno-6-3" name="__codelineno-6-3" href="#__codelineno-6-3"></a><span class="w">  </span><span class="nt">&quot;doc&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;author&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Jane Doe&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-6-4"><a id="__codelineno-6-4" name="__codelineno-6-4" href="#__codelineno-6-4"></a><span class="p">}</span>
</span></code></pre></div></li>
<li><strong>Deleting</strong>:
     <div class="language-json highlight"><pre><span></span><code><span id="__span-7-1"><a id="__codelineno-7-1" name="__codelineno-7-1" href="#__codelineno-7-1"></a><span class="err">DELETE</span><span class="w"> </span><span class="err">/books/_doc/</span><span class="mi">1</span>
</span></code></pre></div></li>
</ul>
<h3 id="summary-of-the-core-concepts">Summary of the Core Concepts<a class="headerlink" href="#summary-of-the-core-concepts" title="Permanent link">&para;</a></h3>
<ol>
<li>Data is divided into documents, stored in indices, and distributed across shards.</li>
<li>Nodes work together in a cluster, balancing the load for efficient querying and data redundancy.</li>
</ol>
<hr />
<h3 id="2-inverted-index">2. Inverted Index<a class="headerlink" href="#2-inverted-index" title="Permanent link">&para;</a></h3>
<hr />
<p>An <strong>inverted index</strong> is a fundamental data structure in Elasticsearch and other search engines. It optimizes search efficiency by storing a mapping from terms (words) to their locations within documents. Let’s break it down into key components and processes:</p>
<h3 id="21-core-structure-of-inverted-index">2.1. <strong>Core Structure of Inverted Index</strong><a class="headerlink" href="#21-core-structure-of-inverted-index" title="Permanent link">&para;</a></h3>
<ul>
<li>At its heart, an inverted index consists of two parts:<ul>
<li><strong>Terms</strong>: Each unique word or token in the text.</li>
<li><strong>Postings List</strong>: A list of documents that contain each term, often including positional data (like the term's location within each document).</li>
</ul>
</li>
</ul>
<p>For instance, if a dataset contains the documents:
   - Doc 1: “Elasticsearch powers search”
   - Doc 2: “Search powers insights”</p>
<p>The inverted index would look like this:
   <div class="language-text highlight"><pre><span></span><code><span id="__span-8-1"><a id="__codelineno-8-1" name="__codelineno-8-1" href="#__codelineno-8-1"></a>&quot;Elasticsearch&quot; -&gt; [Doc 1]
</span><span id="__span-8-2"><a id="__codelineno-8-2" name="__codelineno-8-2" href="#__codelineno-8-2"></a>&quot;powers&quot; -&gt; [Doc 1, Doc 2]
</span><span id="__span-8-3"><a id="__codelineno-8-3" name="__codelineno-8-3" href="#__codelineno-8-3"></a>&quot;search&quot; -&gt; [Doc 1, Doc 2]
</span><span id="__span-8-4"><a id="__codelineno-8-4" name="__codelineno-8-4" href="#__codelineno-8-4"></a>&quot;insights&quot; -&gt; [Doc 2]
</span></code></pre></div></p>
<h3 id="22-building-the-inverted-index">2.2. <strong>Building the Inverted Index</strong><a class="headerlink" href="#22-building-the-inverted-index" title="Permanent link">&para;</a></h3>
<p>The process involves several stages:
   - <strong>Tokenization</strong>: Splitting text into words or tokens.
   - <strong>Normalization</strong>: Making tokens consistent, like converting to lowercase.
   - <strong>Stemming/Lemmatization</strong> (optional): Reducing words to their base or root forms.
   - <strong>Indexing</strong>: Populating the index with terms and the corresponding document references.</p>
<h3 id="23-how-searches-work">2.3. <strong>How Searches Work</strong><a class="headerlink" href="#23-how-searches-work" title="Permanent link">&para;</a></h3>
<p>When a user searches for a term, Elasticsearch retrieves the postings list from the inverted index, quickly locating documents containing that term. For multi-term queries, Elasticsearch can intersect postings lists, using logical operations (e.g., AND, OR) to combine or filter results.</p>
<h3 id="24-optimizations">2.4. <strong>Optimizations</strong><a class="headerlink" href="#24-optimizations" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Frequency and Proximity</strong>: Stores additional data, like term frequency (number of times a term appears) and positions, which aids relevance scoring.</li>
<li><strong>BKD Trees</strong>: Elasticsearch uses BKD trees for optimized spatial and numeric queries, boosting search performance for structured and semi-structured data.</li>
<li><strong>Compression</strong>: Compresses data in the index to save memory and improve I/O efficiency, especially for large datasets.</li>
</ul>
<h3 id="25-benefits">2.5. <strong>Benefits</strong><a class="headerlink" href="#25-benefits" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Speed</strong>: Inverted indices provide near-instant retrieval by mapping terms to documents directly.</li>
<li><strong>Efficiency</strong>: Reduced data retrieval time, especially for full-text searches and large datasets.</li>
<li><strong>Scalability</strong>: Easily scalable across distributed systems with sharding, enhancing parallel processing.</li>
</ul>
<h3 id="summary-of-the-inverted-index">Summary of the Inverted Index<a class="headerlink" href="#summary-of-the-inverted-index" title="Permanent link">&para;</a></h3>
<p>Inverted indices are the foundation of Elasticsearch’s speed and relevance in text search. This structure is tailored for high performance in full-text search scenarios, especially when complex queries and filtering are involved.</p>
<hr />
<h3 id="3-analyzers">3. Analyzers<a class="headerlink" href="#3-analyzers" title="Permanent link">&para;</a></h3>
<hr />
<h3 id="31-what-is-an-analyzer">3.1. <strong>What is an Analyzer?</strong><a class="headerlink" href="#31-what-is-an-analyzer" title="Permanent link">&para;</a></h3>
<ul>
<li>An <strong>analyzer</strong> in Elasticsearch processes text data both at the time of indexing and during querying. It consists of a <strong>tokenizer</strong> and a series of <strong>token filters</strong>.</li>
<li>The analyzer breaks down text into searchable units, enabling effective full-text searches by making text uniform and manageable.</li>
</ul>
<h3 id="32-components-of-an-analyzer">3.2. <strong>Components of an Analyzer</strong><a class="headerlink" href="#32-components-of-an-analyzer" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Tokenizer</strong>: The first step in analysis. A tokenizer splits text into individual tokens or words. For instance, the standard tokenizer splits based on whitespace, punctuation, etc.</li>
<li><strong>Filters</strong>: After tokenization, filters modify the tokens by:<ul>
<li><strong>Removing stop words</strong> (e.g., "the," "is") to reduce noise.</li>
<li><strong>Lowercasing</strong> to maintain consistency.</li>
<li><strong>Stemming or lemmatization</strong> to reduce words to their root form, so "running" becomes "run."</li>
</ul>
</li>
</ul>
<h3 id="33-built-in-analyzers">3.3. <strong>Built-in Analyzers</strong><a class="headerlink" href="#33-built-in-analyzers" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Standard Analyzer</strong>: Default analyzer, performs basic tokenization, lowercasing, and stop word filtering.</li>
<li><strong>Simple Analyzer</strong>: Splits text by non-letter characters and lowercases tokens.</li>
<li><strong>Whitespace Analyzer</strong>: Only splits text by whitespace without additional filtering.</li>
<li><strong>Custom Analyzer</strong>: You can create custom analyzers to specify a tokenizer and filters tailored to your data.</li>
</ul>
<h3 id="34-custom-analyzer-configuration">3.4. <strong>Custom Analyzer Configuration</strong><a class="headerlink" href="#34-custom-analyzer-configuration" title="Permanent link">&para;</a></h3>
<p>Creating a custom analyzer involves defining:
   - A <strong>tokenizer</strong> (e.g., edge-ngram tokenizer for partial word matches).
   - A list of <strong>token filters</strong> to process the tokens (e.g., synonym filters, ASCII folding for diacritical marks).</p>
<p>Example configuration:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-9-1"><a id="__codelineno-9-1" name="__codelineno-9-1" href="#__codelineno-9-1"></a><span class="p">{</span>
</span><span id="__span-9-2"><a id="__codelineno-9-2" name="__codelineno-9-2" href="#__codelineno-9-2"></a><span class="w">  </span><span class="nt">&quot;analysis&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-3"><a id="__codelineno-9-3" name="__codelineno-9-3" href="#__codelineno-9-3"></a><span class="w">    </span><span class="nt">&quot;analyzer&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-4"><a id="__codelineno-9-4" name="__codelineno-9-4" href="#__codelineno-9-4"></a><span class="w">      </span><span class="nt">&quot;custom_analyzer&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-9-5"><a id="__codelineno-9-5" name="__codelineno-9-5" href="#__codelineno-9-5"></a><span class="w">        </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;custom&quot;</span><span class="p">,</span>
</span><span id="__span-9-6"><a id="__codelineno-9-6" name="__codelineno-9-6" href="#__codelineno-9-6"></a><span class="w">        </span><span class="nt">&quot;tokenizer&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;whitespace&quot;</span><span class="p">,</span>
</span><span id="__span-9-7"><a id="__codelineno-9-7" name="__codelineno-9-7" href="#__codelineno-9-7"></a><span class="w">        </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;lowercase&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;stop&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;synonym&quot;</span><span class="p">]</span>
</span><span id="__span-9-8"><a id="__codelineno-9-8" name="__codelineno-9-8" href="#__codelineno-9-8"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-9-9"><a id="__codelineno-9-9" name="__codelineno-9-9" href="#__codelineno-9-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-9-10"><a id="__codelineno-9-10" name="__codelineno-9-10" href="#__codelineno-9-10"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-9-11"><a id="__codelineno-9-11" name="__codelineno-9-11" href="#__codelineno-9-11"></a><span class="p">}</span>
</span></code></pre></div></p>
<h3 id="35-usage-during-indexing-and-querying">3.5. <strong>Usage During Indexing and Querying</strong><a class="headerlink" href="#35-usage-during-indexing-and-querying" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Indexing</strong>: When data is indexed, the analyzer processes the input text, stores the terms generated, and builds an inverted index.</li>
<li><strong>Querying</strong>: Analyzers also process the query text so that the terms match the indexed format, ensuring accurate search results.</li>
</ul>
<h3 id="36-practical-applications-of-custom-analyzers">3.6. <strong>Practical Applications of Custom Analyzers</strong><a class="headerlink" href="#36-practical-applications-of-custom-analyzers" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Synonym Handling</strong>: Custom analyzers can include synonym filters to handle synonyms effectively during searches.</li>
<li><strong>Partial Matching</strong>: Edge-ngram tokenizers help with autocomplete and partial matching.</li>
<li><strong>Language-Specific Analyzers</strong>: Built-in language analyzers (e.g., <code>english</code>, <code>french</code>) handle language-specific tokenization and filtering.</li>
</ul>
<h3 id="37-benefits-of-analyzers">3.7. <strong>Benefits of Analyzers</strong><a class="headerlink" href="#37-benefits-of-analyzers" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Precision</strong>: They allow fine control over how text is processed.</li>
<li><strong>Performance</strong>: Proper use of analyzers can improve query performance by optimizing the text for search requirements.</li>
<li><strong>Relevance</strong>: They ensure better relevance scoring by normalizing input and query text, removing noise, and emphasizing meaningful terms.</li>
</ul>
<h3 id="summary-of-analyzers">Summary of Analyzers.<a class="headerlink" href="#summary-of-analyzers" title="Permanent link">&para;</a></h3>
<p>Analyzers transform raw text into optimized, searchable data, playing a critical role in making Elasticsearch searches accurate and efficient.</p>
<hr />
<h3 id="4-elasticsearch-queries">4. ElasticSearch Queries<a class="headerlink" href="#4-elasticsearch-queries" title="Permanent link">&para;</a></h3>
<hr />
<p>In Elasticsearch, queries are central to retrieving data. They’re categorized as <strong>leaf queries</strong> (operating on specific fields) and <strong>compound queries</strong> (combining multiple queries). Here's a deep dive into each type, with examples to illustrate their functionality:</p>
<h3 id="41-leaf-queries">4.1 <strong>Leaf Queries</strong><a class="headerlink" href="#41-leaf-queries" title="Permanent link">&para;</a></h3>
<p>These are standalone, field-specific queries (like <code>term</code> and <code>match</code> above) that don’t depend on other queries to function.</p>
<h3 id="411-match-queries-for-full-text-search">4.1.1 <strong>Match Queries (for Full-Text Search)</strong><a class="headerlink" href="#411-match-queries-for-full-text-search" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Match Query</strong>: Used for analyzing full-text fields, capable of handling fuzziness, synonyms, and relevance scoring.</p>
<ul>
<li>Example: To search for documents with “elastic search” in the "description" field:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-10-1"><a id="__codelineno-10-1" name="__codelineno-10-1" href="#__codelineno-10-1"></a><span class="p">{</span>
</span><span id="__span-10-2"><a id="__codelineno-10-2" name="__codelineno-10-2" href="#__codelineno-10-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-3"><a id="__codelineno-10-3" name="__codelineno-10-3" href="#__codelineno-10-3"></a><span class="w">    </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-10-4"><a id="__codelineno-10-4" name="__codelineno-10-4" href="#__codelineno-10-4"></a><span class="w">      </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;elastic search&quot;</span>
</span><span id="__span-10-5"><a id="__codelineno-10-5" name="__codelineno-10-5" href="#__codelineno-10-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-10-6"><a id="__codelineno-10-6" name="__codelineno-10-6" href="#__codelineno-10-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-10-7"><a id="__codelineno-10-7" name="__codelineno-10-7" href="#__codelineno-10-7"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Match Phrase Query</strong>: Requires terms to appear in the specified order, useful for exact phrase searches.</p>
<ul>
<li>Example: To search for the exact phrase “elastic search”:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-11-1"><a id="__codelineno-11-1" name="__codelineno-11-1" href="#__codelineno-11-1"></a><span class="p">{</span>
</span><span id="__span-11-2"><a id="__codelineno-11-2" name="__codelineno-11-2" href="#__codelineno-11-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-3"><a id="__codelineno-11-3" name="__codelineno-11-3" href="#__codelineno-11-3"></a><span class="w">    </span><span class="nt">&quot;match_phrase&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-11-4"><a id="__codelineno-11-4" name="__codelineno-11-4" href="#__codelineno-11-4"></a><span class="w">      </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;elastic search&quot;</span>
</span><span id="__span-11-5"><a id="__codelineno-11-5" name="__codelineno-11-5" href="#__codelineno-11-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-11-6"><a id="__codelineno-11-6" name="__codelineno-11-6" href="#__codelineno-11-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-11-7"><a id="__codelineno-11-7" name="__codelineno-11-7" href="#__codelineno-11-7"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="412-term-queries-for-structured-data">4.1.2. <strong>Term Queries (for Structured Data)</strong><a class="headerlink" href="#412-term-queries-for-structured-data" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Term Query</strong>: Best for exact matches on keyword fields (IDs, tags, enums) without tokenization.<ul>
<li>Example: To find documents where the “status” field is exactly “active”:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-12-1"><a id="__codelineno-12-1" name="__codelineno-12-1" href="#__codelineno-12-1"></a><span class="p">{</span>
</span><span id="__span-12-2"><a id="__codelineno-12-2" name="__codelineno-12-2" href="#__codelineno-12-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-3"><a id="__codelineno-12-3" name="__codelineno-12-3" href="#__codelineno-12-3"></a><span class="w">    </span><span class="nt">&quot;term&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-12-4"><a id="__codelineno-12-4" name="__codelineno-12-4" href="#__codelineno-12-4"></a><span class="w">      </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;active&quot;</span>
</span><span id="__span-12-5"><a id="__codelineno-12-5" name="__codelineno-12-5" href="#__codelineno-12-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-12-6"><a id="__codelineno-12-6" name="__codelineno-12-6" href="#__codelineno-12-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-12-7"><a id="__codelineno-12-7" name="__codelineno-12-7" href="#__codelineno-12-7"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
<li><strong>Terms Query</strong>: Allows searching for multiple exact values within a field.<ul>
<li>Example: To find documents with statuses of either "active" or "pending":
   <div class="language-json highlight"><pre><span></span><code><span id="__span-13-1"><a id="__codelineno-13-1" name="__codelineno-13-1" href="#__codelineno-13-1"></a><span class="p">{</span>
</span><span id="__span-13-2"><a id="__codelineno-13-2" name="__codelineno-13-2" href="#__codelineno-13-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-3"><a id="__codelineno-13-3" name="__codelineno-13-3" href="#__codelineno-13-3"></a><span class="w">    </span><span class="nt">&quot;terms&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-13-4"><a id="__codelineno-13-4" name="__codelineno-13-4" href="#__codelineno-13-4"></a><span class="w">      </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="s2">&quot;active&quot;</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;pending&quot;</span><span class="p">]</span>
</span><span id="__span-13-5"><a id="__codelineno-13-5" name="__codelineno-13-5" href="#__codelineno-13-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-13-6"><a id="__codelineno-13-6" name="__codelineno-13-6" href="#__codelineno-13-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-13-7"><a id="__codelineno-13-7" name="__codelineno-13-7" href="#__codelineno-13-7"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
</ul>
<h3 id="42-compound-queries">4.2. <strong>Compound Queries</strong><a class="headerlink" href="#42-compound-queries" title="Permanent link">&para;</a></h3>
<p>Compound queries allow for complex logic by combining multiple queries, enabling fine-grained control over query conditions and relevance.</p>
<h3 id="421-bool-query">4.2.1. <strong>Bool Query</strong><a class="headerlink" href="#421-bool-query" title="Permanent link">&para;</a></h3>
<p>The most flexible compound query, allowing logic-based combinations:</p>
<ul>
<li>
<p><strong>Must Clause</strong>: The <code>must</code> clause ensures that all enclosed queries must match. Think of it as an "AND" operation.</p>
<ul>
<li>Example: This returns documents where both <code>"title"</code> contains "Elasticsearch" and <code>"content"</code> contains "query".
    <div class="language-json highlight"><pre><span></span><code><span id="__span-14-1"><a id="__codelineno-14-1" name="__codelineno-14-1" href="#__codelineno-14-1"></a><span class="p">{</span>
</span><span id="__span-14-2"><a id="__codelineno-14-2" name="__codelineno-14-2" href="#__codelineno-14-2"></a><span class="w">    </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-3"><a id="__codelineno-14-3" name="__codelineno-14-3" href="#__codelineno-14-3"></a><span class="w">        </span><span class="nt">&quot;bool&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-14-4"><a id="__codelineno-14-4" name="__codelineno-14-4" href="#__codelineno-14-4"></a><span class="w">        </span><span class="nt">&quot;must&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-14-5"><a id="__codelineno-14-5" name="__codelineno-14-5" href="#__codelineno-14-5"></a><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Elasticsearch&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-14-6"><a id="__codelineno-14-6" name="__codelineno-14-6" href="#__codelineno-14-6"></a><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;query&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-14-7"><a id="__codelineno-14-7" name="__codelineno-14-7" href="#__codelineno-14-7"></a><span class="w">        </span><span class="p">]</span>
</span><span id="__span-14-8"><a id="__codelineno-14-8" name="__codelineno-14-8" href="#__codelineno-14-8"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-14-9"><a id="__codelineno-14-9" name="__codelineno-14-9" href="#__codelineno-14-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-14-10"><a id="__codelineno-14-10" name="__codelineno-14-10" href="#__codelineno-14-10"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Should Clause</strong>: The <code>should</code> clause is a flexible OR operation. If any query in the <code>should</code> clause matches, the document is considered a match. Adding multiple <code>should</code> clauses increases relevance based on how many match.</p>
<ul>
<li>Example: In this example, documents with either "search" or "indexing" in the <code>tags</code> field are included.
    <div class="language-json highlight"><pre><span></span><code><span id="__span-15-1"><a id="__codelineno-15-1" name="__codelineno-15-1" href="#__codelineno-15-1"></a><span class="p">{</span>
</span><span id="__span-15-2"><a id="__codelineno-15-2" name="__codelineno-15-2" href="#__codelineno-15-2"></a><span class="w">    </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-3"><a id="__codelineno-15-3" name="__codelineno-15-3" href="#__codelineno-15-3"></a><span class="w">        </span><span class="nt">&quot;bool&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-15-4"><a id="__codelineno-15-4" name="__codelineno-15-4" href="#__codelineno-15-4"></a><span class="w">        </span><span class="nt">&quot;should&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-15-5"><a id="__codelineno-15-5" name="__codelineno-15-5" href="#__codelineno-15-5"></a><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;search&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-15-6"><a id="__codelineno-15-6" name="__codelineno-15-6" href="#__codelineno-15-6"></a><span class="w">            </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;tags&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;indexing&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-15-7"><a id="__codelineno-15-7" name="__codelineno-15-7" href="#__codelineno-15-7"></a><span class="w">        </span><span class="p">],</span>
</span><span id="__span-15-8"><a id="__codelineno-15-8" name="__codelineno-15-8" href="#__codelineno-15-8"></a><span class="w">        </span><span class="nt">&quot;minimum_should_match&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-15-9"><a id="__codelineno-15-9" name="__codelineno-15-9" href="#__codelineno-15-9"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-15-10"><a id="__codelineno-15-10" name="__codelineno-15-10" href="#__codelineno-15-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-15-11"><a id="__codelineno-15-11" name="__codelineno-15-11" href="#__codelineno-15-11"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Must Not Clause</strong>: The <code>must_not</code> clause excludes documents that match any query within it, similar to a "NOT" operation.</p>
<ul>
<li>Example: This query includes documents with "Elasticsearch" in the title but excludes those with "archived" status.
    <div class="language-json highlight"><pre><span></span><code><span id="__span-16-1"><a id="__codelineno-16-1" name="__codelineno-16-1" href="#__codelineno-16-1"></a><span class="p">{</span>
</span><span id="__span-16-2"><a id="__codelineno-16-2" name="__codelineno-16-2" href="#__codelineno-16-2"></a><span class="w">    </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-3"><a id="__codelineno-16-3" name="__codelineno-16-3" href="#__codelineno-16-3"></a><span class="w">        </span><span class="nt">&quot;bool&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-16-4"><a id="__codelineno-16-4" name="__codelineno-16-4" href="#__codelineno-16-4"></a><span class="w">        </span><span class="nt">&quot;must&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Elasticsearch&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-16-5"><a id="__codelineno-16-5" name="__codelineno-16-5" href="#__codelineno-16-5"></a><span class="w">        </span><span class="nt">&quot;must_not&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;archived&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-16-6"><a id="__codelineno-16-6" name="__codelineno-16-6" href="#__codelineno-16-6"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-16-7"><a id="__codelineno-16-7" name="__codelineno-16-7" href="#__codelineno-16-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-16-8"><a id="__codelineno-16-8" name="__codelineno-16-8" href="#__codelineno-16-8"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
<li>
<p><strong>Filter Clause</strong>: The <code>filter</code> clause narrows down the result set without affecting relevance scores. It’s optimized for structured queries and often used to improve query performance.</p>
<ul>
<li>Example: This query matches documents with "Elasticsearch" in the title and filters to only those with "published" status.
    <div class="language-json highlight"><pre><span></span><code><span id="__span-17-1"><a id="__codelineno-17-1" name="__codelineno-17-1" href="#__codelineno-17-1"></a><span class="p">{</span>
</span><span id="__span-17-2"><a id="__codelineno-17-2" name="__codelineno-17-2" href="#__codelineno-17-2"></a><span class="w">    </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-3"><a id="__codelineno-17-3" name="__codelineno-17-3" href="#__codelineno-17-3"></a><span class="w">        </span><span class="nt">&quot;bool&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-17-4"><a id="__codelineno-17-4" name="__codelineno-17-4" href="#__codelineno-17-4"></a><span class="w">        </span><span class="nt">&quot;must&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Elasticsearch&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-17-5"><a id="__codelineno-17-5" name="__codelineno-17-5" href="#__codelineno-17-5"></a><span class="w">        </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;term&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;published&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-17-6"><a id="__codelineno-17-6" name="__codelineno-17-6" href="#__codelineno-17-6"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-17-7"><a id="__codelineno-17-7" name="__codelineno-17-7" href="#__codelineno-17-7"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-17-8"><a id="__codelineno-17-8" name="__codelineno-17-8" href="#__codelineno-17-8"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
</li>
</ul>
<h4 id="complex-boolean-query-example"><strong>Complex Boolean Query Example</strong><a class="headerlink" href="#complex-boolean-query-example" title="Permanent link">&para;</a></h4>
<p>Combining multiple clauses:</p>
<p><div class="language-json highlight"><pre><span></span><code><span id="__span-18-1"><a id="__codelineno-18-1" name="__codelineno-18-1" href="#__codelineno-18-1"></a><span class="p">{</span>
</span><span id="__span-18-2"><a id="__codelineno-18-2" name="__codelineno-18-2" href="#__codelineno-18-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-3"><a id="__codelineno-18-3" name="__codelineno-18-3" href="#__codelineno-18-3"></a><span class="w">    </span><span class="nt">&quot;bool&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-18-4"><a id="__codelineno-18-4" name="__codelineno-18-4" href="#__codelineno-18-4"></a><span class="w">      </span><span class="nt">&quot;must&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-18-5"><a id="__codelineno-18-5" name="__codelineno-18-5" href="#__codelineno-18-5"></a><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Elasticsearch&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-18-6"><a id="__codelineno-18-6" name="__codelineno-18-6" href="#__codelineno-18-6"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-18-7"><a id="__codelineno-18-7" name="__codelineno-18-7" href="#__codelineno-18-7"></a><span class="w">      </span><span class="nt">&quot;should&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-18-8"><a id="__codelineno-18-8" name="__codelineno-18-8" href="#__codelineno-18-8"></a><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;tutorial&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-18-9"><a id="__codelineno-18-9" name="__codelineno-18-9" href="#__codelineno-18-9"></a><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;category&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;guide&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-18-10"><a id="__codelineno-18-10" name="__codelineno-18-10" href="#__codelineno-18-10"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-18-11"><a id="__codelineno-18-11" name="__codelineno-18-11" href="#__codelineno-18-11"></a><span class="w">      </span><span class="nt">&quot;must_not&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-18-12"><a id="__codelineno-18-12" name="__codelineno-18-12" href="#__codelineno-18-12"></a><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;term&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;archived&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-18-13"><a id="__codelineno-18-13" name="__codelineno-18-13" href="#__codelineno-18-13"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-18-14"><a id="__codelineno-18-14" name="__codelineno-18-14" href="#__codelineno-18-14"></a><span class="w">      </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-18-15"><a id="__codelineno-18-15" name="__codelineno-18-15" href="#__codelineno-18-15"></a><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;range&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;publish_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;gte&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;2023-01-01&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-18-16"><a id="__codelineno-18-16" name="__codelineno-18-16" href="#__codelineno-18-16"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-18-17"><a id="__codelineno-18-17" name="__codelineno-18-17" href="#__codelineno-18-17"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-18-18"><a id="__codelineno-18-18" name="__codelineno-18-18" href="#__codelineno-18-18"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-18-19"><a id="__codelineno-18-19" name="__codelineno-18-19" href="#__codelineno-18-19"></a><span class="p">}</span>
</span></code></pre></div>
This query retrieves documents with "Elasticsearch" in the title, optionally boosts relevance if the document is in "tutorial" or "guide" categories, excludes documents marked as "archived," and only includes documents published after January 1, 2023.</p>
<h3 id="422-dis-max-query-disjunction-max">4.2.2.  <strong>Dis Max Query</strong> (disjunction max):<a class="headerlink" href="#422-dis-max-query-disjunction-max" title="Permanent link">&para;</a></h3>
<p>Optimizes for the highest relevance score among multiple queries, often used when querying across similar fields with varied wording.
- Example: Searching for the most relevant match between “title” and “description” fields:
    <div class="language-json highlight"><pre><span></span><code><span id="__span-19-1"><a id="__codelineno-19-1" name="__codelineno-19-1" href="#__codelineno-19-1"></a><span class="p">{</span>
</span><span id="__span-19-2"><a id="__codelineno-19-2" name="__codelineno-19-2" href="#__codelineno-19-2"></a><span class="w">    </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-3"><a id="__codelineno-19-3" name="__codelineno-19-3" href="#__codelineno-19-3"></a><span class="w">        </span><span class="nt">&quot;dis_max&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-19-4"><a id="__codelineno-19-4" name="__codelineno-19-4" href="#__codelineno-19-4"></a><span class="w">            </span><span class="nt">&quot;queries&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-19-5"><a id="__codelineno-19-5" name="__codelineno-19-5" href="#__codelineno-19-5"></a><span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;title&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;elastic search&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-19-6"><a id="__codelineno-19-6" name="__codelineno-19-6" href="#__codelineno-19-6"></a><span class="w">                </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;elastic search&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-19-7"><a id="__codelineno-19-7" name="__codelineno-19-7" href="#__codelineno-19-7"></a><span class="w">            </span><span class="p">]</span>
</span><span id="__span-19-8"><a id="__codelineno-19-8" name="__codelineno-19-8" href="#__codelineno-19-8"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-19-9"><a id="__codelineno-19-9" name="__codelineno-19-9" href="#__codelineno-19-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-19-10"><a id="__codelineno-19-10" name="__codelineno-19-10" href="#__codelineno-19-10"></a><span class="p">}</span>
</span></code></pre></div></p>
<h3 id="43-geo-queries">4.3 <strong>Geo Queries</strong><a class="headerlink" href="#43-geo-queries" title="Permanent link">&para;</a></h3>
<p>Elasticsearch provides several geo-specific queries for filtering and scoring documents based on geographic location:</p>
<h3 id="431-geo-bounding-box-query">4.3.1 <strong>Geo Bounding Box Query</strong><a class="headerlink" href="#431-geo-bounding-box-query" title="Permanent link">&para;</a></h3>
<p>Defines a rectangular area by specifying two corner points (top-left and bottom-right). Documents with locations inside this box are matched.</p>
<ul>
<li>Example: Find documents within a bounding box.
    <div class="language-json highlight"><pre><span></span><code><span id="__span-20-1"><a id="__codelineno-20-1" name="__codelineno-20-1" href="#__codelineno-20-1"></a><span class="p">{</span>
</span><span id="__span-20-2"><a id="__codelineno-20-2" name="__codelineno-20-2" href="#__codelineno-20-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-3"><a id="__codelineno-20-3" name="__codelineno-20-3" href="#__codelineno-20-3"></a><span class="w">    </span><span class="nt">&quot;geo_bounding_box&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-4"><a id="__codelineno-20-4" name="__codelineno-20-4" href="#__codelineno-20-4"></a><span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-5"><a id="__codelineno-20-5" name="__codelineno-20-5" href="#__codelineno-20-5"></a><span class="w">        </span><span class="nt">&quot;top_left&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-6"><a id="__codelineno-20-6" name="__codelineno-20-6" href="#__codelineno-20-6"></a><span class="w">          </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">40.73</span><span class="p">,</span>
</span><span id="__span-20-7"><a id="__codelineno-20-7" name="__codelineno-20-7" href="#__codelineno-20-7"></a><span class="w">          </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-74.1</span>
</span><span id="__span-20-8"><a id="__codelineno-20-8" name="__codelineno-20-8" href="#__codelineno-20-8"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-20-9"><a id="__codelineno-20-9" name="__codelineno-20-9" href="#__codelineno-20-9"></a><span class="w">        </span><span class="nt">&quot;bottom_right&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-20-10"><a id="__codelineno-20-10" name="__codelineno-20-10" href="#__codelineno-20-10"></a><span class="w">          </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">40.01</span><span class="p">,</span>
</span><span id="__span-20-11"><a id="__codelineno-20-11" name="__codelineno-20-11" href="#__codelineno-20-11"></a><span class="w">          </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-71.12</span>
</span><span id="__span-20-12"><a id="__codelineno-20-12" name="__codelineno-20-12" href="#__codelineno-20-12"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-20-13"><a id="__codelineno-20-13" name="__codelineno-20-13" href="#__codelineno-20-13"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-20-14"><a id="__codelineno-20-14" name="__codelineno-20-14" href="#__codelineno-20-14"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-20-15"><a id="__codelineno-20-15" name="__codelineno-20-15" href="#__codelineno-20-15"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-20-16"><a id="__codelineno-20-16" name="__codelineno-20-16" href="#__codelineno-20-16"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="432-geo-distance-query">4.3.2 <strong>Geo Distance Query</strong><a class="headerlink" href="#432-geo-distance-query" title="Permanent link">&para;</a></h3>
<p>Finds documents within a certain distance from a point. Useful for proximity searches, like "find stores within 10 miles."</p>
<ul>
<li>Example: Search within a 50 km radius.
    <div class="language-json highlight"><pre><span></span><code><span id="__span-21-1"><a id="__codelineno-21-1" name="__codelineno-21-1" href="#__codelineno-21-1"></a><span class="p">{</span>
</span><span id="__span-21-2"><a id="__codelineno-21-2" name="__codelineno-21-2" href="#__codelineno-21-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-3"><a id="__codelineno-21-3" name="__codelineno-21-3" href="#__codelineno-21-3"></a><span class="w">    </span><span class="nt">&quot;geo_distance&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-4"><a id="__codelineno-21-4" name="__codelineno-21-4" href="#__codelineno-21-4"></a><span class="w">      </span><span class="nt">&quot;distance&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50km&quot;</span><span class="p">,</span>
</span><span id="__span-21-5"><a id="__codelineno-21-5" name="__codelineno-21-5" href="#__codelineno-21-5"></a><span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-21-6"><a id="__codelineno-21-6" name="__codelineno-21-6" href="#__codelineno-21-6"></a><span class="w">        </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">40.7128</span><span class="p">,</span>
</span><span id="__span-21-7"><a id="__codelineno-21-7" name="__codelineno-21-7" href="#__codelineno-21-7"></a><span class="w">        </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-74.0060</span>
</span><span id="__span-21-8"><a id="__codelineno-21-8" name="__codelineno-21-8" href="#__codelineno-21-8"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-21-9"><a id="__codelineno-21-9" name="__codelineno-21-9" href="#__codelineno-21-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-21-10"><a id="__codelineno-21-10" name="__codelineno-21-10" href="#__codelineno-21-10"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-21-11"><a id="__codelineno-21-11" name="__codelineno-21-11" href="#__codelineno-21-11"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="433-geo-polygon-query">4.3.3 <strong>Geo Polygon Query</strong><a class="headerlink" href="#433-geo-polygon-query" title="Permanent link">&para;</a></h3>
<p>Searches within a polygon defined by a series of latitude and longitude points, allowing for irregular area shapes.</p>
<ul>
<li>Example: Match locations within a polygon.
    <div class="language-json highlight"><pre><span></span><code><span id="__span-22-1"><a id="__codelineno-22-1" name="__codelineno-22-1" href="#__codelineno-22-1"></a><span class="p">{</span>
</span><span id="__span-22-2"><a id="__codelineno-22-2" name="__codelineno-22-2" href="#__codelineno-22-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-3"><a id="__codelineno-22-3" name="__codelineno-22-3" href="#__codelineno-22-3"></a><span class="w">    </span><span class="nt">&quot;geo_polygon&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-4"><a id="__codelineno-22-4" name="__codelineno-22-4" href="#__codelineno-22-4"></a><span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-22-5"><a id="__codelineno-22-5" name="__codelineno-22-5" href="#__codelineno-22-5"></a><span class="w">        </span><span class="nt">&quot;points&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-22-6"><a id="__codelineno-22-6" name="__codelineno-22-6" href="#__codelineno-22-6"></a><span class="w">          </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">40.73</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-74.1</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-22-7"><a id="__codelineno-22-7" name="__codelineno-22-7" href="#__codelineno-22-7"></a><span class="w">          </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">40.01</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-71.12</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-22-8"><a id="__codelineno-22-8" name="__codelineno-22-8" href="#__codelineno-22-8"></a><span class="w">          </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">39.73</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-73.1</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-22-9"><a id="__codelineno-22-9" name="__codelineno-22-9" href="#__codelineno-22-9"></a><span class="w">        </span><span class="p">]</span>
</span><span id="__span-22-10"><a id="__codelineno-22-10" name="__codelineno-22-10" href="#__codelineno-22-10"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-22-11"><a id="__codelineno-22-11" name="__codelineno-22-11" href="#__codelineno-22-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-22-12"><a id="__codelineno-22-12" name="__codelineno-22-12" href="#__codelineno-22-12"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-22-13"><a id="__codelineno-22-13" name="__codelineno-22-13" href="#__codelineno-22-13"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="434-geo-shape-query">4.3.4 <strong>Geo Shape Query</strong><a class="headerlink" href="#434-geo-shape-query" title="Permanent link">&para;</a></h3>
<p>The <code>geo_shape</code> query allows for more complex spatial filtering, using pre-defined shapes like circles, polygons, or lines. This is often used with indexed geometries.</p>
<ul>
<li>Example: Search within a complex shape (circle or custom shape).
    <div class="language-json highlight"><pre><span></span><code><span id="__span-23-1"><a id="__codelineno-23-1" name="__codelineno-23-1" href="#__codelineno-23-1"></a><span class="p">{</span>
</span><span id="__span-23-2"><a id="__codelineno-23-2" name="__codelineno-23-2" href="#__codelineno-23-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-3"><a id="__codelineno-23-3" name="__codelineno-23-3" href="#__codelineno-23-3"></a><span class="w">    </span><span class="nt">&quot;geo_shape&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-4"><a id="__codelineno-23-4" name="__codelineno-23-4" href="#__codelineno-23-4"></a><span class="w">      </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-5"><a id="__codelineno-23-5" name="__codelineno-23-5" href="#__codelineno-23-5"></a><span class="w">        </span><span class="nt">&quot;shape&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-23-6"><a id="__codelineno-23-6" name="__codelineno-23-6" href="#__codelineno-23-6"></a><span class="w">          </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;circle&quot;</span><span class="p">,</span>
</span><span id="__span-23-7"><a id="__codelineno-23-7" name="__codelineno-23-7" href="#__codelineno-23-7"></a><span class="w">          </span><span class="nt">&quot;coordinates&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mf">-74.1</span><span class="p">,</span><span class="w"> </span><span class="mf">40.73</span><span class="p">],</span>
</span><span id="__span-23-8"><a id="__codelineno-23-8" name="__codelineno-23-8" href="#__codelineno-23-8"></a><span class="w">          </span><span class="nt">&quot;radius&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1000m&quot;</span>
</span><span id="__span-23-9"><a id="__codelineno-23-9" name="__codelineno-23-9" href="#__codelineno-23-9"></a><span class="w">        </span><span class="p">},</span>
</span><span id="__span-23-10"><a id="__codelineno-23-10" name="__codelineno-23-10" href="#__codelineno-23-10"></a><span class="w">        </span><span class="nt">&quot;relation&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;within&quot;</span>
</span><span id="__span-23-11"><a id="__codelineno-23-11" name="__codelineno-23-11" href="#__codelineno-23-11"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-23-12"><a id="__codelineno-23-12" name="__codelineno-23-12" href="#__codelineno-23-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-23-13"><a id="__codelineno-23-13" name="__codelineno-23-13" href="#__codelineno-23-13"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-23-14"><a id="__codelineno-23-14" name="__codelineno-23-14" href="#__codelineno-23-14"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="435-using-geo-filters-with-bool-queries"><strong>4.3.5 Using Geo Filters with Bool Queries</strong><a class="headerlink" href="#435-using-geo-filters-with-bool-queries" title="Permanent link">&para;</a></h3>
<p>Geo filters are often used in combination with other query types within <code>bool</code> queries, allowing flexible, location-based filtering along with other criteria.</p>
<h4 id="example-of-a-combined-geo-and-bool-query">Example of a Combined Geo and Bool Query<a class="headerlink" href="#example-of-a-combined-geo-and-bool-query" title="Permanent link">&para;</a></h4>
<p>Finds published documents within a specific area and filters out archived content.</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-24-1"><a id="__codelineno-24-1" name="__codelineno-24-1" href="#__codelineno-24-1"></a><span class="p">{</span>
</span><span id="__span-24-2"><a id="__codelineno-24-2" name="__codelineno-24-2" href="#__codelineno-24-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-3"><a id="__codelineno-24-3" name="__codelineno-24-3" href="#__codelineno-24-3"></a><span class="w">    </span><span class="nt">&quot;bool&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-4"><a id="__codelineno-24-4" name="__codelineno-24-4" href="#__codelineno-24-4"></a><span class="w">      </span><span class="nt">&quot;must&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-24-5"><a id="__codelineno-24-5" name="__codelineno-24-5" href="#__codelineno-24-5"></a><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;term&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;published&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-24-6"><a id="__codelineno-24-6" name="__codelineno-24-6" href="#__codelineno-24-6"></a><span class="w">      </span><span class="p">],</span>
</span><span id="__span-24-7"><a id="__codelineno-24-7" name="__codelineno-24-7" href="#__codelineno-24-7"></a><span class="w">      </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-8"><a id="__codelineno-24-8" name="__codelineno-24-8" href="#__codelineno-24-8"></a><span class="w">        </span><span class="nt">&quot;geo_distance&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-9"><a id="__codelineno-24-9" name="__codelineno-24-9" href="#__codelineno-24-9"></a><span class="w">          </span><span class="nt">&quot;distance&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50km&quot;</span><span class="p">,</span>
</span><span id="__span-24-10"><a id="__codelineno-24-10" name="__codelineno-24-10" href="#__codelineno-24-10"></a><span class="w">          </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-24-11"><a id="__codelineno-24-11" name="__codelineno-24-11" href="#__codelineno-24-11"></a><span class="w">            </span><span class="nt">&quot;lat&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">40.7128</span><span class="p">,</span>
</span><span id="__span-24-12"><a id="__codelineno-24-12" name="__codelineno-24-12" href="#__codelineno-24-12"></a><span class="w">            </span><span class="nt">&quot;lon&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">-74.0060</span>
</span><span id="__span-24-13"><a id="__codelineno-24-13" name="__codelineno-24-13" href="#__codelineno-24-13"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-24-14"><a id="__codelineno-24-14" name="__codelineno-24-14" href="#__codelineno-24-14"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-24-15"><a id="__codelineno-24-15" name="__codelineno-24-15" href="#__codelineno-24-15"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-24-16"><a id="__codelineno-24-16" name="__codelineno-24-16" href="#__codelineno-24-16"></a><span class="w">      </span><span class="nt">&quot;must_not&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-24-17"><a id="__codelineno-24-17" name="__codelineno-24-17" href="#__codelineno-24-17"></a><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;term&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;status&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;archived&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-24-18"><a id="__codelineno-24-18" name="__codelineno-24-18" href="#__codelineno-24-18"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-24-19"><a id="__codelineno-24-19" name="__codelineno-24-19" href="#__codelineno-24-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-24-20"><a id="__codelineno-24-20" name="__codelineno-24-20" href="#__codelineno-24-20"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-24-21"><a id="__codelineno-24-21" name="__codelineno-24-21" href="#__codelineno-24-21"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="summary-of-elastic-queries">Summary of Elastic Queries<a class="headerlink" href="#summary-of-elastic-queries" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Match queries</strong> are ideal for full-text fields requiring analysis (e.g., descriptions).</li>
<li><strong>Term queries</strong> work well with keyword fields needing exact matches (e.g., IDs).</li>
<li><strong>Bool queries</strong> allow complex logic with filtering and relevance.</li>
<li><strong>Dis Max queries</strong> maximize relevance across similar fields.</li>
<li><strong>Geo Bounding Box</strong> for rectangular areas.</li>
<li><strong>Geo Distance</strong> for proximity.</li>
<li><strong>Geo Polygon</strong> for custom shapes.</li>
<li><strong>Geo Shape</strong> for complex spatial data.</li>
</ul>
<p>These queries, combined thoughtfully, make Elasticsearch highly adaptable to various search needs.</p>
<hr />
<h3 id="5-aggregations">5. Aggregations<a class="headerlink" href="#5-aggregations" title="Permanent link">&para;</a></h3>
<hr />
<p>Elasticsearch’s aggregation framework is divided into <strong>metrics</strong> and <strong>bucket aggregations</strong>. Here’s a deep dive into each, with subtypes and examples.</p>
<h3 id="51-metrics-aggregations"><strong>5.1. Metrics Aggregations</strong><a class="headerlink" href="#51-metrics-aggregations" title="Permanent link">&para;</a></h3>
<p>These calculate values from field data, like sums or averages.</p>
<ul>
<li><strong>Avg Aggregation</strong>: Computes the average for numeric fields.</li>
<li>
<p>Example: Calculate average price across documents.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-25-1"><a id="__codelineno-25-1" name="__codelineno-25-1" href="#__codelineno-25-1"></a><span class="p">{</span>
</span><span id="__span-25-2"><a id="__codelineno-25-2" name="__codelineno-25-2" href="#__codelineno-25-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-25-3"><a id="__codelineno-25-3" name="__codelineno-25-3" href="#__codelineno-25-3"></a><span class="w">    </span><span class="nt">&quot;avg_price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;avg&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;price&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-25-4"><a id="__codelineno-25-4" name="__codelineno-25-4" href="#__codelineno-25-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-25-5"><a id="__codelineno-25-5" name="__codelineno-25-5" href="#__codelineno-25-5"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Sum Aggregation</strong>: Totals numeric field values.</p>
</li>
<li>
<p>Example: Sum of all sales amounts.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-26-1"><a id="__codelineno-26-1" name="__codelineno-26-1" href="#__codelineno-26-1"></a><span class="p">{</span>
</span><span id="__span-26-2"><a id="__codelineno-26-2" name="__codelineno-26-2" href="#__codelineno-26-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-26-3"><a id="__codelineno-26-3" name="__codelineno-26-3" href="#__codelineno-26-3"></a><span class="w">    </span><span class="nt">&quot;total_sales&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;sum&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;amount&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-26-4"><a id="__codelineno-26-4" name="__codelineno-26-4" href="#__codelineno-26-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-26-5"><a id="__codelineno-26-5" name="__codelineno-26-5" href="#__codelineno-26-5"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Min/Max Aggregations</strong>: Find minimum or maximum field values.</p>
</li>
<li>
<p>Example: Find the highest score.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-27-1"><a id="__codelineno-27-1" name="__codelineno-27-1" href="#__codelineno-27-1"></a><span class="p">{</span>
</span><span id="__span-27-2"><a id="__codelineno-27-2" name="__codelineno-27-2" href="#__codelineno-27-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-27-3"><a id="__codelineno-27-3" name="__codelineno-27-3" href="#__codelineno-27-3"></a><span class="w">    </span><span class="nt">&quot;max_score&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;max&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;score&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-27-4"><a id="__codelineno-27-4" name="__codelineno-27-4" href="#__codelineno-27-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-27-5"><a id="__codelineno-27-5" name="__codelineno-27-5" href="#__codelineno-27-5"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Stats Aggregation</strong>: Generates summary stats (min, max, avg, sum, count).</p>
</li>
<li>
<p>Example: Summarize views across articles.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-28-1"><a id="__codelineno-28-1" name="__codelineno-28-1" href="#__codelineno-28-1"></a><span class="p">{</span>
</span><span id="__span-28-2"><a id="__codelineno-28-2" name="__codelineno-28-2" href="#__codelineno-28-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-28-3"><a id="__codelineno-28-3" name="__codelineno-28-3" href="#__codelineno-28-3"></a><span class="w">    </span><span class="nt">&quot;article_views&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;stats&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;views&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-28-4"><a id="__codelineno-28-4" name="__codelineno-28-4" href="#__codelineno-28-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-28-5"><a id="__codelineno-28-5" name="__codelineno-28-5" href="#__codelineno-28-5"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Cardinality Aggregation</strong>: Counts unique values.</p>
</li>
<li>
<p>Example: Count unique users by ID.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-29-1"><a id="__codelineno-29-1" name="__codelineno-29-1" href="#__codelineno-29-1"></a><span class="p">{</span>
</span><span id="__span-29-2"><a id="__codelineno-29-2" name="__codelineno-29-2" href="#__codelineno-29-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-29-3"><a id="__codelineno-29-3" name="__codelineno-29-3" href="#__codelineno-29-3"></a><span class="w">    </span><span class="nt">&quot;unique_users&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;cardinality&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;user_id&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-29-4"><a id="__codelineno-29-4" name="__codelineno-29-4" href="#__codelineno-29-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-29-5"><a id="__codelineno-29-5" name="__codelineno-29-5" href="#__codelineno-29-5"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Percentiles/Percentile Ranks Aggregations</strong>: Show value distribution.</p>
</li>
<li>Example: Get 50<sup>th</sup>, 90<sup>th</sup>, and 99<sup>th</sup> percentiles for response times.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-30-1"><a id="__codelineno-30-1" name="__codelineno-30-1" href="#__codelineno-30-1"></a><span class="p">{</span>
</span><span id="__span-30-2"><a id="__codelineno-30-2" name="__codelineno-30-2" href="#__codelineno-30-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-3"><a id="__codelineno-30-3" name="__codelineno-30-3" href="#__codelineno-30-3"></a><span class="w">    </span><span class="nt">&quot;response_percentiles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-30-4"><a id="__codelineno-30-4" name="__codelineno-30-4" href="#__codelineno-30-4"></a><span class="w">      </span><span class="nt">&quot;percentiles&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;response_time&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;percents&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">50</span><span class="p">,</span><span class="w"> </span><span class="mi">90</span><span class="p">,</span><span class="w"> </span><span class="mi">99</span><span class="p">]</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-30-5"><a id="__codelineno-30-5" name="__codelineno-30-5" href="#__codelineno-30-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-30-6"><a id="__codelineno-30-6" name="__codelineno-30-6" href="#__codelineno-30-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-30-7"><a id="__codelineno-30-7" name="__codelineno-30-7" href="#__codelineno-30-7"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="52-bucket-aggregations"><strong>5.2. Bucket Aggregations</strong><a class="headerlink" href="#52-bucket-aggregations" title="Permanent link">&para;</a></h3>
<p>These create groups (buckets) of documents based on field values or criteria. Each bucket can contain documents matching conditions and may contain further sub-aggregations.</p>
<ul>
<li><strong>Terms Aggregation</strong>: Groups documents by unique terms.</li>
<li>
<p>Example: Group documents by category.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-31-1"><a id="__codelineno-31-1" name="__codelineno-31-1" href="#__codelineno-31-1"></a><span class="p">{</span>
</span><span id="__span-31-2"><a id="__codelineno-31-2" name="__codelineno-31-2" href="#__codelineno-31-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-31-3"><a id="__codelineno-31-3" name="__codelineno-31-3" href="#__codelineno-31-3"></a><span class="w">    </span><span class="nt">&quot;by_category&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;terms&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;category&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-31-4"><a id="__codelineno-31-4" name="__codelineno-31-4" href="#__codelineno-31-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-31-5"><a id="__codelineno-31-5" name="__codelineno-31-5" href="#__codelineno-31-5"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Range Aggregation</strong>: Group documents within defined ranges.</p>
</li>
<li>
<p>Example: Bucket users by age ranges.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-32-1"><a id="__codelineno-32-1" name="__codelineno-32-1" href="#__codelineno-32-1"></a><span class="p">{</span>
</span><span id="__span-32-2"><a id="__codelineno-32-2" name="__codelineno-32-2" href="#__codelineno-32-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-3"><a id="__codelineno-32-3" name="__codelineno-32-3" href="#__codelineno-32-3"></a><span class="w">    </span><span class="nt">&quot;age_ranges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-32-4"><a id="__codelineno-32-4" name="__codelineno-32-4" href="#__codelineno-32-4"></a><span class="w">      </span><span class="nt">&quot;range&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;age&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;ranges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nt">&quot;to&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;to&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">}]</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-32-5"><a id="__codelineno-32-5" name="__codelineno-32-5" href="#__codelineno-32-5"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-32-6"><a id="__codelineno-32-6" name="__codelineno-32-6" href="#__codelineno-32-6"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-32-7"><a id="__codelineno-32-7" name="__codelineno-32-7" href="#__codelineno-32-7"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Date Histogram</strong>: Buckets documents based on date intervals (e.g., daily, monthly).</p>
</li>
<li>
<p>Example: Group events by month.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-33-1"><a id="__codelineno-33-1" name="__codelineno-33-1" href="#__codelineno-33-1"></a><span class="p">{</span>
</span><span id="__span-33-2"><a id="__codelineno-33-2" name="__codelineno-33-2" href="#__codelineno-33-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-33-3"><a id="__codelineno-33-3" name="__codelineno-33-3" href="#__codelineno-33-3"></a><span class="w">    </span><span class="nt">&quot;monthly_events&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;date_histogram&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;date&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;calendar_interval&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;month&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-33-4"><a id="__codelineno-33-4" name="__codelineno-33-4" href="#__codelineno-33-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-33-5"><a id="__codelineno-33-5" name="__codelineno-33-5" href="#__codelineno-33-5"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Histogram Aggregation</strong>: Creates buckets based on custom numeric ranges.</p>
</li>
<li>
<p>Example: Histogram of item prices.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-34-1"><a id="__codelineno-34-1" name="__codelineno-34-1" href="#__codelineno-34-1"></a><span class="p">{</span>
</span><span id="__span-34-2"><a id="__codelineno-34-2" name="__codelineno-34-2" href="#__codelineno-34-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-34-3"><a id="__codelineno-34-3" name="__codelineno-34-3" href="#__codelineno-34-3"></a><span class="w">    </span><span class="nt">&quot;price_histogram&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;histogram&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;price&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;interval&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-34-4"><a id="__codelineno-34-4" name="__codelineno-34-4" href="#__codelineno-34-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-34-5"><a id="__codelineno-34-5" name="__codelineno-34-5" href="#__codelineno-34-5"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Filter Aggregation</strong>: Buckets documents matching a specific filter.</p>
</li>
<li>
<p>Example: Filter for high-value orders.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-35-1"><a id="__codelineno-35-1" name="__codelineno-35-1" href="#__codelineno-35-1"></a><span class="p">{</span>
</span><span id="__span-35-2"><a id="__codelineno-35-2" name="__codelineno-35-2" href="#__codelineno-35-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-35-3"><a id="__codelineno-35-3" name="__codelineno-35-3" href="#__codelineno-35-3"></a><span class="w">    </span><span class="nt">&quot;high_value_orders&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;range&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;gt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-35-4"><a id="__codelineno-35-4" name="__codelineno-35-4" href="#__codelineno-35-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-35-5"><a id="__codelineno-35-5" name="__codelineno-35-5" href="#__codelineno-35-5"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Filters Aggregation</strong>: Allows multiple filter buckets in a single query.</p>
</li>
<li>
<p>Example: Separate buckets for high and low prices.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-36-1"><a id="__codelineno-36-1" name="__codelineno-36-1" href="#__codelineno-36-1"></a><span class="p">{</span>
</span><span id="__span-36-2"><a id="__codelineno-36-2" name="__codelineno-36-2" href="#__codelineno-36-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-3"><a id="__codelineno-36-3" name="__codelineno-36-3" href="#__codelineno-36-3"></a><span class="w">    </span><span class="nt">&quot;price_buckets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-4"><a id="__codelineno-36-4" name="__codelineno-36-4" href="#__codelineno-36-4"></a><span class="w">      </span><span class="nt">&quot;filters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-5"><a id="__codelineno-36-5" name="__codelineno-36-5" href="#__codelineno-36-5"></a><span class="w">        </span><span class="nt">&quot;filters&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-36-6"><a id="__codelineno-36-6" name="__codelineno-36-6" href="#__codelineno-36-6"></a><span class="w">          </span><span class="nt">&quot;expensive&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;range&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;gt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-36-7"><a id="__codelineno-36-7" name="__codelineno-36-7" href="#__codelineno-36-7"></a><span class="w">          </span><span class="nt">&quot;cheap&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;range&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;lt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-36-8"><a id="__codelineno-36-8" name="__codelineno-36-8" href="#__codelineno-36-8"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-36-9"><a id="__codelineno-36-9" name="__codelineno-36-9" href="#__codelineno-36-9"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-36-10"><a id="__codelineno-36-10" name="__codelineno-36-10" href="#__codelineno-36-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-36-11"><a id="__codelineno-36-11" name="__codelineno-36-11" href="#__codelineno-36-11"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-36-12"><a id="__codelineno-36-12" name="__codelineno-36-12" href="#__codelineno-36-12"></a><span class="p">}</span>
</span></code></pre></div></p>
</li>
<li>
<p><strong>Geohash Grid Aggregation</strong>: For geolocation-based bucketing, especially with maps.</p>
</li>
<li>Example: Group location data by geohash grid.
     <div class="language-json highlight"><pre><span></span><code><span id="__span-37-1"><a id="__codelineno-37-1" name="__codelineno-37-1" href="#__codelineno-37-1"></a><span class="p">{</span>
</span><span id="__span-37-2"><a id="__codelineno-37-2" name="__codelineno-37-2" href="#__codelineno-37-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-37-3"><a id="__codelineno-37-3" name="__codelineno-37-3" href="#__codelineno-37-3"></a><span class="w">    </span><span class="nt">&quot;geo_buckets&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;geohash_grid&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;location&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;precision&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">5</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-37-4"><a id="__codelineno-37-4" name="__codelineno-37-4" href="#__codelineno-37-4"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-37-5"><a id="__codelineno-37-5" name="__codelineno-37-5" href="#__codelineno-37-5"></a><span class="p">}</span>
</span></code></pre></div></li>
</ul>
<h3 id="53-combining-aggregations"><strong>5.3. Combining Aggregations</strong><a class="headerlink" href="#53-combining-aggregations" title="Permanent link">&para;</a></h3>
<p>Each aggregation can nest other aggregations, allowing complex analysis structures.</p>
<h4 id="example-of-a-combined-aggregation">Example of a Combined Aggregation<a class="headerlink" href="#example-of-a-combined-aggregation" title="Permanent link">&para;</a></h4>
<p>Calculate the average order amount by city and age range:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-38-1"><a id="__codelineno-38-1" name="__codelineno-38-1" href="#__codelineno-38-1"></a><span class="p">{</span>
</span><span id="__span-38-2"><a id="__codelineno-38-2" name="__codelineno-38-2" href="#__codelineno-38-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-3"><a id="__codelineno-38-3" name="__codelineno-38-3" href="#__codelineno-38-3"></a><span class="w">    </span><span class="nt">&quot;by_city&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-4"><a id="__codelineno-38-4" name="__codelineno-38-4" href="#__codelineno-38-4"></a><span class="w">      </span><span class="nt">&quot;terms&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;city&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-38-5"><a id="__codelineno-38-5" name="__codelineno-38-5" href="#__codelineno-38-5"></a><span class="w">      </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-6"><a id="__codelineno-38-6" name="__codelineno-38-6" href="#__codelineno-38-6"></a><span class="w">        </span><span class="nt">&quot;age_ranges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-7"><a id="__codelineno-38-7" name="__codelineno-38-7" href="#__codelineno-38-7"></a><span class="w">          </span><span class="nt">&quot;range&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;age&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;ranges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[{</span><span class="w"> </span><span class="nt">&quot;to&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;to&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">30</span><span class="w"> </span><span class="p">}]</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-38-8"><a id="__codelineno-38-8" name="__codelineno-38-8" href="#__codelineno-38-8"></a><span class="w">          </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-38-9"><a id="__codelineno-38-9" name="__codelineno-38-9" href="#__codelineno-38-9"></a><span class="w">            </span><span class="nt">&quot;avg_order_amount&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;avg&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;order_amount&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-38-10"><a id="__codelineno-38-10" name="__codelineno-38-10" href="#__codelineno-38-10"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-38-11"><a id="__codelineno-38-11" name="__codelineno-38-11" href="#__codelineno-38-11"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-38-12"><a id="__codelineno-38-12" name="__codelineno-38-12" href="#__codelineno-38-12"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-38-13"><a id="__codelineno-38-13" name="__codelineno-38-13" href="#__codelineno-38-13"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-38-14"><a id="__codelineno-38-14" name="__codelineno-38-14" href="#__codelineno-38-14"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-38-15"><a id="__codelineno-38-15" name="__codelineno-38-15" href="#__codelineno-38-15"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="summary-of-aggregations">Summary of Aggregations<a class="headerlink" href="#summary-of-aggregations" title="Permanent link">&para;</a></h3>
<p>With these aggregations, Elasticsearch becomes a powerful analytics engine, enabling sophisticated data analysis directly within the index.</p>
<hr />
<h3 id="6-sorting">6. Sorting<a class="headerlink" href="#6-sorting" title="Permanent link">&para;</a></h3>
<hr />
<h3 id="61-basic-sorting">6.1. <strong>Basic Sorting</strong><a class="headerlink" href="#61-basic-sorting" title="Permanent link">&para;</a></h3>
<ul>
<li>By default, Elasticsearch sorts results by <code>_score</code> (relevance-based sorting).</li>
<li>To sort by a specific field, use <code>sort</code> in the query.</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-39-1"><a id="__codelineno-39-1" name="__codelineno-39-1" href="#__codelineno-39-1"></a><span class="p">{</span>
</span><span id="__span-39-2"><a id="__codelineno-39-2" name="__codelineno-39-2" href="#__codelineno-39-2"></a><span class="w">  </span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-39-3"><a id="__codelineno-39-3" name="__codelineno-39-3" href="#__codelineno-39-3"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;order&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asc&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-39-4"><a id="__codelineno-39-4" name="__codelineno-39-4" href="#__codelineno-39-4"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-39-5"><a id="__codelineno-39-5" name="__codelineno-39-5" href="#__codelineno-39-5"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-39-6"><a id="__codelineno-39-6" name="__codelineno-39-6" href="#__codelineno-39-6"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="62-field-based-sorting">6.2. <strong>Field-based Sorting</strong><a class="headerlink" href="#62-field-based-sorting" title="Permanent link">&para;</a></h3>
<ul>
<li>Sortable fields should be of numeric, date, or keyword type (for text, use <code>keyword</code> fields).</li>
<li>Example sorting by a date field:</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-40-1"><a id="__codelineno-40-1" name="__codelineno-40-1" href="#__codelineno-40-1"></a><span class="p">{</span>
</span><span id="__span-40-2"><a id="__codelineno-40-2" name="__codelineno-40-2" href="#__codelineno-40-2"></a><span class="w">  </span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-40-3"><a id="__codelineno-40-3" name="__codelineno-40-3" href="#__codelineno-40-3"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;release_date&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;order&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;desc&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-40-4"><a id="__codelineno-40-4" name="__codelineno-40-4" href="#__codelineno-40-4"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-40-5"><a id="__codelineno-40-5" name="__codelineno-40-5" href="#__codelineno-40-5"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-40-6"><a id="__codelineno-40-6" name="__codelineno-40-6" href="#__codelineno-40-6"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="63-multiple-sort-fields">6.3. <strong>Multiple Sort Fields</strong><a class="headerlink" href="#63-multiple-sort-fields" title="Permanent link">&para;</a></h3>
<ul>
<li>Specify multiple sort criteria, with the first sort field taking precedence.</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-41-1"><a id="__codelineno-41-1" name="__codelineno-41-1" href="#__codelineno-41-1"></a><span class="p">{</span>
</span><span id="__span-41-2"><a id="__codelineno-41-2" name="__codelineno-41-2" href="#__codelineno-41-2"></a><span class="w">  </span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-41-3"><a id="__codelineno-41-3" name="__codelineno-41-3" href="#__codelineno-41-3"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;order&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asc&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-41-4"><a id="__codelineno-41-4" name="__codelineno-41-4" href="#__codelineno-41-4"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;rating&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;order&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;desc&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-41-5"><a id="__codelineno-41-5" name="__codelineno-41-5" href="#__codelineno-41-5"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-41-6"><a id="__codelineno-41-6" name="__codelineno-41-6" href="#__codelineno-41-6"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-41-7"><a id="__codelineno-41-7" name="__codelineno-41-7" href="#__codelineno-41-7"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="64-nested-sorting">6.4. <strong>Nested Sorting</strong><a class="headerlink" href="#64-nested-sorting" title="Permanent link">&para;</a></h3>
<ul>
<li>For nested documents (e.g., arrays of objects), use <code>nested</code> with a path to sort by nested fields.</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-42-1"><a id="__codelineno-42-1" name="__codelineno-42-1" href="#__codelineno-42-1"></a><span class="p">{</span>
</span><span id="__span-42-2"><a id="__codelineno-42-2" name="__codelineno-42-2" href="#__codelineno-42-2"></a><span class="w">  </span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-42-3"><a id="__codelineno-42-3" name="__codelineno-42-3" href="#__codelineno-42-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-42-4"><a id="__codelineno-42-4" name="__codelineno-42-4" href="#__codelineno-42-4"></a><span class="w">      </span><span class="nt">&quot;products.price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-5"><a id="__codelineno-42-5" name="__codelineno-42-5" href="#__codelineno-42-5"></a><span class="w">        </span><span class="nt">&quot;order&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asc&quot;</span><span class="p">,</span>
</span><span id="__span-42-6"><a id="__codelineno-42-6" name="__codelineno-42-6" href="#__codelineno-42-6"></a><span class="w">        </span><span class="nt">&quot;nested&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-42-7"><a id="__codelineno-42-7" name="__codelineno-42-7" href="#__codelineno-42-7"></a><span class="w">          </span><span class="nt">&quot;path&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;products&quot;</span><span class="p">,</span>
</span><span id="__span-42-8"><a id="__codelineno-42-8" name="__codelineno-42-8" href="#__codelineno-42-8"></a><span class="w">          </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;range&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;products.price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;gt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-42-9"><a id="__codelineno-42-9" name="__codelineno-42-9" href="#__codelineno-42-9"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-42-10"><a id="__codelineno-42-10" name="__codelineno-42-10" href="#__codelineno-42-10"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-42-11"><a id="__codelineno-42-11" name="__codelineno-42-11" href="#__codelineno-42-11"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-42-12"><a id="__codelineno-42-12" name="__codelineno-42-12" href="#__codelineno-42-12"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-42-13"><a id="__codelineno-42-13" name="__codelineno-42-13" href="#__codelineno-42-13"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-42-14"><a id="__codelineno-42-14" name="__codelineno-42-14" href="#__codelineno-42-14"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="65-geolocation-sorting">6.5. <strong>Geolocation Sorting</strong><a class="headerlink" href="#65-geolocation-sorting" title="Permanent link">&para;</a></h3>
<ul>
<li>Use <code>geo_distance</code> to sort by proximity for <code>geo_point</code> fields.</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-43-1"><a id="__codelineno-43-1" name="__codelineno-43-1" href="#__codelineno-43-1"></a><span class="p">{</span>
</span><span id="__span-43-2"><a id="__codelineno-43-2" name="__codelineno-43-2" href="#__codelineno-43-2"></a><span class="w">  </span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-43-3"><a id="__codelineno-43-3" name="__codelineno-43-3" href="#__codelineno-43-3"></a><span class="w">    </span><span class="p">{</span>
</span><span id="__span-43-4"><a id="__codelineno-43-4" name="__codelineno-43-4" href="#__codelineno-43-4"></a><span class="w">      </span><span class="nt">&quot;_geo_distance&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-43-5"><a id="__codelineno-43-5" name="__codelineno-43-5" href="#__codelineno-43-5"></a><span class="w">        </span><span class="nt">&quot;location&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;40.715, -73.988&quot;</span><span class="p">,</span>
</span><span id="__span-43-6"><a id="__codelineno-43-6" name="__codelineno-43-6" href="#__codelineno-43-6"></a><span class="w">        </span><span class="nt">&quot;order&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asc&quot;</span><span class="p">,</span>
</span><span id="__span-43-7"><a id="__codelineno-43-7" name="__codelineno-43-7" href="#__codelineno-43-7"></a><span class="w">        </span><span class="nt">&quot;unit&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;km&quot;</span>
</span><span id="__span-43-8"><a id="__codelineno-43-8" name="__codelineno-43-8" href="#__codelineno-43-8"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-43-9"><a id="__codelineno-43-9" name="__codelineno-43-9" href="#__codelineno-43-9"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-43-10"><a id="__codelineno-43-10" name="__codelineno-43-10" href="#__codelineno-43-10"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-43-11"><a id="__codelineno-43-11" name="__codelineno-43-11" href="#__codelineno-43-11"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-43-12"><a id="__codelineno-43-12" name="__codelineno-43-12" href="#__codelineno-43-12"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="66-script-based-sorting">6.6. <strong>Script-based Sorting</strong><a class="headerlink" href="#66-script-based-sorting" title="Permanent link">&para;</a></h3>
<ul>
<li>Script-based sorting allows custom logic using the <code>painless</code> scripting language.</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-44-1"><a id="__codelineno-44-1" name="__codelineno-44-1" href="#__codelineno-44-1"></a><span class="p">{</span>
</span><span id="__span-44-2"><a id="__codelineno-44-2" name="__codelineno-44-2" href="#__codelineno-44-2"></a><span class="w">  </span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-3"><a id="__codelineno-44-3" name="__codelineno-44-3" href="#__codelineno-44-3"></a><span class="w">    </span><span class="nt">&quot;_script&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-4"><a id="__codelineno-44-4" name="__codelineno-44-4" href="#__codelineno-44-4"></a><span class="w">      </span><span class="nt">&quot;type&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;number&quot;</span><span class="p">,</span>
</span><span id="__span-44-5"><a id="__codelineno-44-5" name="__codelineno-44-5" href="#__codelineno-44-5"></a><span class="w">      </span><span class="nt">&quot;script&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-44-6"><a id="__codelineno-44-6" name="__codelineno-44-6" href="#__codelineno-44-6"></a><span class="w">        </span><span class="nt">&quot;source&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;doc[&#39;price&#39;].value * params.factor&quot;</span><span class="p">,</span>
</span><span id="__span-44-7"><a id="__codelineno-44-7" name="__codelineno-44-7" href="#__codelineno-44-7"></a><span class="w">        </span><span class="nt">&quot;params&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;factor&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.2</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-44-8"><a id="__codelineno-44-8" name="__codelineno-44-8" href="#__codelineno-44-8"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-44-9"><a id="__codelineno-44-9" name="__codelineno-44-9" href="#__codelineno-44-9"></a><span class="w">      </span><span class="nt">&quot;order&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;desc&quot;</span>
</span><span id="__span-44-10"><a id="__codelineno-44-10" name="__codelineno-44-10" href="#__codelineno-44-10"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-44-11"><a id="__codelineno-44-11" name="__codelineno-44-11" href="#__codelineno-44-11"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-44-12"><a id="__codelineno-44-12" name="__codelineno-44-12" href="#__codelineno-44-12"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-44-13"><a id="__codelineno-44-13" name="__codelineno-44-13" href="#__codelineno-44-13"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="67-missing-values">6.7. <strong>Missing Values</strong><a class="headerlink" href="#67-missing-values" title="Permanent link">&para;</a></h3>
<ul>
<li>Specify handling for missing values with <code>missing</code>, setting them as the highest or lowest values.</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-45-1"><a id="__codelineno-45-1" name="__codelineno-45-1" href="#__codelineno-45-1"></a><span class="p">{</span>
</span><span id="__span-45-2"><a id="__codelineno-45-2" name="__codelineno-45-2" href="#__codelineno-45-2"></a><span class="w">  </span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-45-3"><a id="__codelineno-45-3" name="__codelineno-45-3" href="#__codelineno-45-3"></a><span class="w">    </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;order&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asc&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;missing&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;_last&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-45-4"><a id="__codelineno-45-4" name="__codelineno-45-4" href="#__codelineno-45-4"></a><span class="w">  </span><span class="p">],</span>
</span><span id="__span-45-5"><a id="__codelineno-45-5" name="__codelineno-45-5" href="#__codelineno-45-5"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-45-6"><a id="__codelineno-45-6" name="__codelineno-45-6" href="#__codelineno-45-6"></a><span class="p">}</span>
</span></code></pre></div>
<h3 id="68-sorting-in-aggregations">6.8. <strong>Sorting in Aggregations</strong><a class="headerlink" href="#68-sorting-in-aggregations" title="Permanent link">&para;</a></h3>
<ul>
<li>In aggregations, sort bucket aggregations by criteria, like by <code>count</code> or custom metrics.</li>
</ul>
<div class="language-json highlight"><pre><span></span><code><span id="__span-46-1"><a id="__codelineno-46-1" name="__codelineno-46-1" href="#__codelineno-46-1"></a><span class="p">{</span>
</span><span id="__span-46-2"><a id="__codelineno-46-2" name="__codelineno-46-2" href="#__codelineno-46-2"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-3"><a id="__codelineno-46-3" name="__codelineno-46-3" href="#__codelineno-46-3"></a><span class="w">    </span><span class="nt">&quot;top_brands&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-4"><a id="__codelineno-46-4" name="__codelineno-46-4" href="#__codelineno-46-4"></a><span class="w">      </span><span class="nt">&quot;terms&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-46-5"><a id="__codelineno-46-5" name="__codelineno-46-5" href="#__codelineno-46-5"></a><span class="w">        </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;brand.keyword&quot;</span><span class="p">,</span>
</span><span id="__span-46-6"><a id="__codelineno-46-6" name="__codelineno-46-6" href="#__codelineno-46-6"></a><span class="w">        </span><span class="nt">&quot;order&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;_count&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;desc&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-46-7"><a id="__codelineno-46-7" name="__codelineno-46-7" href="#__codelineno-46-7"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-46-8"><a id="__codelineno-46-8" name="__codelineno-46-8" href="#__codelineno-46-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-46-9"><a id="__codelineno-46-9" name="__codelineno-46-9" href="#__codelineno-46-9"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-46-10"><a id="__codelineno-46-10" name="__codelineno-46-10" href="#__codelineno-46-10"></a><span class="p">}</span>
</span></code></pre></div>
<hr />
<h3 id="7-relevance-scoring">7. Relevance Scoring<a class="headerlink" href="#7-relevance-scoring" title="Permanent link">&para;</a></h3>
<hr />
<p>Elasticsearch's relevance scoring is crucial for ranking documents based on their similarity to a query. Here’s an in-depth look:</p>
<h3 id="71-scoring-mechanism-and-bm25-algorithm"><strong>7.1. Scoring Mechanism and BM25 Algorithm</strong><a class="headerlink" href="#71-scoring-mechanism-and-bm25-algorithm" title="Permanent link">&para;</a></h3>
<p>The <strong>BM25 (Best Matching 25)</strong> algorithm is Elasticsearch’s default relevance scoring algorithm. BM25 improves upon traditional TF-IDF (Term Frequency-Inverse Document Frequency) by adjusting term frequency saturation and document length normalization, providing more nuanced relevance.</p>
<h4 id="core-components-of-bm25">Core Components of BM25:<a class="headerlink" href="#core-components-of-bm25" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Term Frequency (TF)</strong>: Counts how often a term appears in a document. Higher term frequency can increase relevance, but BM25 applies diminishing returns to avoid favoring very high counts excessively.</li>
<li><strong>Inverse Document Frequency (IDF)</strong>: Rare terms across the entire dataset are given higher weight since they provide more unique information about a document.</li>
<li><strong>Document Length Normalization</strong>: BM25 penalizes longer documents, assuming shorter documents with the same term density are more relevant to the term.</li>
</ul>
<h3 id="72-calculating-the-bm25-score"><strong>7.2. Calculating the BM25 Score</strong><a class="headerlink" href="#72-calculating-the-bm25-score" title="Permanent link">&para;</a></h3>
<p>The BM25 formula combines these components, with two main parameters:
   - <strong>k1</strong>: Controls term frequency saturation (default around 1.2). Higher values give more influence to term frequency.
   - <strong>b</strong>: Controls length normalization (default around 0.75). Higher values penalize longer documents more strongly.
   - <a href="https://www.elastic.co/blog/practical-bm25-part-2-the-bm25-algorithm-and-its-variables">BM25 Alogirthm</a></p>
<h3 id="73-understanding-scoring-in-elasticsearch-queries"><strong>7.3. Understanding Scoring in Elasticsearch Queries</strong><a class="headerlink" href="#73-understanding-scoring-in-elasticsearch-queries" title="Permanent link">&para;</a></h3>
<p>In Elasticsearch, relevance scores are generated by the <strong>"match"</strong> or <strong>"multi_match"</strong> queries. Each document receives a relevance score, and results are ranked based on these scores. You can inspect scores using the <code>"explain": true</code> parameter, which details each document’s score and shows how BM25 factors contribute.</p>
<h4 id="example-query-with-relevance-scoring">Example Query with Relevance Scoring:<a class="headerlink" href="#example-query-with-relevance-scoring" title="Permanent link">&para;</a></h4>
<p><div class="language-json highlight"><pre><span></span><code><span id="__span-47-1"><a id="__codelineno-47-1" name="__codelineno-47-1" href="#__codelineno-47-1"></a><span class="p">{</span>
</span><span id="__span-47-2"><a id="__codelineno-47-2" name="__codelineno-47-2" href="#__codelineno-47-2"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-3"><a id="__codelineno-47-3" name="__codelineno-47-3" href="#__codelineno-47-3"></a><span class="w">    </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-4"><a id="__codelineno-47-4" name="__codelineno-47-4" href="#__codelineno-47-4"></a><span class="w">      </span><span class="nt">&quot;content&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-47-5"><a id="__codelineno-47-5" name="__codelineno-47-5" href="#__codelineno-47-5"></a><span class="w">        </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;Elasticsearch relevance scoring&quot;</span><span class="p">,</span>
</span><span id="__span-47-6"><a id="__codelineno-47-6" name="__codelineno-47-6" href="#__codelineno-47-6"></a><span class="w">        </span><span class="nt">&quot;boost&quot;</span><span class="p">:</span><span class="w"> </span><span class="mf">1.5</span>
</span><span id="__span-47-7"><a id="__codelineno-47-7" name="__codelineno-47-7" href="#__codelineno-47-7"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-47-8"><a id="__codelineno-47-8" name="__codelineno-47-8" href="#__codelineno-47-8"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-47-9"><a id="__codelineno-47-9" name="__codelineno-47-9" href="#__codelineno-47-9"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-47-10"><a id="__codelineno-47-10" name="__codelineno-47-10" href="#__codelineno-47-10"></a><span class="w">  </span><span class="nt">&quot;explain&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span>
</span><span id="__span-47-11"><a id="__codelineno-47-11" name="__codelineno-47-11" href="#__codelineno-47-11"></a><span class="p">}</span>
</span></code></pre></div>
This query searches for "Elasticsearch relevance scoring" in the <code>content</code> field. The <code>"boost"</code> parameter can emphasize this field for relevance, while <code>"explain": true</code> helps analyze the scoring breakdown.</p>
<h3 id="74-improving-relevance-with-advanced-techniques"><strong>7.4. Improving Relevance with Advanced Techniques</strong><a class="headerlink" href="#74-improving-relevance-with-advanced-techniques" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Field Boosting</strong>: Increase relevance by weighting certain fields more heavily.</li>
<li><strong>Function Scoring</strong>: Custom scoring functions let you adjust scores based on field values, geographic distance, or date recency.</li>
<li><strong>Multi-Match Queries</strong>: Use multiple fields in a single query, like title and content, to balance relevance from multiple sources.</li>
</ul>
<h3 id="75-practical-use-cases-for-bm25-in-elasticsearch"><strong>7.5. Practical Use Cases for BM25 in Elasticsearch</strong><a class="headerlink" href="#75-practical-use-cases-for-bm25-in-elasticsearch" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>E-commerce</strong>: Boost product names over descriptions to prioritize document structure.</li>
<li><strong>Content Recommendation</strong>: Add boosts to recent articles or content based on reader engagement.</li>
</ul>
<h3 id="summary-of-relevance-score">Summary of Relevance Score<a class="headerlink" href="#summary-of-relevance-score" title="Permanent link">&para;</a></h3>
<p>Relevance scoring with BM25 is foundational to Elasticsearch’s search quality, offering powerful controls for tuning results to your specific needs. </p>
<hr />
<h3 id="8-pagination-and-cursors">8. Pagination and Cursors<a class="headerlink" href="#8-pagination-and-cursors" title="Permanent link">&para;</a></h3>
<hr />
<p>Pagination in Elasticsearch is essential for handling large result sets efficiently, as it prevents overwhelming the client and server. Elasticsearch offers different methods for pagination, each with specific use cases. Let's break down each method:</p>
<hr />
<h3 id="81-basic-pagination-with-from-and-size">8.1. <strong>Basic Pagination with <code>from</code> and <code>size</code></strong><a class="headerlink" href="#81-basic-pagination-with-from-and-size" title="Permanent link">&para;</a></h3>
<ul>
<li>The <code>from</code> parameter skips a set number of results, while <code>size</code> controls the number of results returned.</li>
<li><strong>Use Case</strong>: Simple pagination for small datasets.</li>
<li><strong>Limitations</strong>: Inefficient for large datasets because performance drops as <code>from</code> increases (since Elasticsearch has to load and sort through all documents before the specified offset).</li>
</ul>
<p><strong>Example</strong>:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-48-1"><a id="__codelineno-48-1" name="__codelineno-48-1" href="#__codelineno-48-1"></a><span class="p">{</span>
</span><span id="__span-48-2"><a id="__codelineno-48-2" name="__codelineno-48-2" href="#__codelineno-48-2"></a><span class="w">  </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">20</span><span class="p">,</span>
</span><span id="__span-48-3"><a id="__codelineno-48-3" name="__codelineno-48-3" href="#__codelineno-48-3"></a><span class="w">  </span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
</span><span id="__span-48-4"><a id="__codelineno-48-4" name="__codelineno-48-4" href="#__codelineno-48-4"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-48-5"><a id="__codelineno-48-5" name="__codelineno-48-5" href="#__codelineno-48-5"></a><span class="p">}</span>
</span></code></pre></div>
   This retrieves results from the 21<sup>st</sup> to the 30<sup>th</sup> position.</p>
<h3 id="82-search-after-for-deep-pagination">8.2. <strong>Search After for Deep Pagination</strong><a class="headerlink" href="#82-search-after-for-deep-pagination" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Overcomes the limitations of <code>from</code> and <code>size</code> by using a <strong>cursor</strong>.</li>
<li>Uses the <code>search_after</code> parameter to specify a unique field value (like a timestamp or an ID) from the last document of the previous page.</li>
<li><strong>Use Case</strong>: Suitable for deep pagination (e.g., pages far into the dataset).</li>
<li><strong>Limitations</strong>: Requires sorted queries; can’t jump directly to a page.</li>
</ul>
<p><strong>Example</strong>:
   <div class="language-json highlight"><pre><span></span><code><span id="__span-49-1"><a id="__codelineno-49-1" name="__codelineno-49-1" href="#__codelineno-49-1"></a><span class="p">{</span>
</span><span id="__span-49-2"><a id="__codelineno-49-2" name="__codelineno-49-2" href="#__codelineno-49-2"></a><span class="w">  </span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asc&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asc&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span>
</span><span id="__span-49-3"><a id="__codelineno-49-3" name="__codelineno-49-3" href="#__codelineno-49-3"></a><span class="w">  </span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
</span><span id="__span-49-4"><a id="__codelineno-49-4" name="__codelineno-49-4" href="#__codelineno-49-4"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-49-5"><a id="__codelineno-49-5" name="__codelineno-49-5" href="#__codelineno-49-5"></a><span class="w">  </span><span class="nt">&quot;search_after&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1627489200</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;XYZ123&quot;</span><span class="p">]</span><span class="w"> </span>
</span><span id="__span-49-6"><a id="__codelineno-49-6" name="__codelineno-49-6" href="#__codelineno-49-6"></a><span class="p">}</span>
</span></code></pre></div>
   Here, <code>search_after</code> takes the values from the <code>timestamp</code> and <code>id</code> fields of the last document on the previous page, ensuring seamless navigation.</p>
<h3 id="83-scroll-api-for-bulk-data-retrieval">8.3. <strong>Scroll API for Bulk Data Retrieval</strong><a class="headerlink" href="#83-scroll-api-for-bulk-data-retrieval" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Efficiently handles large datasets by creating a consistent snapshot of the index to avoid changes affecting results.</li>
<li><strong>Use Case</strong>: Primarily used for exporting or processing the entire dataset rather than interactive pagination.</li>
<li><strong>Limitations</strong>: Not ideal for real-time paginated views; holds large segments in memory, which can strain resources.</li>
</ul>
<p><strong>Example Workflow</strong>:
   - First, initiate a scroll session:
     <div class="language-json highlight"><pre><span></span><code><span id="__span-50-1"><a id="__codelineno-50-1" name="__codelineno-50-1" href="#__codelineno-50-1"></a><span class="p">{</span>
</span><span id="__span-50-2"><a id="__codelineno-50-2" name="__codelineno-50-2" href="#__codelineno-50-2"></a><span class="w">  </span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span><span class="p">,</span>
</span><span id="__span-50-3"><a id="__codelineno-50-3" name="__codelineno-50-3" href="#__codelineno-50-3"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-50-4"><a id="__codelineno-50-4" name="__codelineno-50-4" href="#__codelineno-50-4"></a><span class="w">  </span><span class="nt">&quot;scroll&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1m&quot;</span><span class="w"> </span>
</span><span id="__span-50-5"><a id="__codelineno-50-5" name="__codelineno-50-5" href="#__codelineno-50-5"></a><span class="p">}</span>
</span></code></pre></div>
   - Use the <code>_scroll_id</code> returned by the initial request to retrieve subsequent pages:
     <div class="language-json highlight"><pre><span></span><code><span id="__span-51-1"><a id="__codelineno-51-1" name="__codelineno-51-1" href="#__codelineno-51-1"></a><span class="p">{</span>
</span><span id="__span-51-2"><a id="__codelineno-51-2" name="__codelineno-51-2" href="#__codelineno-51-2"></a><span class="w">  </span><span class="nt">&quot;scroll&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1m&quot;</span><span class="p">,</span>
</span><span id="__span-51-3"><a id="__codelineno-51-3" name="__codelineno-51-3" href="#__codelineno-51-3"></a><span class="w">  </span><span class="nt">&quot;scroll_id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;DXF1ZXJ5QW5kRmV0Y2gBAAAAAAAA...&quot;</span>
</span><span id="__span-51-4"><a id="__codelineno-51-4" name="__codelineno-51-4" href="#__codelineno-51-4"></a><span class="p">}</span>
</span></code></pre></div></p>
<p>After each scroll request, repeat until the returned results are empty, which indicates that all documents have been retrieved.</p>
<h3 id="84-point-in-time-pit-for-real-time-pagination-with-consistency">8.4. <strong>Point-in-Time (PIT) for Real-time Pagination with Consistency</strong><a class="headerlink" href="#84-point-in-time-pit-for-real-time-pagination-with-consistency" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Offers a consistent snapshot of the index at a specific point, ensuring paginated results don’t change between requests.</li>
<li><strong>Use Case</strong>: Good for real-time applications where data changes frequently but consistent pagination is necessary.</li>
<li><strong>Limitations</strong>: PIT sessions should be short-lived to avoid excessive resource use.</li>
</ul>
<p><strong>Example Workflow</strong>:
   - First, initiate a Point-in-Time session:
     <div class="language-json highlight"><pre><span></span><code><span id="__span-52-1"><a id="__codelineno-52-1" name="__codelineno-52-1" href="#__codelineno-52-1"></a><span class="err">POST</span><span class="w"> </span><span class="err">/i</span><span class="kc">n</span><span class="err">dex_</span><span class="kc">na</span><span class="err">me/_pi</span><span class="kc">t</span><span class="err">?keep_alive=</span><span class="mi">1</span><span class="err">m</span>
</span></code></pre></div>
   - Use the <code>pit_id</code> with <code>search_after</code> for paginated queries:
     <div class="language-json highlight"><pre><span></span><code><span id="__span-53-1"><a id="__codelineno-53-1" name="__codelineno-53-1" href="#__codelineno-53-1"></a><span class="p">{</span>
</span><span id="__span-53-2"><a id="__codelineno-53-2" name="__codelineno-53-2" href="#__codelineno-53-2"></a><span class="w">  </span><span class="nt">&quot;size&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">10</span><span class="p">,</span>
</span><span id="__span-53-3"><a id="__codelineno-53-3" name="__codelineno-53-3" href="#__codelineno-53-3"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;match_all&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-53-4"><a id="__codelineno-53-4" name="__codelineno-53-4" href="#__codelineno-53-4"></a><span class="w">  </span><span class="nt">&quot;pit&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;PIT_ID&quot;</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;keep_alive&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;1m&quot;</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-53-5"><a id="__codelineno-53-5" name="__codelineno-53-5" href="#__codelineno-53-5"></a><span class="w">  </span><span class="nt">&quot;sort&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;timestamp&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asc&quot;</span><span class="w"> </span><span class="p">},</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;id&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;asc&quot;</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">],</span>
</span><span id="__span-53-6"><a id="__codelineno-53-6" name="__codelineno-53-6" href="#__codelineno-53-6"></a><span class="w">  </span><span class="nt">&quot;search_after&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span><span class="mi">1627489200</span><span class="p">,</span><span class="w"> </span><span class="s2">&quot;XYZ123&quot;</span><span class="p">]</span>
</span><span id="__span-53-7"><a id="__codelineno-53-7" name="__codelineno-53-7" href="#__codelineno-53-7"></a><span class="p">}</span>
</span></code></pre></div>
   - Close the PIT session when done:
     <div class="language-json highlight"><pre><span></span><code><span id="__span-54-1"><a id="__codelineno-54-1" name="__codelineno-54-1" href="#__codelineno-54-1"></a><span class="err">DELETE</span><span class="w"> </span><span class="err">/_pi</span><span class="kc">t</span>
</span></code></pre></div></p>
<h3 id="85-limitations-and-considerations">8.5. <strong>Limitations and Considerations</strong><a class="headerlink" href="#85-limitations-and-considerations" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Deep Pagination</strong>: As the dataset grows, deep pagination can become costly due to increased memory usage. Use <code>search_after</code> or PIT for deeper, efficient pagination.</li>
<li><strong>Real-time Constraints</strong>: The Scroll API locks data for consistency, so it’s unsuitable for real-time applications. In contrast, <code>search_after</code> and PIT handle real-time updates better.</li>
<li><strong>Sort Requirements</strong>: Both <code>search_after</code> and PIT require sorted fields to maintain proper order across paginated results.</li>
</ul>
<h3 id="86-summary-table-of-pagination-techniques">8.6. Summary Table of Pagination Techniques<a class="headerlink" href="#86-summary-table-of-pagination-techniques" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th>Method</th>
<th>Use Case</th>
<th>Limitations</th>
<th>Example Scenarios</th>
</tr>
</thead>
<tbody>
<tr>
<td><code>from</code> &amp; <code>size</code></td>
<td>Simple pagination for small datasets</td>
<td>Performance drop for large <code>from</code> values</td>
<td>Basic search pages, small datasets</td>
</tr>
<tr>
<td><code>search_after</code></td>
<td>Deep pagination without <code>from</code> overhead</td>
<td>Requires sorted fields, can’t skip pages</td>
<td>Infinite scrolling, data tables with lots of records</td>
</tr>
<tr>
<td>Scroll API</td>
<td>Bulk data export/processing</td>
<td>High memory usage, no real-time consistency</td>
<td>Data migration, report generation</td>
</tr>
<tr>
<td>Point-in-Time</td>
<td>Consistent real-time pagination</td>
<td>Needs frequent re-creation to avoid memory issues</td>
<td>Dashboards, applications requiring consistent views</td>
</tr>
</tbody>
</table>
<p>Each method serves specific needs, balancing consistency, performance, and real-time capabilities. This setup allows Elasticsearch to handle vast and dynamic datasets while supporting efficient data retrieval.</p>
<hr />
<h3 id="9-facets-and-filters">9. Facets and Filters<a class="headerlink" href="#9-facets-and-filters" title="Permanent link">&para;</a></h3>
<hr />
<p>Faceting creates summaries of data, useful for search result filtering, like categorizing search results by price or brand. Filters, on the other hand, optimize performance by narrowing down documents without affecting scoring.</p>
<h3 id="91-facets-aggregations">9.1. <strong>Facets</strong> (Aggregations)<a class="headerlink" href="#91-facets-aggregations" title="Permanent link">&para;</a></h3>
<p>Faceting is a process in Elasticsearch that aggregates search results, providing structured summaries for complex queries. For example, if searching for "laptops," facets can aggregate results by price range, brand, or processor type, allowing users to filter search results dynamically.</p>
<ul>
<li><strong>Bucket Aggregations</strong>: Group documents by certain criteria, creating “buckets” for each unique value. Common bucket types include:<ul>
<li><strong>Terms Aggregation</strong>: Summarizes by unique field values (e.g., brand names).</li>
<li><strong>Range Aggregation</strong>: Creates buckets for numerical ranges (e.g., price ranges).</li>
<li><strong>Date Histogram</strong>: Buckets documents by date intervals, great for tracking trends over time.</li>
</ul>
</li>
<li><strong>Metric Aggregations</strong>: Calculate statistical metrics like count, sum, average, min, and max on fields within buckets, useful for summaries.</li>
<li><strong>Multi-Level Aggregations</strong>: Nested aggregations allow more complex analyses, like a "price by brand by location" breakdown, giving a deeper multi-dimensional view of data.</li>
</ul>
<h3 id="92-filters-filtering-without-scoring-impact">9.2. <strong>Filters</strong>: Filtering without Scoring Impact<a class="headerlink" href="#92-filters-filtering-without-scoring-impact" title="Permanent link">&para;</a></h3>
<p>Filters enable the narrowing of search results by criteria (e.g., price &lt; $500), improving query efficiency and bypassing relevance scoring. They’re often used to pre-process data before a full-text search and work well with caches, resulting in faster query performance.</p>
<ul>
<li><strong>Filtered Query</strong>: Using the <code>bool</code> query, filters can be applied to queries under <code>must</code> or <code>filter</code> clauses. Filters in <code>filter</code> clauses are cached and reusable, significantly boosting speed for repetitive filters (e.g., "available items only").</li>
<li><strong>Filter Types</strong>:<ul>
<li><strong>Term Filter</strong>: Exact match filtering for structured data, efficient for keywords or IDs.</li>
<li><strong>Range Filter</strong>: Sets criteria for numeric or date fields.</li>
<li><strong>Geo Filters</strong>: Filter based on geolocation, such as finding items within a radius.</li>
</ul>
</li>
</ul>
<h3 id="93-combining-facets-and-filters-in-search-applications">9.3. <strong>Combining Facets and Filters in Search Applications</strong><a class="headerlink" href="#93-combining-facets-and-filters-in-search-applications" title="Permanent link">&para;</a></h3>
<p>In complex search interfaces, facets allow users to drill down through categories, while filters further refine their selections without recalculating scores, ensuring responsive user experiences.</p>
<h3 id="94-sample-implementations">9.4. <strong>Sample Implementations</strong><a class="headerlink" href="#94-sample-implementations" title="Permanent link">&para;</a></h3>
<h4 id="941-creating-facets-aggregations">9.4.1. <strong>Creating Facets (Aggregations)</strong><a class="headerlink" href="#941-creating-facets-aggregations" title="Permanent link">&para;</a></h4>
<p>To implement facets, you’ll define bucket aggregations to group and categorize data. For instance, creating a facet for "price range" and "brand" in a search for laptops:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-55-1"><a id="__codelineno-55-1" name="__codelineno-55-1" href="#__codelineno-55-1"></a><span class="err">GET</span><span class="w"> </span><span class="err">/produc</span><span class="kc">ts</span><span class="err">/_search</span>
</span><span id="__span-55-2"><a id="__codelineno-55-2" name="__codelineno-55-2" href="#__codelineno-55-2"></a><span class="p">{</span>
</span><span id="__span-55-3"><a id="__codelineno-55-3" name="__codelineno-55-3" href="#__codelineno-55-3"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-4"><a id="__codelineno-55-4" name="__codelineno-55-4" href="#__codelineno-55-4"></a><span class="w">    </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;laptop&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-55-5"><a id="__codelineno-55-5" name="__codelineno-55-5" href="#__codelineno-55-5"></a><span class="w">  </span><span class="p">},</span>
</span><span id="__span-55-6"><a id="__codelineno-55-6" name="__codelineno-55-6" href="#__codelineno-55-6"></a><span class="w">  </span><span class="nt">&quot;aggs&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-7"><a id="__codelineno-55-7" name="__codelineno-55-7" href="#__codelineno-55-7"></a><span class="w">    </span><span class="nt">&quot;price_ranges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-8"><a id="__codelineno-55-8" name="__codelineno-55-8" href="#__codelineno-55-8"></a><span class="w">      </span><span class="nt">&quot;range&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-9"><a id="__codelineno-55-9" name="__codelineno-55-9" href="#__codelineno-55-9"></a><span class="w">        </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;price&quot;</span><span class="p">,</span>
</span><span id="__span-55-10"><a id="__codelineno-55-10" name="__codelineno-55-10" href="#__codelineno-55-10"></a><span class="w">        </span><span class="nt">&quot;ranges&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-55-11"><a id="__codelineno-55-11" name="__codelineno-55-11" href="#__codelineno-55-11"></a><span class="w">          </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;to&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-55-12"><a id="__codelineno-55-12" name="__codelineno-55-12" href="#__codelineno-55-12"></a><span class="w">          </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">500</span><span class="p">,</span><span class="w"> </span><span class="nt">&quot;to&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-55-13"><a id="__codelineno-55-13" name="__codelineno-55-13" href="#__codelineno-55-13"></a><span class="w">          </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;from&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-55-14"><a id="__codelineno-55-14" name="__codelineno-55-14" href="#__codelineno-55-14"></a><span class="w">        </span><span class="p">]</span>
</span><span id="__span-55-15"><a id="__codelineno-55-15" name="__codelineno-55-15" href="#__codelineno-55-15"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-55-16"><a id="__codelineno-55-16" name="__codelineno-55-16" href="#__codelineno-55-16"></a><span class="w">    </span><span class="p">},</span>
</span><span id="__span-55-17"><a id="__codelineno-55-17" name="__codelineno-55-17" href="#__codelineno-55-17"></a><span class="w">    </span><span class="nt">&quot;brands&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-55-18"><a id="__codelineno-55-18" name="__codelineno-55-18" href="#__codelineno-55-18"></a><span class="w">      </span><span class="nt">&quot;terms&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;field&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;brand.keyword&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-55-19"><a id="__codelineno-55-19" name="__codelineno-55-19" href="#__codelineno-55-19"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-55-20"><a id="__codelineno-55-20" name="__codelineno-55-20" href="#__codelineno-55-20"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-55-21"><a id="__codelineno-55-21" name="__codelineno-55-21" href="#__codelineno-55-21"></a><span class="p">}</span>
</span></code></pre></div>
<p>This example provides a breakdown of price ranges and a count of each brand, creating flexible filters users can click on to refine results.</p>
<h4 id="942-using-filters-for-optimized-performance">9.4.2. <strong>Using Filters for Optimized Performance</strong><a class="headerlink" href="#942-using-filters-for-optimized-performance" title="Permanent link">&para;</a></h4>
<p>Filters improve performance by narrowing results without scoring. Here’s an example of using a <code>bool</code> query with a <code>filter</code> clause:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-56-1"><a id="__codelineno-56-1" name="__codelineno-56-1" href="#__codelineno-56-1"></a><span class="err">GET</span><span class="w"> </span><span class="err">/produc</span><span class="kc">ts</span><span class="err">/_search</span>
</span><span id="__span-56-2"><a id="__codelineno-56-2" name="__codelineno-56-2" href="#__codelineno-56-2"></a><span class="p">{</span>
</span><span id="__span-56-3"><a id="__codelineno-56-3" name="__codelineno-56-3" href="#__codelineno-56-3"></a><span class="w">  </span><span class="nt">&quot;query&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-4"><a id="__codelineno-56-4" name="__codelineno-56-4" href="#__codelineno-56-4"></a><span class="w">    </span><span class="nt">&quot;bool&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-5"><a id="__codelineno-56-5" name="__codelineno-56-5" href="#__codelineno-56-5"></a><span class="w">      </span><span class="nt">&quot;must&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-56-6"><a id="__codelineno-56-6" name="__codelineno-56-6" href="#__codelineno-56-6"></a><span class="w">        </span><span class="nt">&quot;match&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;description&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;laptop&quot;</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-56-7"><a id="__codelineno-56-7" name="__codelineno-56-7" href="#__codelineno-56-7"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-56-8"><a id="__codelineno-56-8" name="__codelineno-56-8" href="#__codelineno-56-8"></a><span class="w">      </span><span class="nt">&quot;filter&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">[</span>
</span><span id="__span-56-9"><a id="__codelineno-56-9" name="__codelineno-56-9" href="#__codelineno-56-9"></a><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;term&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;in_stock&quot;</span><span class="p">:</span><span class="w"> </span><span class="kc">true</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">},</span>
</span><span id="__span-56-10"><a id="__codelineno-56-10" name="__codelineno-56-10" href="#__codelineno-56-10"></a><span class="w">        </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;range&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;price&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span><span class="w"> </span><span class="nt">&quot;lt&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1000</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span><span class="w"> </span><span class="p">}</span>
</span><span id="__span-56-11"><a id="__codelineno-56-11" name="__codelineno-56-11" href="#__codelineno-56-11"></a><span class="w">      </span><span class="p">]</span>
</span><span id="__span-56-12"><a id="__codelineno-56-12" name="__codelineno-56-12" href="#__codelineno-56-12"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-56-13"><a id="__codelineno-56-13" name="__codelineno-56-13" href="#__codelineno-56-13"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-56-14"><a id="__codelineno-56-14" name="__codelineno-56-14" href="#__codelineno-56-14"></a><span class="p">}</span>
</span></code></pre></div>
<p>In this query, <code>in_stock</code> and <code>price</code> filters optimize search results without affecting scoring.</p>
<h3 id="95-performance-optimization-techniques">9.5. <strong>Performance Optimization Techniques</strong><a class="headerlink" href="#95-performance-optimization-techniques" title="Permanent link">&para;</a></h3>
<h4 id="951-caching-filters">9.5.1. <strong>Caching Filters</strong><a class="headerlink" href="#951-caching-filters" title="Permanent link">&para;</a></h4>
<ul>
<li>Filters are often cached by Elasticsearch, particularly if used frequently. Filtering with terms (exact matches) or numeric ranges benefits from caching, as it bypasses repeated computation and improves query speed.</li>
</ul>
<h4 id="952-minimize-full-text-search-in-filters">9.5.2. <strong>Minimize Full-Text Search in Filters</strong><a class="headerlink" href="#952-minimize-full-text-search-in-filters" title="Permanent link">&para;</a></h4>
<ul>
<li>Full-text queries like <code>match</code> should only appear in scoring-related queries (e.g., <code>must</code>). Using <code>term</code> or <code>range</code> filters for precise values (like IDs, prices) reduces computational load.</li>
</ul>
<h4 id="953-selective-use-of-aggregations">9.5.3. <strong>Selective Use of Aggregations</strong><a class="headerlink" href="#953-selective-use-of-aggregations" title="Permanent link">&para;</a></h4>
<ul>
<li>Aggregations, especially nested ones, can be heavy on resources. Avoid overusing multi-level facets and restrict them to essential fields. For high-cardinality fields (e.g., many unique values), consider filtering or limiting the number of results.</li>
</ul>
<h4 id="954-balancing-shard-count">9.5.4. <strong>Balancing Shard Count</strong><a class="headerlink" href="#954-balancing-shard-count" title="Permanent link">&para;</a></h4>
<ul>
<li>Elasticsearch distributes filters and aggregations across shards. While more shards can speed up complex aggregations, too many shards may lead to overhead. Test performance based on index size and query type to determine optimal shard counts.</li>
</ul>
<hr />
<h2 id="cluster-architecture">Cluster Architecture<a class="headerlink" href="#cluster-architecture" title="Permanent link">&para;</a></h2>
<h3 id="1-cluster-overview-and-node-responsibilities">1. Cluster Overview and Node Responsibilities<a class="headerlink" href="#1-cluster-overview-and-node-responsibilities" title="Permanent link">&para;</a></h3>
<hr />
<p>Each node type in an Elasticsearch cluster has specialized roles that allow it to handle different aspects of indexing, searching, and managing data. Let's explore the node types in detail.</p>
<h4 id="11-master-node"><strong>1.1. Master Node</strong><a class="headerlink" href="#11-master-node" title="Permanent link">&para;</a></h4>
<p>The master node is the cluster’s brain, responsible for the overall management and health of the cluster.</p>
<ul>
<li><strong>Responsibilities</strong>:</li>
<li><strong>Cluster State Management</strong>: Tracks all nodes, indices, and shard locations, ensuring the cluster state is updated consistently.</li>
<li><strong>Index and Shard Management</strong>: Responsible for creating and deleting indices and for allocating and rebalancing shards. When new nodes are added or removed, the master node redistributes shards to maintain balance and high availability.</li>
<li><strong>Settings</strong>: Manages cluster-wide settings like shard allocation and replica counts.</li>
<li>
<p><strong>Health Checks</strong>: Constantly checks the health of nodes, removing unresponsive nodes to maintain a stable cluster state.</p>
</li>
<li>
<p><strong>Consensus and Election Process</strong>:</p>
</li>
<li>Elasticsearch uses the <strong>Zen Discovery</strong> module to elect a master node in case the active master node goes down.</li>
<li><strong>Master-eligible nodes</strong> participate in elections, where the first node to form a majority connection with other nodes becomes the new master.</li>
<li><strong>Fault Tolerance</strong>: Having multiple master-eligible nodes increases fault tolerance but only one node actively acts as the master.</li>
</ul>
<h4 id="12-data-node"><strong>1.2. Data Node</strong><a class="headerlink" href="#12-data-node" title="Permanent link">&para;</a></h4>
<p>Data nodes are the primary nodes for <strong>storing data, processing indexing operations, and executing search and aggregation requests</strong>.</p>
<ul>
<li><strong>Responsibilities</strong>:</li>
<li><strong>Storage</strong>: Holds the actual data and handles shards (both primary and replicas).</li>
<li><strong>Indexing and Searching</strong>: Executes indexing requests to store new data and processes queries on local data.</li>
<li><strong>Shard Management</strong>: Each data node hosts a subset of the cluster’s primary and replica shards, handling local searches and aggregations to ensure efficient processing.</li>
<li><strong>Scalability and Fault Tolerance</strong>: Data nodes scale horizontally, meaning adding more data nodes increases storage and processing capacity, and replication ensures fault tolerance.</li>
</ul>
<h4 id="13-coordinating-node"><strong>1.3. Coordinating Node</strong><a class="headerlink" href="#13-coordinating-node" title="Permanent link">&para;</a></h4>
<p>Also known as the <strong>client node</strong>, the coordinating node acts as a <strong>router</strong> for client requests, managing query distribution and response aggregation.</p>
<ul>
<li><strong>Responsibilities</strong>:</li>
<li><strong>Routing</strong>: Breaks down client requests (both indexing and search requests) and forwards them to the relevant data nodes.</li>
<li><strong>Response Aggregation</strong>: Gathers responses from data nodes and consolidates results to produce a final response to the client.</li>
<li><strong>Load Distribution</strong>: Since coordinating nodes don’t store data or shards, they focus on reducing load on data nodes, especially in large clusters.</li>
</ul>
<h4 id="14-ingest-node"><strong>1.4. Ingest Node</strong><a class="headerlink" href="#14-ingest-node" title="Permanent link">&para;</a></h4>
<p>Ingest nodes preprocess data before it is indexed, often using <strong>ingest pipelines</strong> to transform and enrich data.</p>
<ul>
<li><strong>Responsibilities</strong>:</li>
<li><strong>Data Transformation</strong>: Uses ingest pipelines to manipulate data (e.g., parsing logs, enriching data fields, removing sensitive information).</li>
<li><strong>Efficient Preprocessing</strong>: By processing data before indexing, ingest nodes reduce the need for expensive data transformations during searches.</li>
</ul>
<hr />
<h3 id="2-cluster-hierarchy-overview">2. <strong>Cluster Hierarchy Overview</strong><a class="headerlink" href="#2-cluster-hierarchy-overview" title="Permanent link">&para;</a></h3>
<hr />
<p>Each level in the cluster architecture plays a role in organizing and distributing data efficiently across nodes.</p>
<h4 id="21-cluster"><strong>2.1. Cluster</strong><a class="headerlink" href="#21-cluster" title="Permanent link">&para;</a></h4>
<ul>
<li>The cluster is the top-level structure that <strong>contains multiple nodes</strong>, managing data storage and search operations as a unified system.</li>
<li><strong>Shard Allocation</strong>: The master node manages shard distribution across data nodes, balancing load and ensuring fault tolerance by replicating shards across nodes.</li>
<li><strong>Redundancy and Fault Tolerance</strong>: Replica shards provide redundancy, so if a data node goes down, the cluster remains available by rerouting requests to replica shards.</li>
</ul>
<h4 id="22-index"><strong>2.2. Index</strong><a class="headerlink" href="#22-index" title="Permanent link">&para;</a></h4>
<ul>
<li>An index in Elasticsearch is similar to a <strong>database table</strong> and is the logical grouping of documents that share the same structure.</li>
<li><strong>Sharding</strong>: Each index is divided into <strong>shards</strong> (subsets of data) to distribute storage and query load across the cluster.</li>
<li><strong>Mappings</strong>: Defines the structure of documents in the index, specifying field types and enabling indexing configurations like analyzers.</li>
</ul>
<h4 id="23-shards"><strong>2.3. Shards</strong><a class="headerlink" href="#23-shards" title="Permanent link">&para;</a></h4>
<ul>
<li>Shards are the fundamental units of data distribution and parallelism in Elasticsearch.</li>
<li><strong>Lucene Index</strong>: Each shard is a full <strong>Lucene index</strong>, allowing it to process and store data independently.</li>
<li><strong>Primary and Replica Shards</strong>: Each index has a configurable number of <strong>primary shards</strong> (original data) and <strong>replica shards</strong> (copies for fault tolerance).</li>
<li><strong>Query Parallelism</strong>: When a search request is made, each shard executes the query in parallel, and results are merged by the coordinating node.</li>
</ul>
<h4 id="24-segments"><strong>2.4. Segments</strong><a class="headerlink" href="#24-segments" title="Permanent link">&para;</a></h4>
<ul>
<li>Shards are broken down into smaller, immutable units called <strong>segments</strong>. Lucene writes data in segments for efficient searching.</li>
<li><strong>Immutable Nature</strong>: Once written, segments are not modified. Instead, new data or updates are added to new segments, and Lucene periodically merges segments to optimize performance.</li>
<li><strong>Segment Merging</strong>: Over time, Elasticsearch merges smaller segments into larger ones to reduce the number of segments, which improves search speed and reduces disk usage.</li>
</ul>
<h4 id="25-documents"><strong>2.5. Documents</strong><a class="headerlink" href="#25-documents" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Basic Data Units</strong>: Each document is a JSON object stored in segments, representing an individual record in the index.</li>
<li><strong>Field Mappings</strong>: The document structure is defined by field mappings, which specify data types and control how each field is indexed and searched.</li>
<li><strong>Dynamic and Static Mappings</strong>: Elasticsearch supports dynamic mapping for fields that don’t have predefined mappings, although static mappings offer better control over data structure and indexing behavior.</li>
</ul>
<hr />
<h3 id="3-elasticsearch-request-flow-and-processing">3. <strong>Elasticsearch Request Flow and Processing</strong><a class="headerlink" href="#3-elasticsearch-request-flow-and-processing" title="Permanent link">&para;</a></h3>
<hr />
<p>To deeply understand how <strong>request flow and cluster operations</strong> work in Elasticsearch, let’s walk through each stage of the process in detail:</p>
<h3 id="31-receiving-a-request">3.1. <strong>Receiving a Request</strong><a class="headerlink" href="#31-receiving-a-request" title="Permanent link">&para;</a></h3>
<p>When a <strong>client</strong> sends a request to Elasticsearch, it can be either a <strong>query</strong> (search request) or an <strong>indexing</strong> (write) request. Here’s how this begins:</p>
<ul>
<li>The client connects to a <strong>coordinating node</strong> (any node can act as a coordinating node, even though it's sometimes a dedicated role).</li>
<li>The coordinating node is responsible for breaking down the request and routing it to the appropriate <strong>data nodes</strong>.</li>
</ul>
<h3 id="32-breaking-down-the-request">3.2. <strong>Breaking Down the Request</strong><a class="headerlink" href="#32-breaking-down-the-request" title="Permanent link">&para;</a></h3>
<ul>
<li>
<p><strong>Identifying Relevant Shards and Nodes</strong>:</p>
<ul>
<li>For search queries, the coordinating node first identifies the <strong>index or indices</strong> involved in the query.</li>
<li>Each index in Elasticsearch is divided into <strong>shards</strong> (logical units of data). The coordinating node identifies which shards are relevant to the query.</li>
<li>It then routes the query to the nodes hosting those shards. Each shard exists as a <strong>primary shard</strong> and one or more <strong>replica shards</strong> for redundancy.</li>
</ul>
</li>
<li>
<p><strong>Selecting Shards (Primary or Replica)</strong>:</p>
<ul>
<li>For each shard, Elasticsearch will select either the primary shard or a replica shard, distributing the query load across replicas when possible to balance the workload.</li>
</ul>
</li>
</ul>
<h3 id="33-execution-at-shard-level">3.3. <strong>Execution at Shard Level</strong><a class="headerlink" href="#33-execution-at-shard-level" title="Permanent link">&para;</a></h3>
<p>At this stage, each shard executes the request locally. This process differs slightly between a <strong>search</strong> request and an <strong>indexing</strong> request.</p>
<h4 id="331-query-execution-search-requests"><strong>3.3.1. Query Execution (Search Requests)</strong><a class="headerlink" href="#331-query-execution-search-requests" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Query Phase</strong>:</p>
<ul>
<li>In the <strong>query phase</strong>, each shard independently executes the query within its dataset.</li>
<li>It retrieves <strong>document IDs, scores, and metadata</strong> of relevant documents and returns these results to the coordinating node. During this phase, only the necessary information (not the full document contents) is returned, optimizing efficiency.</li>
</ul>
</li>
<li>
<p><strong>Fetch Phase</strong>:</p>
<ul>
<li>The coordinating node then initiates a <strong>fetch phase</strong>, retrieving the actual document data only for the top results.</li>
<li>In this phase, the coordinating node consolidates document IDs and metadata, then requests the complete documents from the relevant shards. This two-phase process reduces network traffic, as full documents are only fetched after initial ranking.</li>
</ul>
</li>
</ul>
<h4 id="332-indexing-execution-write-requests"><strong>3.3.2. Indexing Execution (Write Requests)</strong><a class="headerlink" href="#332-indexing-execution-write-requests" title="Permanent link">&para;</a></h4>
<ul>
<li>
<p><strong>Primary Shard Indexing</strong>:</p>
<ul>
<li>For indexing requests, the coordinating node forwards the request to the relevant <strong>primary shard</strong>.</li>
<li>The primary shard performs the <strong>indexing operation</strong> first, ensuring data is written correctly.</li>
</ul>
</li>
<li>
<p><strong>Replication to Replica Shards</strong>:</p>
<ul>
<li>Once the primary shard successfully indexes the document, it forwards the change to all <strong>replica shards</strong>.</li>
<li>Each replica shard indexes the document in parallel, ensuring consistency across the cluster.</li>
</ul>
</li>
</ul>
<h3 id="34-response-consolidation">3.4. <strong>Response Consolidation</strong><a class="headerlink" href="#34-response-consolidation" title="Permanent link">&para;</a></h3>
<p>After the query or indexing operation completes, the coordinating node consolidates the response:</p>
<ul>
<li>
<p><strong>Sorting and Ranking</strong>:</p>
<ul>
<li>For search queries, the coordinating node <strong>merges and ranks</strong> the results from all shards.</li>
<li>Elasticsearch calculates a <strong>relevance score</strong> for each document based on factors like term frequency and inverse document frequency (TF-IDF) and applies <strong>BM25</strong> scoring to determine document relevance.</li>
<li>The coordinating node then orders the documents according to their scores and prepares the final list of top results.</li>
</ul>
</li>
<li>
<p><strong>Returning the Response</strong>:</p>
<ul>
<li>Once consolidation and sorting are complete, the coordinating node sends the final response back to the client.</li>
</ul>
</li>
</ul>
<h3 id="35-indexing-flow-details">3.5. <strong>Indexing Flow Details</strong><a class="headerlink" href="#35-indexing-flow-details" title="Permanent link">&para;</a></h3>
<p>The indexing flow includes several key mechanisms that ensure data consistency and durability:</p>
<ul>
<li>
<p><strong>Primary-Replica Synchronization</strong>:</p>
<ul>
<li>Every document write (index, delete, or update) is processed on the <strong>primary shard</strong> first.</li>
<li>Once the primary shard successfully indexes or updates the document, it forwards the operation to all <strong>replica shards</strong>.</li>
</ul>
</li>
<li>
<p><strong>Distributed Write-Ahead Log (WAL)</strong>:</p>
<ul>
<li>To ensure durability, Elasticsearch writes every indexing operation to a <strong>write-ahead log (WAL)</strong> on both the primary and replica nodes.</li>
<li>The WAL is essentially a <strong>transaction log</strong> that records all changes before committing them to Lucene’s index structures.</li>
<li>This ensures that even if a node crashes before committing changes, the transaction log allows for <strong>recovery</strong> to a consistent state.</li>
</ul>
</li>
<li>
<p><strong>Commit Process</strong>:</p>
<ul>
<li>After a certain threshold of changes, Elasticsearch commits these changes to Lucene. This involves:</li>
<li><strong>Creating new segments</strong> in the Lucene index.</li>
<li><strong>Flushing</strong> the WAL and persisting the new segment data, making the data available for query.</li>
<li>Committed changes are persistent and survive node restarts, while uncommitted changes are only present in the WAL.</li>
</ul>
</li>
</ul>
<h3 id="36-request-flow-and-cluster-operations-summary">3.6. <strong>Request Flow and Cluster Operations Summary</strong><a class="headerlink" href="#36-request-flow-and-cluster-operations-summary" title="Permanent link">&para;</a></h3>
<p>To visualize this, here’s a simplified flow of the entire process:</p>
<ol>
<li><strong>Client Sends Request</strong> (Search or Index) → <strong>Coordinating Node Receives Request</strong></li>
<li><strong>Coordinating Node Identifies Relevant Shards</strong> (and chooses primary or replica shards)</li>
<li><strong>Execution on Shards</strong>:</li>
<li><strong>Query Phase (Search)</strong>:<ul>
<li>Query executed on selected shards.</li>
<li>Each shard returns IDs and scores of matching documents.</li>
</ul>
</li>
<li><strong>Indexing Phase (Write)</strong>:<ul>
<li>Document written to the primary shard.</li>
<li>Changes forwarded to replica shards.</li>
</ul>
</li>
<li><strong>Fetch Phase (Search)</strong>:</li>
<li>Fetches full documents for the top results.</li>
<li><strong>Consolidation and Response</strong>:</li>
<li>Coordinating node merges, ranks, and sorts results for search.</li>
<li>Coordinating node confirms write operation on all replicas for indexing.</li>
<li><strong>Final Response Sent to Client</strong></li>
</ol>
<h3 id="37-additional-considerations">3.7. <strong>Additional Considerations</strong><a class="headerlink" href="#37-additional-considerations" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Fault Tolerance and High Availability</strong>:</li>
<li><strong>Shard Replicas</strong>: Multiple replicas ensure availability even if a primary shard goes down.</li>
<li>
<p><strong>Node Failure Handling</strong>: If a node fails, Elasticsearch promotes a replica shard to primary, maintaining data consistency and availability.</p>
</li>
<li>
<p><strong>Cluster State Management</strong>:</p>
</li>
<li>The <strong>master node</strong> maintains the <strong>cluster state</strong> (e.g., index settings, shard allocation).</li>
<li>This state is communicated to all nodes, so each node is aware of the cluster’s configuration and the locations of shards.</li>
</ul>
<hr />
<h3 id="4-lucene-segments-and-index-structures">4. Lucene, Segments, and Index Structures<a class="headerlink" href="#4-lucene-segments-and-index-structures" title="Permanent link">&para;</a></h3>
<hr />
<p>To thoroughly understand Elasticsearch's storage and retrieval mechanisms, let’s go deep into <strong>Lucene's segments, inverted index, and advanced data structures</strong> like <strong>BKD trees</strong>. Lucene, at its core, powers Elasticsearch, giving it the ability to handle and query massive datasets with impressive speed and efficiency.</p>
<h3 id="41-lucene-and-segments">4.1. <strong>Lucene and Segments</strong><a class="headerlink" href="#41-lucene-and-segments" title="Permanent link">&para;</a></h3>
<h4 id="411-what-is-a-segment"><strong>4.1.1. What is a Segment?</strong><a class="headerlink" href="#411-what-is-a-segment" title="Permanent link">&para;</a></h4>
<p>A <strong>segment</strong> in Lucene is a self-contained, immutable collection of documents that forms a subset of a shard. Each segment is essentially a mini-index with its own data structures, including <strong>inverted indexes</strong>, <strong>stored fields</strong>, and <strong>other data structures</strong> to facilitate efficient searching and retrieval.</p>
<ul>
<li><strong>Immutable Nature</strong>: Once created, a segment cannot be modified. Instead, when new documents are added, they go into new segments.</li>
<li><strong>Segment Lifecycle</strong>:</li>
<li>New documents are first written to a memory buffer.</li>
<li>Periodically, Lucene flushes this buffer, creating a new segment on disk.</li>
<li>Older segments may be merged with newer ones through the <strong>segment merging</strong> process.</li>
</ul>
<h4 id="412-segment-merging"><strong>4.1.2 Segment Merging</strong><a class="headerlink" href="#412-segment-merging" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Purpose</strong>: To control the number of segments and improve query performance by reducing the overhead of searching across numerous small segments.</li>
<li><strong>Process</strong>:</li>
<li>When segments reach a certain size, Lucene automatically merges smaller segments into larger ones. This process involves re-indexing and rewriting the segments into one larger segment, discarding deleted documents along the way.</li>
<li>Merging is a balancing act: it reduces the number of segments, improving search speed, but it also incurs I/O cost.</li>
</ul>
<p><strong>Example</strong>:
  - Imagine a shard with 100 small segments. Lucene might merge them into fewer, larger segments (say, 10 segments), consolidating their data and removing any "marked as deleted" documents.</p>
<h4 id="413-advantages-of-segments"><strong>4.1.3. Advantages of Segments</strong><a class="headerlink" href="#413-advantages-of-segments" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Concurrency</strong>: Multiple segments can be queried simultaneously, allowing Elasticsearch to parallelize search operations across segments.</li>
<li><strong>Efficiency</strong>: Immutability of segments ensures that data doesn't have to be locked for reads, enhancing speed and consistency.</li>
<li><strong>Data Deletion</strong>: Since segments are immutable, deletions do not remove documents immediately; instead, they are marked for deletion. The segment merge process will then eliminate these "deleted" documents.</li>
</ul>
<h3 id="42-lucenes-inverted-index">4.2. <strong>Lucene’s Inverted Index</strong><a class="headerlink" href="#42-lucenes-inverted-index" title="Permanent link">&para;</a></h3>
<p>The <strong>inverted index</strong> is Lucene’s most fundamental data structure and is the backbone of Elasticsearch’s fast full-text search capabilities.</p>
<h4 id="421-structure-of-an-inverted-index"><strong>4.2.1. Structure of an Inverted Index</strong><a class="headerlink" href="#421-structure-of-an-inverted-index" title="Permanent link">&para;</a></h4>
<p>The inverted index allows quick lookups by mapping <strong>terms</strong> to <strong>postings lists</strong> (lists of documents containing each term).</p>
<ul>
<li><strong>Terms</strong>: Unique words or tokens extracted from the text fields of documents.</li>
<li><strong>Postings Lists</strong>: Lists that store document identifiers for each term. Each entry in a postings list links to:</li>
<li>Document ID</li>
<li>Term frequency within the document (for relevance scoring)</li>
<li>Position information (for phrase or proximity queries)</li>
</ul>
<p><strong>Example</strong>:
  - Suppose you index the text "Elasticsearch is scalable search". The inverted index might look like this:
    <div class="language-text highlight"><pre><span></span><code><span id="__span-57-1"><a id="__codelineno-57-1" name="__codelineno-57-1" href="#__codelineno-57-1"></a>Term          Documents
</span><span id="__span-57-2"><a id="__codelineno-57-2" name="__codelineno-57-2" href="#__codelineno-57-2"></a>------------------------
</span><span id="__span-57-3"><a id="__codelineno-57-3" name="__codelineno-57-3" href="#__codelineno-57-3"></a>&quot;Elasticsearch&quot; [1]
</span><span id="__span-57-4"><a id="__codelineno-57-4" name="__codelineno-57-4" href="#__codelineno-57-4"></a>&quot;is&quot;            [1, 2]
</span><span id="__span-57-5"><a id="__codelineno-57-5" name="__codelineno-57-5" href="#__codelineno-57-5"></a>&quot;scalable&quot;      [1, 3]
</span><span id="__span-57-6"><a id="__codelineno-57-6" name="__codelineno-57-6" href="#__codelineno-57-6"></a>&quot;search&quot;        [1]
</span></code></pre></div></p>
<h4 id="422-advantages-of-inverted-index"><strong>4.2.2. Advantages of Inverted Index</strong><a class="headerlink" href="#422-advantages-of-inverted-index" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Fast Term Lookup</strong>: Quick access to documents containing specific terms, making it ideal for keyword-based and full-text searches.</li>
<li><strong>Optimized Relevance Scoring</strong>: Lucene uses term frequency-inverse document frequency (TF-IDF) and the BM25 algorithm to compute relevance scores, which improve search result accuracy.</li>
</ul>
<h4 id="423-additional-optimizations-in-inverted-index"><strong>4.2.3. Additional Optimizations in Inverted Index</strong><a class="headerlink" href="#423-additional-optimizations-in-inverted-index" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Skip Lists</strong>: Lucene uses skip lists within postings lists to speed up queries, especially for large documents. Skip lists allow the query engine to "skip over" sections of the postings list, reducing unnecessary comparisons.</li>
<li><strong>Positions and Offsets</strong>: Positions allow for phrase queries (where terms must appear in sequence) and proximity queries (where terms must be within a certain distance from each other).</li>
</ul>
<h3 id="43-bkd-trees-and-doc-values">4.3. <strong>BKD Trees and Doc Values</strong><a class="headerlink" href="#43-bkd-trees-and-doc-values" title="Permanent link">&para;</a></h3>
<p>Apart from the inverted index, Lucene also uses specialized data structures to handle numeric and spatial data.</p>
<h4 id="431-bkd-trees"><strong>4.3.1. BKD Trees</strong><a class="headerlink" href="#431-bkd-trees" title="Permanent link">&para;</a></h4>
<p><strong>BKD Trees</strong> are used in Elasticsearch for indexing and querying numeric, date, and geospatial data, especially for high-cardinality fields (fields with a large number of unique values).</p>
<ul>
<li>
<h4 id="structure-of-a-bkd-tree"><strong>Structure of a BKD Tree</strong><a class="headerlink" href="#structure-of-a-bkd-tree" title="Permanent link">&para;</a></h4>
<p>BKD trees are essentially a form of a <strong>k-d tree</strong> (k-dimensional tree), optimized for indexing and searching over multiple dimensions. Each dimension can represent a distinct numeric field (e.g., latitude, longitude, or timestamp).</p>
</li>
<li>
<p><strong>Splitting Mechanism</strong>: The tree splits data points along axes at each level, grouping data into smaller ranges or "blocks." Each block holds a set of points within a defined range.</p>
</li>
<li>
<p><strong>Hierarchical Storage</strong>: At each level of the tree, the data is divided along a specific dimension, allowing efficient narrowing of the search space during queries.</p>
</li>
<li>
<h4 id="using-bkd-trees-for-queries"><strong>Using BKD Trees for Queries</strong><a class="headerlink" href="#using-bkd-trees-for-queries" title="Permanent link">&para;</a></h4>
<p>BKD trees efficiently handle:</p>
</li>
<li><strong>Range Queries</strong>: For fields like timestamps, BKD trees allow fast filtering of documents within a date range.</li>
<li><strong>Geo-Distance Queries</strong>: For <code>geo_point</code> fields, Elasticsearch calculates distances within BKD trees, efficiently handling "find near" queries.</li>
</ul>
<p><strong>Example</strong>:
  - Suppose you have a field <code>geo_point</code> representing user locations. A BKD tree indexes these coordinates, allowing Elasticsearch to quickly retrieve points within a bounding box or radius without scanning all documents.</p>
<ul>
<li>
<h4 id="advantages-of-bkd-trees"><strong>Advantages of BKD Trees</strong><a class="headerlink" href="#advantages-of-bkd-trees" title="Permanent link">&para;</a></h4>
</li>
<li><strong>Multi-dimensional Support</strong>: BKD trees can store high-dimensional points, making them versatile for multi-dimensional data like 3D spatial points or multiple numeric fields.</li>
<li><strong>Efficient Storage</strong>: Stores blocks instead of individual points, minimizing memory usage.</li>
<li><strong>Fast Range Queries</strong>: Since data is stored in a hierarchical fashion, range and bounding box queries can quickly navigate through the tree, skipping irrelevant nodes.</li>
</ul>
<h4 id="432-doc-values"><strong>4.3.2. Doc Values</strong><a class="headerlink" href="#432-doc-values" title="Permanent link">&para;</a></h4>
<p><strong>Doc values</strong> enable efficient retrieval of field values for sorting, aggregation, and faceting. Instead of retrieving data from inverted indexes (which are optimized for search), doc values provide a <strong>columnar storage</strong> format that is ideal for analytical tasks.</p>
<ul>
<li>
<h4 id="structure-of-doc-values"><strong>Structure of Doc Values</strong><a class="headerlink" href="#structure-of-doc-values" title="Permanent link">&para;</a></h4>
  Doc values store fields in <strong>column-oriented</strong> storage rather than row-oriented storage:</li>
<li><strong>Columnar Format</strong>: Each field’s values are stored together, allowing fast access to all values of a single field across multiple documents.</li>
<li>
<p><strong>On-Disk Storage</strong>: Doc values are stored on disk rather than in memory, allowing efficient memory usage and enabling large datasets to be queried without excessive RAM usage.</p>
</li>
<li>
<h4 id="types-of-doc-values"><strong>Types of Doc Values</strong><a class="headerlink" href="#types-of-doc-values" title="Permanent link">&para;</a></h4>
<p>Doc values are defined by the field type:</p>
</li>
<li><strong>Numeric Doc Values</strong>: For fields with numeric data types, enabling efficient sorting and numeric aggregation (e.g., <code>sum</code>, <code>avg</code>).</li>
<li><strong>Binary Doc Values</strong>: Used for keyword fields, allowing sorting and aggregation on text data.</li>
<li>
<p><strong>Geo-point Doc Values</strong>: Specifically for geographic points, enabling geo-distance calculations.</p>
</li>
<li>
<h4 id="using-doc-values-in-queries"><strong>Using Doc Values in Queries</strong><a class="headerlink" href="#using-doc-values-in-queries" title="Permanent link">&para;</a></h4>
<p>Doc values are essential for operations such as:</p>
</li>
<li><strong>Sorting</strong>: Sorting a results set by a field (e.g., price, timestamp) retrieves the field values directly from doc values.</li>
<li><strong>Aggregations</strong>: Aggregating data (e.g., calculating the average rating) can access all values of a field across documents, significantly speeding up aggregation operations.</li>
<li><strong>Faceting and Filtering</strong>: Fast access to field values in columnar format enables Elasticsearch to quickly generate facets and apply filters.</li>
</ul>
<p><strong>Example</strong>:
  - Sorting results by <code>price</code> in a large index of products:
    - Doc values store <code>price</code> in a single column, which Elasticsearch reads to quickly sort documents without scanning each document individually.</p>
<ul>
<li>
<h4 id="advantages-of-doc-values"><strong>Advantages of Doc Values</strong><a class="headerlink" href="#advantages-of-doc-values" title="Permanent link">&para;</a></h4>
</li>
<li>
<p><strong>Efficient Sorting and Aggregation</strong>: Since doc values are structured columnar data, they allow fast and memory-efficient operations.</p>
</li>
<li><strong>Reduced Memory Usage</strong>: Storing doc values on disk and only loading them as needed minimizes memory consumption.</li>
<li><strong>Columnar Efficiency</strong>: Doc values allow Elasticsearch to quickly access specific field values across documents, ideal for analytical queries.</li>
</ul>
<h4 id="433-summary-of-lucene-data-structures-in-elasticsearch">4.3.3. Summary of Lucene Data Structures in Elasticsearch<a class="headerlink" href="#433-summary-of-lucene-data-structures-in-elasticsearch" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Data Structure</th>
<th>Purpose</th>
<th>Use Cases</th>
<th>Benefits</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Segments</strong></td>
<td>Immutable sub-indices within a shard</td>
<td>All document storage</td>
<td>Concurrent searches, immutability</td>
</tr>
<tr>
<td><strong>Inverted Index</strong></td>
<td>Maps terms to documents</td>
<td>Full-text search</td>
<td>Fast term lookups</td>
</tr>
<tr>
<td><strong>BKD Trees</strong></td>
<td>Indexes numeric and multidimensional data</td>
<td>Geospatial, timestamp queries</td>
<td>Efficient range queries</td>
</tr>
<tr>
<td><strong>Doc Values</strong></td>
<td>Columnar storage for fields</td>
<td>Sorting, aggregations</td>
<td>Optimized memory usage</td>
</tr>
<tr>
<td><strong>Point Data Types</strong></td>
<td>Indexes geographic points (latitude-longitude)</td>
<td>Proximity, bounding box queries</td>
<td>Fast geospatial indexing</td>
</tr>
</tbody>
</table>
<h3 id="44-advanced-data-structures-in-lucene">4.4. <strong>Advanced Data Structures in Lucene</strong><a class="headerlink" href="#44-advanced-data-structures-in-lucene" title="Permanent link">&para;</a></h3>
<p>Let's dive into the <strong>point data types and spatial indexes</strong> used in Elasticsearch, especially focusing on how it handles <strong>geospatial data</strong> with <strong><code>geo_point</code> fields</strong>. We’ll look at how <strong>Quadtrees</strong> and <strong>R-trees</strong> work, their role in spatial indexing, and how they support geospatial queries such as <strong>bounding box</strong> and <strong>proximity searches</strong>.</p>
<h4 id="441-overview-of-spatial-data-in-elasticsearch">4.4.1. <strong>Overview of Spatial Data in Elasticsearch</strong><a class="headerlink" href="#441-overview-of-spatial-data-in-elasticsearch" title="Permanent link">&para;</a></h4>
<p>Elasticsearch supports geospatial data using the <strong><code>geo_point</code></strong> and <strong><code>geo_shape</code></strong> data types:
- <strong><code>geo_point</code></strong>: Stores latitude-longitude pairs for points on a map and is primarily used for proximity searches (e.g., “find locations within 10km”).
- <strong><code>geo_shape</code></strong>: Used for more complex shapes, such as polygons or multipoints, and is suitable for defining geographical areas like cities or lakes.</p>
<p>Geospatial queries include:
- <strong>Bounding Box Queries</strong>: Searches for documents within a specific rectangle defined by coordinates.
- <strong>Distance Queries</strong>: Searches for documents within a specified radius from a point.
- <strong>Polygon Queries</strong>: Searches for documents within or intersecting with a complex polygonal area.</p>
<h4 id="442-quadtrees-and-r-trees-in-spatial-indexing">4.4.2. <strong>Quadtrees and R-trees in Spatial Indexing</strong><a class="headerlink" href="#442-quadtrees-and-r-trees-in-spatial-indexing" title="Permanent link">&para;</a></h4>
<p><strong>Quadtrees</strong> and <strong>R-trees</strong> are tree-based data structures that organize spatial data by dividing the space into hierarchical grids or regions, allowing efficient geospatial query processing.</p>
<h4 id="quadtrees"><strong>Quadtrees</strong><a class="headerlink" href="#quadtrees" title="Permanent link">&para;</a></h4>
<p>Quadtrees are <strong>hierarchical, 2-dimensional spatial indexes</strong> that recursively partition space into four quadrants or nodes, making them highly suitable for spatial data like latitude and longitude pairs.</p>
<ul>
<li><strong>Structure</strong>:</li>
<li>Each node (region of space) is divided into four sub-nodes or quadrants.</li>
<li>
<p>The depth of the tree (how many times it splits) depends on data density, as each quadrant only further divides if it contains more than a specified number of points.</p>
</li>
<li>
<p><strong>How it Works</strong>:</p>
</li>
<li><strong>Indexing</strong>: Points are inserted into a quadrant based on their coordinates. If a quadrant exceeds the point threshold, it splits into four sub-quadrants, each storing a subset of the points.</li>
<li>
<p><strong>Querying</strong>: For a bounding box or radius query, the algorithm quickly eliminates entire quadrants that fall outside the search area, only scanning relevant sub-quadrants, drastically reducing search space.</p>
</li>
<li>
<p><strong>Use Cases</strong>:</p>
</li>
<li><strong>Bounding Box Queries</strong>: Quadtrees can quickly locate all points within a bounding box by navigating through relevant quadrants.</li>
<li><strong>Proximity Queries</strong>: Proximity searches are efficient since the tree can “zoom in” to specific areas, ignoring distant quadrants.</li>
</ul>
<p><strong>Example</strong>:
Imagine we have a city map with thousands of restaurants, each represented as a point (latitude, longitude).
- A quadtree organizes the map into quadrants based on restaurant density. Denser regions are divided further to create sub-quadrants.
- To find restaurants within a specific neighborhood, the quadtree quickly filters out distant quadrants, only scanning nearby ones, significantly speeding up search.</p>
<h4 id="advantages-of-quadtrees"><strong>Advantages of Quadtrees</strong><a class="headerlink" href="#advantages-of-quadtrees" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Efficiency</strong>: The hierarchical division allows for fast data retrieval.</li>
<li><strong>Scalability</strong>: Quadtrees adapt to dense data by increasing tree depth, meaning they can efficiently handle varied densities in spatial data.</li>
<li><strong>Low Overhead</strong>: Quadtrees are relatively simple to implement and optimize for 2D spaces.</li>
</ul>
<h4 id="r-trees"><strong>R-trees</strong><a class="headerlink" href="#r-trees" title="Permanent link">&para;</a></h4>
<p>R-trees are another popular spatial data structure used to index multi-dimensional data (e.g., geographic shapes) by grouping nearby objects in bounding rectangles.</p>
<ul>
<li><strong>Structure</strong>:</li>
<li>An R-tree organizes data into <strong>bounding rectangles</strong> called nodes. Each node represents a group of data points or shapes.</li>
<li>These bounding rectangles are arranged hierarchically: each parent node contains child nodes that represent sub-regions.</li>
<li>
<p>Each leaf node in an R-tree contains actual data points or bounding rectangles for objects (e.g., specific areas on a map).</p>
</li>
<li>
<p><strong>How it Works</strong>:</p>
</li>
<li><strong>Indexing</strong>: When a shape or point is added, it’s placed within a bounding rectangle in a leaf node. If the rectangle becomes too crowded, the node splits, creating new bounding rectangles for its child nodes.</li>
<li>
<p><strong>Querying</strong>: For a search (e.g., finding locations within a radius), the R-tree filters bounding rectangles that don’t intersect the search area, allowing the query to narrow down results without exhaustive scans.</p>
</li>
<li>
<p><strong>Use Cases</strong>:</p>
</li>
<li><strong>Polygon Queries</strong>: R-trees are ideal for complex shapes like polygons, as each node can hold bounding rectangles for large or complex areas.</li>
<li><strong>Intersection or Overlap Queries</strong>: R-trees can efficiently check for intersections between shapes, such as finding areas that overlap with a given region.</li>
</ul>
<p><strong>Example</strong>:
Consider a map with various regions, like parks, lakes, and neighborhoods, each represented as a polygon.
- An R-tree groups these polygons in bounding rectangles based on location. Polygons that are close to each other fall under the same rectangle.
- When searching for parks within a 5km radius, the R-tree discards rectangles outside this range, only exploring relevant areas to find matching polygons.</p>
<h4 id="advantages-of-r-trees"><strong>Advantages of R-trees</strong><a class="headerlink" href="#advantages-of-r-trees" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Supports Complex Shapes</strong>: Suitable for irregular or large polygons, making them valuable for indexing diverse geographic data.</li>
<li><strong>Efficient Spatial Queries</strong>: Ideal for intersection, containment, and nearest-neighbor queries.</li>
<li><strong>Adaptive Structure</strong>: R-trees adapt their structure based on the spatial layout of data, minimizing wasted space in the tree.</li>
</ul>
<h4 id="443-lucenes-internal-use-of-quadtrees-and-r-trees">4.4.3. <strong>Lucene's Internal Use of Quadtrees and R-trees</strong><a class="headerlink" href="#443-lucenes-internal-use-of-quadtrees-and-r-trees" title="Permanent link">&para;</a></h4>
<p>While Elasticsearch doesn’t directly expose Quadtrees and R-trees as configurations, Lucene, its underlying search library, utilizes versions of these structures to handle spatial indexing efficiently.</p>
<ul>
<li><strong>Quadtrees in Lucene</strong>:</li>
<li>Used for simple geospatial data like points, where dividing space into quadrants improves search performance.</li>
<li>
<p>Points (like those in <code>geo_point</code> fields) benefit from this structure, as it speeds up bounding box queries and basic distance queries.</p>
</li>
<li>
<p><strong>R-trees in Lucene</strong>:</p>
</li>
<li>Suited for <code>geo_shape</code> fields and other complex shapes where simple 2D point indexing isn’t enough.</li>
<li>Helps manage and query large polygons, multi-points, and other shapes with irregular boundaries.</li>
</ul>
<p>Lucene optimizes these data structures to fit within its <strong>segment-based</strong> storage, allowing them to scale across multiple indices and segments, handling both large-scale geospatial queries and basic point-based distance queries.</p>
<h4 id="444-spatial-query-processing-in-elasticsearch">4.4.4. <strong>Spatial Query Processing in Elasticsearch</strong><a class="headerlink" href="#444-spatial-query-processing-in-elasticsearch" title="Permanent link">&para;</a></h4>
<p>Using these data structures, Elasticsearch processes spatial queries as follows:</p>
<ol>
<li><strong>Bounding Box Query</strong>:</li>
<li>
<p>For a rectangular region, Elasticsearch leverages Quadtrees to restrict the search space to quadrants that intersect with the bounding box. Points or shapes within these quadrants are retrieved.</p>
</li>
<li>
<p><strong>Distance Query</strong>:</p>
</li>
<li>
<p>For a proximity search (e.g., finding locations within 5km of a point), the <strong>Geo Distance Filter</strong> calculates distances from a central point and retrieves points from quadrants or nodes that fall within this radius.</p>
</li>
<li>
<p><strong>Polygon Query</strong>:</p>
</li>
<li>For complex polygons (e.g., “find all parks within a specific neighborhood”), Elasticsearch uses an R-tree structure to store polygonal shapes in bounding rectangles, allowing fast intersection tests with other regions.</li>
</ol>
<h4 id="445-summary-table-of-spatial-data-structures-in-elasticsearch">4.4.5. <strong>Summary Table of Spatial Data Structures in Elasticsearch</strong><a class="headerlink" href="#445-summary-table-of-spatial-data-structures-in-elasticsearch" title="Permanent link">&para;</a></h4>
<table>
<thead>
<tr>
<th>Data Structure</th>
<th>Purpose</th>
<th>Use Cases</th>
<th>Key Characteristics</th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Quadtrees</strong></td>
<td>Efficient point indexing</td>
<td>Bounding box, proximity searches</td>
<td>Hierarchical grid of quadrants</td>
</tr>
<tr>
<td><strong>R-trees</strong></td>
<td>Complex shape and polygon indexing</td>
<td>Intersection, overlap queries</td>
<td>Bounding rectangles with hierarchical nodes</td>
</tr>
<tr>
<td><strong>BKD Trees</strong></td>
<td>Multi-dimensional numeric data</td>
<td>Numeric and geo-distance filters</td>
<td>Balanced k-d tree with blocks of data points</td>
</tr>
</tbody>
</table>
<h4 id="446-practical-applications-and-benefits">4.4.6. <strong>Practical Applications and Benefits</strong><a class="headerlink" href="#446-practical-applications-and-benefits" title="Permanent link">&para;</a></h4>
<p>These data structures optimize spatial queries in Elasticsearch, allowing it to handle diverse geospatial data efficiently. For example:
- <strong>Bounding Box Queries</strong> are accelerated by Quadtrees, making them ideal for finding all points in a geographic area.
- <strong>Distance Queries</strong> are optimized by both Quadtrees and BKD trees, allowing real-time retrieval of nearby points.
- <strong>Polygon Queries</strong> are handled by R-trees, which efficiently manage irregular shapes and large polygons for accurate intersection checks.</p>
<p>By integrating these structures into Lucene, Elasticsearch supports powerful geospatial capabilities across various applications, including mapping services, logistics, and location-based searches. </p>
<h3 id="45-how-lucenes-structures-fit-into-elasticsearchs-query-flow">4.5. How Lucene's Structures Fit into Elasticsearch’s Query Flow<a class="headerlink" href="#45-how-lucenes-structures-fit-into-elasticsearchs-query-flow" title="Permanent link">&para;</a></h3>
<ol>
<li><strong>Document Indexing</strong>:</li>
<li>
<p>As documents are indexed, Lucene tokenizes text fields, stores terms in the inverted index, and creates doc values for fields that require sorting or aggregation.</p>
</li>
<li>
<p><strong>Segment Creation</strong>:</p>
</li>
<li>
<p>Documents are grouped into segments, with each segment containing its own inverted index, BKD trees, and doc values.</p>
</li>
<li>
<p><strong>Query Execution</strong>:</p>
</li>
<li><strong>Term-based Queries</strong>: The inverted index quickly retrieves documents containing specific terms.</li>
<li><strong>Numeric or Geospatial Queries</strong>: BKD trees are used to retrieve documents within a certain numeric range or geographic area.</li>
<li><strong>Sorting and Aggregation</strong>: Doc values facilitate sorting by loading field values column-by-column rather than document-by-document.</li>
</ol>
<p>Lucene’s well-designed structures—segments, inverted indexes, and multidimensional BKD trees—create the foundation for Elasticsearch’s speed and scalability, enabling it to support complex queries and large datasets efficiently. </p>
<hr />
<h3 id="5-visual-representation-of-cluster-architecture-hierarchy-flow">5. <strong>Visual Representation of Cluster Architecture (Hierarchy Flow)</strong><a class="headerlink" href="#5-visual-representation-of-cluster-architecture-hierarchy-flow" title="Permanent link">&para;</a></h3>
<hr />
<div class="language-text highlight"><pre><span></span><code><span id="__span-58-1"><a id="__codelineno-58-1" name="__codelineno-58-1" href="#__codelineno-58-1"></a>Elasticsearch Cluster
</span><span id="__span-58-2"><a id="__codelineno-58-2" name="__codelineno-58-2" href="#__codelineno-58-2"></a>└── Nodes
</span><span id="__span-58-3"><a id="__codelineno-58-3" name="__codelineno-58-3" href="#__codelineno-58-3"></a>    ├── Master Node
</span><span id="__span-58-4"><a id="__codelineno-58-4" name="__codelineno-58-4" href="#__codelineno-58-4"></a>    │   ├── Manages cluster state
</span><span id="__span-58-5"><a id="__codelineno-58-5" name="__codelineno-58-5" href="#__codelineno-58-5"></a>    │   └── Handles shard allocation and rebalancing
</span><span id="__span-58-6"><a id="__codelineno-58-6" name="__codelineno-58-6" href="#__codelineno-58-6"></a>    ├── Data Node
</span><span id="__span-58-7"><a id="__codelineno-58-7" name="__codelineno-58-7" href="#__codelineno-58-7"></a>    │   ├── Stores data and handles indexing/searching
</span><span id="__span-58-8"><a id="__codelineno-58-8" name="__codelineno-58-8" href="#__codelineno-58-8"></a>    │   ├── Manages primary and replica shards
</span><span id="__span-58-9"><a id="__codelineno-58-9" name="__codelineno-58-9" href="#__codelineno-58-9"></a>    │   └── Processes local queries and aggregations
</span><span id="__span-58-10"><a id="__codelineno-58-10" name="__codelineno-58-10" href="#__codelineno-58-10"></a>    ├── Coordinating Node
</span><span id="__span-58-11"><a id="__codelineno-58-11" name="__codelineno-58-11" href="#__codelineno-58-11"></a>    │   ├── Routes client requests to data nodes
</span><span id="__span-58-12"><a id="__codelineno-58-12" name="__codelineno-58-12" href="#__codelineno-58-12"></a>    │   ├── Aggregates responses from data nodes
</span><span id="__span-58-13"><a id="__codelineno-58-13" name="__codelineno-58-13" href="#__codelineno-58-13"></a>    │   └── Sends final response to the client
</span><span id="__span-58-14"><a id="__codelineno-58-14" name="__codelineno-58-14" href="#__codelineno-58-14"></a>    └── Ingest Node
</span><span id="__span-58-15"><a id="__codelineno-58-15" name="__codelineno-58-15" href="#__codelineno-58-15"></a>        ├── Processes and transforms data before indexing
</span><span id="__span-58-16"><a id="__codelineno-58-16" name="__codelineno-58-16" href="#__codelineno-58-16"></a>        └── Enriches data with pipelines
</span><span id="__span-58-17"><a id="__codelineno-58-17" name="__codelineno-58-17" href="#__codelineno-58-17"></a>
</span><span id="__span-58-18"><a id="__codelineno-58-18" name="__codelineno-58-18" href="#__codelineno-58-18"></a>Index
</span><span id="__span-58-19"><a id="__codelineno-58-19" name="__codelineno-58-19" href="#__codelineno-58-19"></a>└── Shards (Primary and Replica)
</span><span id="__span-58-20"><a id="__codelineno-58-20" name="__codelineno-58-20" href="#__codelineno-58-20"></a>    └── Lucene Index (Each shard is a Lucene index)
</span><span id="__span-58-21"><a id="__codelineno-58-21" name="__codelineno-58-21" href="#__codelineno-58-21"></a>        ├── Segments (Immutable data units in a shard)
</span><span id="__span-58-22"><a id="__codelineno-58-22" name="__codelineno-58-22" href="#__codelineno-58-22"></a>        │    ├── Inverted Index
</span><span id="__span-58-23"><a id="__codelineno-58-23" name="__codelineno-58-23" href="#__codelineno-58-23"></a>        │    ├── Doc Values
</span><span id="__span-58-24"><a id="__codelineno-58-24" name="__codelineno-58-24" href="#__codelineno-58-24"></a>        │    └── BKD Trees (for numeric &amp; geo fields)
</span><span id="__span-58-25"><a id="__codelineno-58-25" name="__codelineno-58-25" href="#__codelineno-58-25"></a>        └── Documents (JSON objects representing data records)(within segments)
</span></code></pre></div>
<hr />
<h3 id="6-summary-of-cluster-roles-and-data-flow">6. <strong>Summary of Cluster Roles and Data Flow</strong><a class="headerlink" href="#6-summary-of-cluster-roles-and-data-flow" title="Permanent link">&para;</a></h3>
<hr />
<table>
<thead>
<tr>
<th>Component</th>
<th>Description</th>
<th>Responsibilities</th>
</tr>
</thead>
<tbody>
<tr>
<td>Cluster</td>
<td>Top-level structure with multiple nodes</td>
<td>Manages overall data distribution, availability, and search</td>
</tr>
<tr>
<td>Master Node</td>
<td>Brain of the cluster</td>
<td>Handles cluster state, shard allocation, and fault tolerance</td>
</tr>
<tr>
<td>Data Node</td>
<td>Primary storage and processing node</td>
<td>Stores data, handles indexing, querying, and replica management</td>
</tr>
<tr>
<td>Coordinating Node</td>
<td>Routes and aggregates client requests</td>
<td>Routes requests to data nodes, aggregates responses, and sends back to clients</td>
</tr>
<tr>
<td>Ingest Node</td>
<td>Data transformation node</td>
<td>Preprocesses data with pipelines, ideal for parsing and enrichment</td>
</tr>
<tr>
<td>Index</td>
<td>Logical grouping of documents</td>
<td>Organizes data for efficient storage and querying</td>
</tr>
<tr>
<td>Shard</td>
<td>Distributed subset of index data</td>
<td>Represents a Lucene index with primary and replica copies</td>
</tr>
<tr>
<td>Segment</td>
<td>Immutable unit in a shard</td>
<td>Stores indexed data for fast read access</td>
</tr>
<tr>
<td>Document</td>
<td>Basic data unit in segments</td>
<td>JSON object representing individual data records</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="thread-pools">Thread Pools<a class="headerlink" href="#thread-pools" title="Permanent link">&para;</a></h2>
<p>Diving into Elasticsearch’s search and other thread pools is crucial to understanding its performance and scalability. These pools are essential for managing various tasks like indexing, searching, and handling incoming requests. Let’s go through these pools from end to end, covering configurations, management, and performance metrics to monitor.</p>
<hr />
<h3 id="1-overview">1. <strong>Overview</strong><a class="headerlink" href="#1-overview" title="Permanent link">&para;</a></h3>
<hr />
<ul>
<li>Elasticsearch uses multiple thread pools to handle different types of tasks.</li>
<li>Each pool is configured with a specific number of threads, queue sizes, and rejection policies.</li>
<li>Key pools include:<ul>
<li><strong>Search Pool</strong>: Handles search requests and related operations.</li>
<li><strong>Index Pool</strong>: Manages indexing requests, processing, and writing data.</li>
<li><strong>Get Pool</strong>: Manages document retrieval requests (like <code>GET</code> requests for individual documents).</li>
<li><strong>Bulk Pool</strong>: Handles bulk indexing operations.</li>
<li><strong>Management Pool</strong>: Manages internal maintenance tasks, like merging indices and refreshes.</li>
<li><strong>Snapshot Pool</strong>: Handles operations related to creating and restoring snapshots.</li>
</ul>
</li>
</ul>
<hr />
<h3 id="2-detailed-breakdown-of-key-pools">2. <strong>Detailed Breakdown of Key Pools</strong><a class="headerlink" href="#2-detailed-breakdown-of-key-pools" title="Permanent link">&para;</a></h3>
<hr />
<p>Here’s a closer look at each pool, along with common configurations and considerations:</p>
<ul>
<li>
<p><strong>Search Pool</strong></p>
<ul>
<li><strong>Purpose</strong>: Processes search queries, sorting, aggregations, and other search-related tasks.</li>
<li><strong>Configuration</strong>: </li>
<li><code>threads</code>: Generally calculated based on available CPU cores. It can be configured as <code># of processors * 3</code>.</li>
<li><code>queue_size</code>: Defines the maximum number of requests that can be queued before rejecting new ones. Default is <code>1000</code>.</li>
<li><strong>Tuning Tips</strong>: Increase <code>queue_size</code> if you experience high query load, but monitor memory use carefully to avoid <code>OutOfMemory</code> errors.</li>
<li><strong>Metrics to Monitor</strong>:</li>
<li><code>search_pool.active</code>: Shows active threads handling search requests.</li>
<li><code>search_pool.queue</code>: Tracks pending search requests.</li>
<li><code>search_pool.rejected</code>: Indicates rejected requests due to an overloaded pool.</li>
</ul>
</li>
<li>
<p><strong>Index Pool</strong></p>
<ul>
<li><strong>Purpose</strong>: Handles indexing requests to add or update documents.</li>
<li><strong>Configuration</strong>:</li>
<li><code>threads</code>: Typically set to the number of processors.</li>
<li><code>queue_size</code>: Default is <code>200</code>. If your indexing rate is high, you may need to increase this.</li>
<li><strong>Tuning Tips</strong>: Optimize for high throughput if you’re indexing frequently, but monitor for increased latency.</li>
<li><strong>Metrics to Monitor</strong>:</li>
<li><code>index_pool.active</code>: Active threads indexing data.</li>
<li><code>index_pool.queue</code>: Number of indexing requests waiting in the queue.</li>
<li><code>index_pool.rejected</code>: Tracks rejected indexing requests.</li>
</ul>
</li>
<li>
<p><strong>Get Pool</strong></p>
<ul>
<li><strong>Purpose</strong>: Manages retrieval requests like fetching individual documents.</li>
<li><strong>Configuration</strong>:</li>
<li><code>threads</code>: Tied to the number of processors, generally around <code># of processors * 2</code>.</li>
<li><code>queue_size</code>: Default is <code>1000</code>.</li>
<li><strong>Metrics to Monitor</strong>:</li>
<li><code>get_pool.active</code>: Active threads processing <code>GET</code> requests.</li>
<li><code>get_pool.queue</code>: Queued retrieval requests.</li>
<li><code>get_pool.rejected</code>: Indicates if any requests are being rejected.</li>
</ul>
</li>
<li>
<p><strong>Bulk Pool</strong></p>
<ul>
<li><strong>Purpose</strong>: Optimizes bulk indexing operations, commonly used for high-throughput data ingestion.</li>
<li><strong>Configuration</strong>:</li>
<li><code>threads</code>: Usually set as <code># of processors * 2</code>.</li>
<li><code>queue_size</code>: Often set at <code>50</code> to limit memory usage.</li>
<li><strong>Metrics to Monitor</strong>:</li>
<li><code>bulk_pool.active</code>: Active threads handling bulk operations.</li>
<li><code>bulk_pool.queue</code>: Queued bulk requests.</li>
<li><code>bulk_pool.rejected</code>: Shows if the bulk pool is rejecting requests due to overload.</li>
</ul>
</li>
<li>
<p><strong>Management Pool</strong></p>
<ul>
<li><strong>Purpose</strong>: Manages background tasks like index merging and cleanup operations.</li>
<li><strong>Configuration</strong>:</li>
<li>Configured with <code>1</code> to <code>5</code> threads as these tasks are not frequent.</li>
<li><strong>Metrics to Monitor</strong>:</li>
<li><code>management_pool.active</code>: Active management threads.</li>
<li><code>management_pool.queue</code>: Queued management tasks.</li>
<li><strong>Tip</strong>: Monitor this to ensure background tasks aren’t blocking other resources.</li>
</ul>
</li>
<li>
<p><strong>Snapshot Pool</strong></p>
<ul>
<li><strong>Purpose</strong>: Handles backup and snapshot-related tasks, essential for data recovery and backups.</li>
<li><strong>Configuration</strong>:</li>
<li>Configured with a low thread count (1 or 2).</li>
<li><strong>Metrics to Monitor</strong>:</li>
<li><code>snapshot_pool.active</code>: Active threads handling snapshots.</li>
<li><code>snapshot_pool.queue</code>: Queued snapshot operations.</li>
</ul>
</li>
</ul>
<hr />
<h3 id="3-configuring-and-tuning-thread-pools">3. <strong>Configuring and Tuning Thread Pools</strong><a class="headerlink" href="#3-configuring-and-tuning-thread-pools" title="Permanent link">&para;</a></h3>
<hr />
<ul>
<li><strong>Heap Size</strong>: Ensure your heap size is appropriate for the load. Elasticsearch requires sufficient memory to handle pool tasks without bottlenecks.</li>
<li><strong>CPU Allocation</strong>: Configure your server's CPU allocation based on thread pool demand. Pools that handle intensive operations, like search and indexing, benefit from additional CPU resources.</li>
<li><strong>Queue Size and Rejection Policies</strong>:<ul>
<li>Increase queue size if you see a consistent rise in queued tasks, but watch for higher memory usage.</li>
<li>Rejection policies control what happens when a queue is full; the default policy discards excess requests, but this can be customized if needed.</li>
</ul>
</li>
</ul>
<hr />
<h3 id="4-monitoring-metrics-for-thread-pools">4. <strong>Monitoring Metrics for Thread Pools</strong><a class="headerlink" href="#4-monitoring-metrics-for-thread-pools" title="Permanent link">&para;</a></h3>
<hr />
<ul>
<li><strong>Cluster Health and Node Stats</strong>: Regularly monitor cluster health metrics for thread pool performance, looking for bottlenecks or rejected tasks.</li>
<li><strong>Node-level Monitoring</strong>: Elasticsearch provides detailed metrics per node. Monitoring <code>node_stats.thread_pool.*</code> via monitoring tools (like Kibana or Prometheus) helps assess each pool's workload.</li>
<li><strong>Typical Metrics</strong>:<ul>
<li><code>active</code>: Indicates active threads. High values suggest a busy node.</li>
<li><code>queue</code>: Shows queued tasks. A consistent rise may indicate that the pool size needs tuning.</li>
<li><code>rejected</code>: Rejected tasks are a clear sign of bottlenecks.</li>
</ul>
</li>
</ul>
<hr />
<h3 id="5-example-scenarios-and-best-practices">5. <strong>Example Scenarios and Best Practices</strong><a class="headerlink" href="#5-example-scenarios-and-best-practices" title="Permanent link">&para;</a></h3>
<hr />
<ul>
<li><strong>High Search Load</strong>: If the search pool is frequently rejecting requests, consider increasing CPU allocation, thread count, or queue size.</li>
<li><strong>High Indexing Load</strong>: For frequent data ingestion, optimize the bulk and index pools. Consider using the bulk API with a balanced queue size and monitor memory.</li>
<li><strong>Snapshot Operations</strong>: Schedule snapshots during off-peak hours to reduce the impact on performance, as snapshot operations consume significant I/O.</li>
</ul>
<hr />
<h3 id="6-summary-table-of-pools">6. <strong>Summary Table of Pools</strong><a class="headerlink" href="#6-summary-table-of-pools" title="Permanent link">&para;</a></h3>
<hr />
<table>
<thead>
<tr>
<th><strong>Thread Pool</strong></th>
<th><strong>Purpose</strong></th>
<th><strong>Default Threads</strong></th>
<th><strong>Default Queue Size</strong></th>
<th><strong>Key Metrics</strong></th>
<th><strong>Tuning Tips</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Search Pool</strong></td>
<td>Processes search queries, aggregations</td>
<td><code># of processors * 3</code></td>
<td>1000</td>
<td><code>search_pool.active</code>, <code>search_pool.queue</code>, <code>search_pool.rejected</code></td>
<td>Increase <code>queue_size</code> if many queries are queued; monitor memory usage to prevent <code>OutOfMemory</code> issues.</td>
</tr>
<tr>
<td><strong>Index Pool</strong></td>
<td>Handles indexing requests for documents</td>
<td><code># of processors</code></td>
<td>200</td>
<td><code>index_pool.active</code>, <code>index_pool.queue</code>, <code>index_pool.rejected</code></td>
<td>For high indexing rates, increase queue size and thread count as necessary.</td>
</tr>
<tr>
<td><strong>Get Pool</strong></td>
<td>Retrieves individual documents</td>
<td><code># of processors * 2</code></td>
<td>1000</td>
<td><code>get_pool.active</code>, <code>get_pool.queue</code>, <code>get_pool.rejected</code></td>
<td>Increase <code>queue_size</code> if retrieval requests are high; monitor latency and resource usage.</td>
</tr>
<tr>
<td><strong>Bulk Pool</strong></td>
<td>Processes bulk indexing operations</td>
<td><code># of processors * 2</code></td>
<td>50</td>
<td><code>bulk_pool.active</code>, <code>bulk_pool.queue</code>, <code>bulk_pool.rejected</code></td>
<td>Keep <code>queue_size</code> modest to limit memory use; monitor latency during high bulk loads.</td>
</tr>
<tr>
<td><strong>Management Pool</strong></td>
<td>Manages maintenance tasks like merges</td>
<td>1–5</td>
<td>5</td>
<td><code>management_pool.active</code>, <code>management_pool.queue</code></td>
<td>Generally low usage; monitor only if <code>queue</code> is frequently non-empty, indicating background task delays.</td>
</tr>
<tr>
<td><strong>Snapshot Pool</strong></td>
<td>Handles snapshot creation and restoration</td>
<td>1–2</td>
<td>5</td>
<td><code>snapshot_pool.active</code>, <code>snapshot_pool.queue</code></td>
<td>Schedule snapshots during low-activity periods; adjust resources if snapshots interfere with other tasks.</td>
</tr>
</tbody>
</table>
<p>These pools are essential to optimizing Elasticsearch’s handling of diverse workloads. Monitoring and adjusting each pool based on your workload ensures better performance and resource management across the Elasticsearch cluster.</p>
<hr />
<h2 id="caching">Caching<a class="headerlink" href="#caching" title="Permanent link">&para;</a></h2>
<p>In Elasticsearch, caching plays a vital role in speeding up queries by storing frequently accessed data at various levels, minimizing I/O operations and improving response times. Here’s a detailed, end-to-end look at caching in Elasticsearch, from the lowest level to the highest, covering each caching mechanism and its role.</p>
<h3 id="1-types-of-caches-in-elasticsearch">1. <strong>Types of Caches in Elasticsearch</strong><a class="headerlink" href="#1-types-of-caches-in-elasticsearch" title="Permanent link">&para;</a></h3>
<p>There are several caching mechanisms in Elasticsearch, each working at a different level:</p>
<ul>
<li><strong>Filesystem Cache (OS-level)</strong></li>
<li><strong>Shard-level Cache</strong><ul>
<li><strong>Field Data Cache</strong></li>
<li><strong>Query Cache</strong></li>
<li><strong>Request Cache</strong></li>
</ul>
</li>
<li><strong>Node-level Cache</strong><ul>
<li><strong>Segment Cache</strong></li>
<li><strong>Indices Cache</strong></li>
</ul>
</li>
</ul>
<p>Each of these caches serves a specific purpose and optimizes a different aspect of query processing.</p>
<h3 id="2-filesystem-cache-os-level">2. <strong>Filesystem Cache (OS-level)</strong><a class="headerlink" href="#2-filesystem-cache-os-level" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Location</strong>: Managed by the operating system (OS) outside Elasticsearch.</li>
<li><strong>Purpose</strong>: The OS-level filesystem cache holds frequently accessed files and segments in memory, reducing the need for repeated disk access.</li>
<li><strong>How it Works</strong>: Elasticsearch relies on the OS filesystem cache to store files like index segments, which can be memory-mapped to avoid reading from disk. The OS determines which files to cache based on access patterns.</li>
<li><strong>Optimization Tips</strong>: Ensure that sufficient system memory is available for filesystem caching, as Elasticsearch performs best when a large portion of indices can be cached at this level.</li>
</ul>
<h3 id="3-shard-level-cache">3. <strong>Shard-level Cache</strong><a class="headerlink" href="#3-shard-level-cache" title="Permanent link">&para;</a></h3>
<h4 id="31-field-data-cache"><strong>3.1. Field Data Cache</strong><a class="headerlink" href="#31-field-data-cache" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Purpose</strong>: Speeds up operations that require field data, like sorting and aggregations, especially on text fields with <code>keyword</code> or <code>numeric</code> types.</li>
<li><strong>How it Works</strong>: When a field is accessed for sorting or aggregations, Elasticsearch loads the field data into memory as a field data cache. Field data caching is costly in terms of memory.</li>
<li><strong>Eviction Policy</strong>: Field data cache is held in memory, and it’s evicted based on the <code>indices.fielddata.cache.size</code> setting. Default eviction strategy is based on the Least Recently Used (LRU) policy.</li>
<li><strong>Metrics to Monitor</strong>:<ul>
<li><code>fielddata.memory_size</code>: Shows the amount of memory used by field data.</li>
<li><code>fielddata.evictions</code>: Tracks the number of evictions, which can indicate if your cache size is too small.</li>
</ul>
</li>
</ul>
<h4 id="32-query-cache"><strong>3.2. Query Cache</strong><a class="headerlink" href="#32-query-cache" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Purpose</strong>: Caches the results of frequently used queries to reduce re-execution. Especially useful for filters and term-level queries.</li>
<li><strong>How it Works</strong>: When the same query is run multiple times, Elasticsearch caches the results at the shard level, so it doesn’t have to re-run the same logic.</li>
<li><strong>Query Types Cached</strong>: Primarily caches filters like <code>term</code> queries and <code>range</code> queries, but does not cache full-text queries as they are more complex and vary widely.</li>
<li><strong>Eviction Policy</strong>: LRU-based. Controlled by the <code>indices.queries.cache.size</code> setting (default is 10% of the heap).</li>
<li><strong>Metrics to Monitor</strong>:<ul>
<li><code>query_cache.memory_size</code>: Memory occupied by the query cache.</li>
<li><code>query_cache.evictions</code>: Counts the number of evictions due to cache full.</li>
<li><code>query_cache.hit_count</code> and <code>query_cache.miss_count</code>: Useful for determining cache effectiveness.</li>
</ul>
</li>
</ul>
<h4 id="33-request-cache"><strong>3.3. Request Cache</strong><a class="headerlink" href="#33-request-cache" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Purpose</strong>: Optimizes entire search requests that involve aggregations and aren’t dependent on recent data changes.</li>
<li><strong>How it Works</strong>: Unlike the query cache, which stores results of individual query segments, the request cache stores results of entire search requests. It's effective for costly aggregation queries on static data.</li>
<li><strong>Conditions</strong>: Only applies to requests marked with <code>request_cache=true</code> and doesn’t cache when <code>track_total_hits</code> is enabled.</li>
<li><strong>Eviction Policy</strong>: Configurable per index with <code>index.requests.cache.enable</code> (enabled by default). Also LRU-based.</li>
<li><strong>Metrics to Monitor</strong>:<ul>
<li><code>request_cache.memory_size</code>: Shows the memory consumed by the request cache.</li>
<li><code>request_cache.evictions</code>: Tracks evictions in the request cache.</li>
<li><code>request_cache.hit_count</code> and <code>request_cache.miss_count</code>: Indicates request cache hit ratio.</li>
</ul>
</li>
</ul>
<h3 id="4-node-level-cache">4. <strong>Node-level Cache</strong><a class="headerlink" href="#4-node-level-cache" title="Permanent link">&para;</a></h3>
<h4 id="41-segment-cache"><strong>4.1. Segment Cache</strong><a class="headerlink" href="#41-segment-cache" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Purpose</strong>: Manages Lucene’s in-memory structures, like field terms, postings, and dictionaries, which are essential for indexing and search operations.</li>
<li><strong>How it Works</strong>: Lucene, the underlying library in Elasticsearch, caches segments of the index in memory to allow for faster retrieval of terms, term frequencies, and position information.</li>
<li><strong>Eviction Policy</strong>: Handled by Lucene based on access frequency and memory limits. It’s self-managed but benefits from larger heap sizes.</li>
<li><strong>Metrics to Monitor</strong>:<ul>
<li><code>segment.memory_in_bytes</code>: Memory used for cached segments.</li>
<li><code>segments.count</code>: Number of segments in the index.</li>
</ul>
</li>
<li><strong>Optimization Tips</strong>: Reduce segment merging frequency if memory is limited, but note that a higher number of segments can reduce performance.</li>
</ul>
<h4 id="42-indices-cache"><strong>4.2 Indices Cache</strong><a class="headerlink" href="#42-indices-cache" title="Permanent link">&para;</a></h4>
<ul>
<li><strong>Purpose</strong>: Stores certain metadata for all indices within the cluster to speed up operations that retrieve or refresh metadata.</li>
<li><strong>How it Works</strong>: Caches index mappings and settings to avoid repeatedly loading them from the disk, enabling faster index and shard management.</li>
<li><strong>Eviction Policy</strong>: LRU-based, with cache size managed by the heap space available.</li>
<li><strong>Metrics to Monitor</strong>: <code>indices.memory</code> and <code>indices.evictions</code> to track the memory usage and evictions for index metadata.</li>
</ul>
<h3 id="5-cache-tuning-and-best-practices">5. <strong>Cache Tuning and Best Practices</strong><a class="headerlink" href="#5-cache-tuning-and-best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Heap Size and Garbage Collection (GC)</strong>: Elasticsearch caches are memory-intensive, so allocate sufficient heap space. Optimal heap size is typically 50% of physical memory, up to 32GB.</li>
<li><strong>Cache Sizes</strong>: Configure cache sizes based on your workload. If queries are complex, increase <code>query_cache</code> and <code>request_cache</code>. For frequent aggregations, prioritize <code>field data cache</code>.</li>
<li><strong>Monitoring and Adjustment</strong>: Regularly monitor cache-related metrics. High eviction rates or memory pressure indicate that cache sizes should be increased.</li>
<li><strong>Use <code>fscache</code></strong>: The filesystem cache is essential, so configure sufficient memory for the OS to hold index files and segments, avoiding excessive I/O operations.</li>
<li><strong>Selective Caching</strong>: For frequently accessed static data, explicitly enable request and query caching by setting <code>request_cache=true</code> in your queries or adjusting cache policies at the index level.</li>
</ul>
<h3 id="6-summary-table-of-caching-mechanisms">6. <strong>Summary Table of Caching Mechanisms</strong><a class="headerlink" href="#6-summary-table-of-caching-mechanisms" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th><strong>Cache Type</strong></th>
<th><strong>Level</strong></th>
<th><strong>Purpose</strong></th>
<th><strong>Eviction Policy</strong></th>
<th><strong>Key Metrics</strong></th>
<th><strong>Tuning Tips</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Filesystem Cache</strong></td>
<td>OS</td>
<td>Stores files and segments in OS memory</td>
<td>Managed by OS</td>
<td>N/A</td>
<td>Ensure ample OS memory for larger index caching</td>
</tr>
<tr>
<td><strong>Field Data Cache</strong></td>
<td>Shard-level</td>
<td>Caches field data for aggregations and sorting</td>
<td>LRU-based, configurable</td>
<td><code>fielddata.memory_size</code>, <code>fielddata.evictions</code></td>
<td>Increase size for high aggregation requirements</td>
</tr>
<tr>
<td><strong>Query Cache</strong></td>
<td>Shard-level</td>
<td>Caches individual filter query results</td>
<td>LRU-based, configurable</td>
<td><code>query_cache.memory_size</code>, <code>query_cache.evictions</code>, <code>query_cache.hit_count</code>, <code>query_cache.miss_count</code></td>
<td>Monitor hit/miss ratios to determine effectiveness</td>
</tr>
<tr>
<td><strong>Request Cache</strong></td>
<td>Shard-level</td>
<td>Caches entire search request results</td>
<td>LRU-based, per-index</td>
<td><code>request_cache.memory_size</code>, <code>request_cache.evictions</code>, <code>request_cache.hit_count</code>, <code>request_cache.miss_count</code></td>
<td>Best for aggregations on static data</td>
</tr>
<tr>
<td><strong>Segment Cache</strong></td>
<td>Node-level</td>
<td>Caches Lucene index segments and postings</td>
<td>Managed by Lucene</td>
<td><code>segment.memory_in_bytes</code>, <code>segments.count</code></td>
<td>Larger heap size improves cache efficiency</td>
</tr>
<tr>
<td><strong>Indices Cache</strong></td>
<td>Node-level</td>
<td>Caches index metadata (mappings, settings)</td>
<td>LRU-based</td>
<td><code>indices.memory</code>, <code>indices.evictions</code></td>
<td>Adjust based on frequency of metadata updates</td>
</tr>
</tbody>
</table>
<p>Each caching layer works in tandem to optimize query speed and efficiency, and monitoring these caches is essential for fine-tuning Elasticsearch performance to meet your specific use cases.</p>
<hr />
<h2 id="index-life-management-ilm">Index Life Management - ILM<a class="headerlink" href="#index-life-management-ilm" title="Permanent link">&para;</a></h2>
<p>Elasticsearch’s <strong>Hot-Warm-Cold (Hot-Warm-Cold-Frozen)</strong> architecture is part of its <strong>Index Lifecycle Management (ILM)</strong> system, designed to optimize storage and cost-efficiency for managing data that has different usage patterns over time. This architecture allows you to store data on different types of nodes (hot, warm, cold, and frozen) based on data retention needs and access frequency. Here’s an in-depth look at each phase and how to effectively manage data with Elasticsearch’s ILM:</p>
<hr />
<h3 id="1-purpose-of-hot-warm-cold-architecture">1. <strong>Purpose of Hot-Warm-Cold Architecture</strong><a class="headerlink" href="#1-purpose-of-hot-warm-cold-architecture" title="Permanent link">&para;</a></h3>
<ul>
<li>Optimizes storage costs and resource allocation based on the age and usage pattern of the data.</li>
<li>Maximizes query performance for recent data while preserving older data with reduced resource consumption.</li>
<li>Enables scalable management of large data volumes across different hardware types or cloud storage.</li>
</ul>
<h3 id="2-phases-in-ilm-index-lifecycle-management">2. <strong>Phases in ILM (Index Lifecycle Management)</strong><a class="headerlink" href="#2-phases-in-ilm-index-lifecycle-management" title="Permanent link">&para;</a></h3>
<p>The ILM policy defines actions to transition data through different stages based on time or data access patterns:</p>
<ul>
<li><strong>Hot Phase</strong>: For recent, frequently accessed data.</li>
<li><strong>Warm Phase</strong>: For less frequently queried but still relevant data.</li>
<li><strong>Cold Phase</strong>: For older data accessed occasionally.</li>
<li><strong>Frozen Phase</strong>: For archived data with very low access frequency.</li>
<li><strong>Delete Phase</strong>: Optionally, data is deleted at the end of its lifecycle.</li>
</ul>
<h3 id="3-hot-phase-high-performance-node-configuration">3. <strong>Hot Phase (High-Performance Node Configuration)</strong><a class="headerlink" href="#3-hot-phase-high-performance-node-configuration" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Stores actively ingested and queried data.</li>
<li><strong>Hardware Requirements</strong>: High CPU, fast SSD storage, and large memory (RAM) for fast indexing and search.</li>
<li><strong>Shard Configuration</strong>:<ul>
<li>Use a smaller number of larger shards to optimize indexing speed.</li>
<li>Allocate more replicas if redundancy and high read performance are necessary.</li>
</ul>
</li>
<li><strong>ILM Actions</strong>:<ul>
<li><strong>Rollover</strong>: Create a new index after a certain data volume or time threshold is met (e.g., daily index rollover).</li>
<li><strong>Force Merge</strong>: Reduce the number of segments per shard to improve read efficiency.</li>
</ul>
</li>
<li><strong>Common Use Cases</strong>: Logging, analytics on recent data, real-time application monitoring.</li>
</ul>
<h3 id="4-warm-phase-mid-performance-node-configuration">4. <strong>Warm Phase (Mid-Performance Node Configuration)</strong><a class="headerlink" href="#4-warm-phase-mid-performance-node-configuration" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Stores data that is queried less frequently but is still relevant for analysis.</li>
<li><strong>Hardware Requirements</strong>: Moderate CPU, lower-cost storage (often SSD or HDD), and less RAM compared to hot nodes.</li>
<li><strong>Shard Configuration</strong>:<ul>
<li>May have fewer replicas compared to the hot phase, given reduced query demands.</li>
<li>Shards are consolidated to optimize storage.</li>
</ul>
</li>
<li><strong>ILM Actions</strong>:<ul>
<li><strong>Shrink</strong>: Shrink the index to fewer primary shards to save resources.</li>
<li><strong>Force Merge</strong>: Further reduce segments for efficiency.</li>
<li><strong>Move to Warm Nodes</strong>: Transfers data from hot to warm nodes for cost-effective storage.</li>
</ul>
</li>
<li><strong>Common Use Cases</strong>: Historical data analysis, infrequent but accessible data, dashboards showing past data trends.</li>
</ul>
<h3 id="5-cold-phase-cost-effective-node-configuration">5. <strong>Cold Phase (Cost-Effective Node Configuration)</strong><a class="headerlink" href="#5-cold-phase-cost-effective-node-configuration" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Stores older data that is rarely accessed but still retained for compliance or occasional analysis.</li>
<li><strong>Hardware Requirements</strong>: Lower-cost HDD storage, lower CPU, and RAM. Cold nodes can tolerate higher latency.</li>
<li><strong>Shard Configuration</strong>:<ul>
<li>Minimal number of replicas, as high availability is less critical.</li>
<li>Shards can be larger as search latency is not a priority.</li>
</ul>
</li>
<li><strong>ILM Actions</strong>:<ul>
<li><strong>Move to Cold Nodes</strong>: Moves indices to cold nodes to reduce costs.</li>
<li><strong>Freeze Index</strong>: Index is searchable but placed in a lower-memory footprint mode.</li>
<li><strong>Force Merge to a Single Segment</strong>: Further reduces the number of segments.</li>
</ul>
</li>
<li><strong>Common Use Cases</strong>: Compliance storage, infrequently accessed logs, backup data for low-priority analysis.</li>
</ul>
<h3 id="6-frozen-phase-archival-node-configuration">6. <strong>Frozen Phase (Archival Node Configuration)</strong><a class="headerlink" href="#6-frozen-phase-archival-node-configuration" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Stores archived data that is very rarely accessed.</li>
<li><strong>Hardware Requirements</strong>: Can use very low-cost storage options, including external storage like S3 or other blob storage.</li>
<li><strong>Shard Configuration</strong>:<ul>
<li>Data in the frozen phase is accessed directly from disk without caching in memory.</li>
<li>Lowest possible number of replicas, if any.</li>
</ul>
</li>
<li><strong>ILM Actions</strong>:<ul>
<li><strong>Move to Frozen Nodes</strong>: Moves data to frozen nodes or even object storage to further reduce costs.</li>
<li><strong>Unfreeze on Query</strong>: Data is unarchived only when accessed.</li>
</ul>
</li>
<li><strong>Common Use Cases</strong>: Long-term archives, historical records for compliance.</li>
</ul>
<h3 id="7-delete-phase-optional-phase">7. <strong>Delete Phase (Optional Phase)</strong><a class="headerlink" href="#7-delete-phase-optional-phase" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Purpose</strong>: Automatically deletes data that has reached the end of its lifecycle.</li>
<li><strong>ILM Actions</strong>:<ul>
<li><strong>Delete Index</strong>: Permanently removes data from the cluster.</li>
</ul>
</li>
<li><strong>Common Use Cases</strong>: Compliance-driven data retention policies, automated data cleanup.</li>
</ul>
<h3 id="8-setting-up-ilm-policies">8. <strong>Setting Up ILM Policies</strong><a class="headerlink" href="#8-setting-up-ilm-policies" title="Permanent link">&para;</a></h3>
<ul>
<li>Define an ILM policy specifying transitions and actions for each phase.</li>
<li>Assign the policy to indices at creation, typically through index templates.</li>
<li>The ILM policy automatically manages the transition of data through the hot, warm, cold, and frozen phases.</li>
</ul>
<h3 id="9-cluster-resource-optimization-with-hot-warm-cold-architecture">9. <strong>Cluster Resource Optimization with Hot-Warm-Cold Architecture</strong><a class="headerlink" href="#9-cluster-resource-optimization-with-hot-warm-cold-architecture" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Hot Nodes</strong>: Provide high-speed access to recent data, require higher infrastructure investment.</li>
<li><strong>Warm Nodes</strong>: Optimize costs while maintaining access to recent historical data with moderate query needs.</li>
<li><strong>Cold Nodes</strong>: Cost-efficient storage for compliance or archival data.</li>
<li><strong>Frozen Nodes</strong>: Minimal cost storage, including cloud or external storage options for rarely accessed data.</li>
</ul>
<h3 id="10-example-ilm-policy">10. <strong>Example ILM Policy</strong><a class="headerlink" href="#10-example-ilm-policy" title="Permanent link">&para;</a></h3>
<p>Here’s an example ILM policy to illustrate phase-based transitions for a log analytics use case:</p>
<div class="language-json highlight"><pre><span></span><code><span id="__span-59-1"><a id="__codelineno-59-1" name="__codelineno-59-1" href="#__codelineno-59-1"></a><span class="p">{</span>
</span><span id="__span-59-2"><a id="__codelineno-59-2" name="__codelineno-59-2" href="#__codelineno-59-2"></a><span class="w">  </span><span class="nt">&quot;policy&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-3"><a id="__codelineno-59-3" name="__codelineno-59-3" href="#__codelineno-59-3"></a><span class="w">    </span><span class="nt">&quot;phases&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-4"><a id="__codelineno-59-4" name="__codelineno-59-4" href="#__codelineno-59-4"></a><span class="w">      </span><span class="nt">&quot;hot&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-5"><a id="__codelineno-59-5" name="__codelineno-59-5" href="#__codelineno-59-5"></a><span class="w">        </span><span class="nt">&quot;actions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-6"><a id="__codelineno-59-6" name="__codelineno-59-6" href="#__codelineno-59-6"></a><span class="w">          </span><span class="nt">&quot;rollover&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-7"><a id="__codelineno-59-7" name="__codelineno-59-7" href="#__codelineno-59-7"></a><span class="w">            </span><span class="nt">&quot;max_age&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;7d&quot;</span><span class="p">,</span>
</span><span id="__span-59-8"><a id="__codelineno-59-8" name="__codelineno-59-8" href="#__codelineno-59-8"></a><span class="w">            </span><span class="nt">&quot;max_size&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;50gb&quot;</span>
</span><span id="__span-59-9"><a id="__codelineno-59-9" name="__codelineno-59-9" href="#__codelineno-59-9"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-59-10"><a id="__codelineno-59-10" name="__codelineno-59-10" href="#__codelineno-59-10"></a><span class="w">          </span><span class="nt">&quot;set_priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-11"><a id="__codelineno-59-11" name="__codelineno-59-11" href="#__codelineno-59-11"></a><span class="w">            </span><span class="nt">&quot;priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">100</span>
</span><span id="__span-59-12"><a id="__codelineno-59-12" name="__codelineno-59-12" href="#__codelineno-59-12"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-59-13"><a id="__codelineno-59-13" name="__codelineno-59-13" href="#__codelineno-59-13"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-59-14"><a id="__codelineno-59-14" name="__codelineno-59-14" href="#__codelineno-59-14"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-59-15"><a id="__codelineno-59-15" name="__codelineno-59-15" href="#__codelineno-59-15"></a><span class="w">      </span><span class="nt">&quot;warm&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-16"><a id="__codelineno-59-16" name="__codelineno-59-16" href="#__codelineno-59-16"></a><span class="w">        </span><span class="nt">&quot;min_age&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;30d&quot;</span><span class="p">,</span>
</span><span id="__span-59-17"><a id="__codelineno-59-17" name="__codelineno-59-17" href="#__codelineno-59-17"></a><span class="w">        </span><span class="nt">&quot;actions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-18"><a id="__codelineno-59-18" name="__codelineno-59-18" href="#__codelineno-59-18"></a><span class="w">          </span><span class="nt">&quot;allocate&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-19"><a id="__codelineno-59-19" name="__codelineno-59-19" href="#__codelineno-59-19"></a><span class="w">            </span><span class="nt">&quot;number_of_replicas&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-59-20"><a id="__codelineno-59-20" name="__codelineno-59-20" href="#__codelineno-59-20"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-59-21"><a id="__codelineno-59-21" name="__codelineno-59-21" href="#__codelineno-59-21"></a><span class="w">          </span><span class="nt">&quot;forcemerge&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-22"><a id="__codelineno-59-22" name="__codelineno-59-22" href="#__codelineno-59-22"></a><span class="w">            </span><span class="nt">&quot;max_num_segments&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">1</span>
</span><span id="__span-59-23"><a id="__codelineno-59-23" name="__codelineno-59-23" href="#__codelineno-59-23"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-59-24"><a id="__codelineno-59-24" name="__codelineno-59-24" href="#__codelineno-59-24"></a><span class="w">          </span><span class="nt">&quot;set_priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-25"><a id="__codelineno-59-25" name="__codelineno-59-25" href="#__codelineno-59-25"></a><span class="w">            </span><span class="nt">&quot;priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">50</span>
</span><span id="__span-59-26"><a id="__codelineno-59-26" name="__codelineno-59-26" href="#__codelineno-59-26"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-59-27"><a id="__codelineno-59-27" name="__codelineno-59-27" href="#__codelineno-59-27"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-59-28"><a id="__codelineno-59-28" name="__codelineno-59-28" href="#__codelineno-59-28"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-59-29"><a id="__codelineno-59-29" name="__codelineno-59-29" href="#__codelineno-59-29"></a><span class="w">      </span><span class="nt">&quot;cold&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-30"><a id="__codelineno-59-30" name="__codelineno-59-30" href="#__codelineno-59-30"></a><span class="w">        </span><span class="nt">&quot;min_age&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;90d&quot;</span><span class="p">,</span>
</span><span id="__span-59-31"><a id="__codelineno-59-31" name="__codelineno-59-31" href="#__codelineno-59-31"></a><span class="w">        </span><span class="nt">&quot;actions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-32"><a id="__codelineno-59-32" name="__codelineno-59-32" href="#__codelineno-59-32"></a><span class="w">          </span><span class="nt">&quot;allocate&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-33"><a id="__codelineno-59-33" name="__codelineno-59-33" href="#__codelineno-59-33"></a><span class="w">            </span><span class="nt">&quot;require&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-34"><a id="__codelineno-59-34" name="__codelineno-59-34" href="#__codelineno-59-34"></a><span class="w">              </span><span class="nt">&quot;data&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;cold&quot;</span>
</span><span id="__span-59-35"><a id="__codelineno-59-35" name="__codelineno-59-35" href="#__codelineno-59-35"></a><span class="w">            </span><span class="p">}</span>
</span><span id="__span-59-36"><a id="__codelineno-59-36" name="__codelineno-59-36" href="#__codelineno-59-36"></a><span class="w">          </span><span class="p">},</span>
</span><span id="__span-59-37"><a id="__codelineno-59-37" name="__codelineno-59-37" href="#__codelineno-59-37"></a><span class="w">          </span><span class="nt">&quot;freeze&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{},</span>
</span><span id="__span-59-38"><a id="__codelineno-59-38" name="__codelineno-59-38" href="#__codelineno-59-38"></a><span class="w">          </span><span class="nt">&quot;set_priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-39"><a id="__codelineno-59-39" name="__codelineno-59-39" href="#__codelineno-59-39"></a><span class="w">            </span><span class="nt">&quot;priority&quot;</span><span class="p">:</span><span class="w"> </span><span class="mi">0</span>
</span><span id="__span-59-40"><a id="__codelineno-59-40" name="__codelineno-59-40" href="#__codelineno-59-40"></a><span class="w">          </span><span class="p">}</span>
</span><span id="__span-59-41"><a id="__codelineno-59-41" name="__codelineno-59-41" href="#__codelineno-59-41"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-59-42"><a id="__codelineno-59-42" name="__codelineno-59-42" href="#__codelineno-59-42"></a><span class="w">      </span><span class="p">},</span>
</span><span id="__span-59-43"><a id="__codelineno-59-43" name="__codelineno-59-43" href="#__codelineno-59-43"></a><span class="w">      </span><span class="nt">&quot;delete&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-44"><a id="__codelineno-59-44" name="__codelineno-59-44" href="#__codelineno-59-44"></a><span class="w">        </span><span class="nt">&quot;min_age&quot;</span><span class="p">:</span><span class="w"> </span><span class="s2">&quot;365d&quot;</span><span class="p">,</span>
</span><span id="__span-59-45"><a id="__codelineno-59-45" name="__codelineno-59-45" href="#__codelineno-59-45"></a><span class="w">        </span><span class="nt">&quot;actions&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{</span>
</span><span id="__span-59-46"><a id="__codelineno-59-46" name="__codelineno-59-46" href="#__codelineno-59-46"></a><span class="w">          </span><span class="nt">&quot;delete&quot;</span><span class="p">:</span><span class="w"> </span><span class="p">{}</span>
</span><span id="__span-59-47"><a id="__codelineno-59-47" name="__codelineno-59-47" href="#__codelineno-59-47"></a><span class="w">        </span><span class="p">}</span>
</span><span id="__span-59-48"><a id="__codelineno-59-48" name="__codelineno-59-48" href="#__codelineno-59-48"></a><span class="w">      </span><span class="p">}</span>
</span><span id="__span-59-49"><a id="__codelineno-59-49" name="__codelineno-59-49" href="#__codelineno-59-49"></a><span class="w">    </span><span class="p">}</span>
</span><span id="__span-59-50"><a id="__codelineno-59-50" name="__codelineno-59-50" href="#__codelineno-59-50"></a><span class="w">  </span><span class="p">}</span>
</span><span id="__span-59-51"><a id="__codelineno-59-51" name="__codelineno-59-51" href="#__codelineno-59-51"></a><span class="p">}</span>
</span></code></pre></div>
<ul>
<li><strong>Hot Phase</strong>: Rollover index every 7 days or 50GB.</li>
<li><strong>Warm Phase</strong>: Transition after 30 days, reduce segment count, keep one replica.</li>
<li><strong>Cold Phase</strong>: Transition after 90 days, freeze index to reduce memory usage.</li>
<li><strong>Delete Phase</strong>: Automatically delete indices older than 365 days.</li>
</ul>
<h3 id="11-advantages-of-hot-warm-cold-architecture">11. <strong>Advantages of Hot-Warm-Cold Architecture</strong><a class="headerlink" href="#11-advantages-of-hot-warm-cold-architecture" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Cost Savings</strong>: Reduces storage and resource costs by using lower-cost hardware for less-accessed data.</li>
<li><strong>Optimized Performance</strong>: Ensures high performance for recent data by keeping it on high-speed hot nodes.</li>
<li><strong>Automated Management</strong>: ILM policies automate data transitions, reducing operational overhead.</li>
<li><strong>Flexible Retention</strong>: Facilitates retention policies to ensure compliance with data governance and regulatory requirements.</li>
</ul>
<h3 id="12-best-practices">12. <strong>Best Practices</strong><a class="headerlink" href="#12-best-practices" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Separate Nodes by Type</strong>: Use dedicated nodes for each phase to optimize hardware based on the phase requirements.</li>
<li><strong>Frequent ILM Review</strong>: Regularly review and adjust ILM policies based on access patterns and data growth.</li>
<li><strong>Monitor ILM Transitions</strong>: Track transition performance to ensure data is moving efficiently between phases.</li>
</ul>
<h3 id="13-summary-table">13. Summary Table<a class="headerlink" href="#13-summary-table" title="Permanent link">&para;</a></h3>
<table>
<thead>
<tr>
<th><strong>Phase</strong></th>
<th><strong>Data Usage</strong></th>
<th><strong>Hardware</strong></th>
<th><strong>ILM Actions</strong></th>
<th><strong>Typical Use Cases</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Hot</strong></td>
<td>Active, high access</td>
<td>High CPU, SSD, large RAM</td>
<td>Rollover, force merge</td>
<td>Real-time search, recent logs, app monitoring</td>
</tr>
<tr>
<td><strong>Warm</strong></td>
<td>Mid-range access</td>
<td>Moderate CPU, SSD or HDD, RAM</td>
<td>Shrink, force merge, reallocate</td>
<td>Data analytics on recent history, dashboard views</td>
</tr>
<tr>
<td><strong>Cold</strong></td>
<td>Infrequent access</td>
<td>Low CPU, HDD, minimal RAM</td>
<td>Freeze, move to cold nodes</td>
<td>Compliance storage, infrequent analysis</td>
</tr>
<tr>
<td><strong>Frozen</strong></td>
<td>Rarely accessed</td>
<td>Minimal CPU/RAM, cloud storage</td>
<td>Unfreeze on access, move to frozen node</td>
<td>Long-term archival, compliance data</td>
</tr>
<tr>
<td><strong>Delete</strong></td>
<td>Expired data</td>
<td>N/A</td>
<td>Delete</td>
<td>Data lifecycle cleanup</td>
</tr>
</tbody>
</table>
<p>This Hot-Warm-Cold architecture in Elasticsearch enables you to balance cost, performance, and data accessibility across various hardware configurations, ensuring that data is always stored cost-effectively without compromising on necessary access patterns.</p>
<hr />
<h2 id="list-of-rest-apis">List of REST APIs<a class="headerlink" href="#list-of-rest-apis" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th><strong>API Endpoint</strong></th>
<th><strong>Purpose</strong></th>
<th><strong>Description</strong></th>
<th><strong>Typical Latency</strong></th>
<th><strong>Use Cases</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Index APIs</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>POST /{index}/_doc</code></td>
<td>Index a Document</td>
<td>Adds or updates a document in the specified index.</td>
<td>Low (~5-10ms for small docs)</td>
<td>Real-time data ingestion, document updates.</td>
</tr>
<tr>
<td><code>POST /{index}/_bulk</code></td>
<td>Bulk Indexing</td>
<td>Allows indexing, updating, or deleting multiple documents in a single request.</td>
<td>Low to Medium (~10-50ms)</td>
<td>High-volume data ingestion, ETL processes.</td>
</tr>
<tr>
<td><code>POST /{index}/_update/{id}</code></td>
<td>Update a Document</td>
<td>Partially updates a document by ID in the specified index.</td>
<td>Low to Medium (~10-30ms)</td>
<td>Updating specific fields in documents.</td>
</tr>
<tr>
<td><code>DELETE /{index}/_doc/{id}</code></td>
<td>Delete a Document</td>
<td>Deletes a document by ID from the specified index.</td>
<td>Low (~5-10ms)</td>
<td>Document removal based on unique IDs.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Search APIs</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>GET /{index}/_search</code></td>
<td>Search Documents</td>
<td>Executes a search query with optional filters, aggregations, and pagination.</td>
<td>Medium to High (~10-100ms, based on complexity)</td>
<td>Full-text search, structured queries, analytics.</td>
</tr>
<tr>
<td><code>POST /{index}/_search/scroll</code></td>
<td>Scroll Search</td>
<td>Enables retrieving large datasets by scrolling through search results.</td>
<td>Medium to High (~50-200ms)</td>
<td>Pagination for large datasets, data exports.</td>
</tr>
<tr>
<td><code>DELETE /_search/scroll</code></td>
<td>Clear Scroll Context</td>
<td>Clears scroll contexts to free up resources.</td>
<td>Low (~5ms)</td>
<td>Resource management after scroll search.</td>
</tr>
<tr>
<td><code>POST /_msearch</code></td>
<td>Multi-Search</td>
<td>Allows execution of multiple search queries in a single request.</td>
<td>Medium to High (~20-150ms)</td>
<td>Batch querying, dashboard visualizations.</td>
</tr>
<tr>
<td><code>POST /{index}/_count</code></td>
<td>Count Documents</td>
<td>Counts the documents matching a query without returning full results.</td>
<td>Low (~5-20ms)</td>
<td>Quick counts of filtered datasets.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Aggregation APIs</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>POST /{index}/_search</code></td>
<td>Aggregation Queries</td>
<td>Used with the search API to retrieve aggregated data (e.g., histograms, averages).</td>
<td>Medium to High (~20-150ms)</td>
<td>Analytics, reporting, data summarization.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Cluster and Node APIs</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>GET /_cluster/health</code></td>
<td>Cluster Health</td>
<td>Returns health information on the cluster, nodes, and indices.</td>
<td>Low (~5ms)</td>
<td>Monitoring cluster health and node status.</td>
</tr>
<tr>
<td><code>GET /_cluster/stats</code></td>
<td>Cluster Statistics</td>
<td>Provides statistics on cluster status, node usage, and storage.</td>
<td>Low to Medium (~5-20ms)</td>
<td>Cluster-wide monitoring and performance analysis.</td>
</tr>
<tr>
<td><code>POST /_cluster/reroute</code></td>
<td>Cluster Reroute</td>
<td>Manually reroutes shards in the cluster.</td>
<td>Medium (~20-50ms)</td>
<td>Shard management and rebalancing.</td>
</tr>
<tr>
<td><code>GET /_nodes/stats</code></td>
<td>Node Statistics</td>
<td>Returns stats for nodes, including CPU, memory, and thread pools.</td>
<td>Low to Medium (~5-20ms)</td>
<td>Node health monitoring, resource usage analysis.</td>
</tr>
<tr>
<td><code>GET /_cat/nodes</code></td>
<td>List Nodes</td>
<td>Provides a list of all nodes in the cluster in a human-readable format.</td>
<td>Low (~5ms)</td>
<td>Node overview, node status.</td>
</tr>
<tr>
<td><code>GET /_cat/indices</code></td>
<td>List Indices</td>
<td>Lists all indices with metadata on size, health, and document count.</td>
<td>Low (~5ms)</td>
<td>Index management and monitoring.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Index Management APIs</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>PUT /{index}</code></td>
<td>Create Index</td>
<td>Creates a new index with specific settings and mappings.</td>
<td>Low (~10-20ms)</td>
<td>Index setup and schema definition.</td>
</tr>
<tr>
<td><code>DELETE /{index}</code></td>
<td>Delete Index</td>
<td>Deletes the specified index.</td>
<td>Low (~5-10ms)</td>
<td>Index removal, data management.</td>
</tr>
<tr>
<td><code>PUT /{index}/_settings</code></td>
<td>Update Index Settings</td>
<td>Updates settings (e.g., refresh interval) of an index.</td>
<td>Low (~10ms)</td>
<td>Dynamic adjustments of index settings.</td>
</tr>
<tr>
<td><code>POST /{index}/_refresh</code></td>
<td>Refresh Index</td>
<td>Refreshes an index to make recent changes searchable.</td>
<td>Medium (~10-30ms)</td>
<td>Ensures data is available for search in near-real-time.</td>
</tr>
<tr>
<td><code>POST /{index}/_forcemerge</code></td>
<td>Force Merge Index</td>
<td>Reduces the number of segments in an index to optimize storage.</td>
<td>High (~100ms - 1s+)</td>
<td>Optimize index storage, improve search speed.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Cache and Memory Management</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>POST /{index}/_cache/clear</code></td>
<td>Clear Index Cache</td>
<td>Clears the cache for the specified index.</td>
<td>Low (~5ms)</td>
<td>Cache management for performance tuning.</td>
</tr>
<tr>
<td><code>POST /_flush</code></td>
<td>Flush Index</td>
<td>Writes all buffered changes to disk.</td>
<td>Medium (~10-30ms)</td>
<td>Data durability, cache clearing.</td>
</tr>
<tr>
<td><code>POST /{index}/_refresh</code></td>
<td>Refresh</td>
<td>Makes recent changes to an index visible to search.</td>
<td>Medium (~10-30ms)</td>
<td>Near real-time updates in the search index.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Snapshot and Backup APIs</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>PUT /_snapshot/{repo}/{snapshot}</code></td>
<td>Create Snapshot</td>
<td>Creates a snapshot of indices for backup.</td>
<td>High (dependent on index size)</td>
<td>Data backup, disaster recovery.</td>
</tr>
<tr>
<td><code>GET /_snapshot/{repo}/{snapshot}</code></td>
<td>Get Snapshot Status</td>
<td>Checks the status of an existing snapshot.</td>
<td>Low (~5ms)</td>
<td>Monitor snapshot progress, status checks.</td>
</tr>
<tr>
<td><code>DELETE /_snapshot/{repo}/{snapshot}</code></td>
<td>Delete Snapshot</td>
<td>Deletes an existing snapshot.</td>
<td>Medium (~10-20ms)</td>
<td>Snapshot lifecycle management, freeing storage.</td>
</tr>
<tr>
<td></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><strong>Security and Role Management</strong></td>
<td></td>
<td></td>
<td></td>
<td></td>
</tr>
<tr>
<td><code>POST /_security/role/{role}</code></td>
<td>Create/Update Role</td>
<td>Creates or updates a security role with specific permissions.</td>
<td>Low (~5-10ms)</td>
<td>Access control, role-based permissions.</td>
</tr>
<tr>
<td><code>POST /_security/user/{user}</code></td>
<td>Create/Update User</td>
<td>Creates or updates a user in Elasticsearch.</td>
<td>Low (~5-10ms)</td>
<td>User management, access permissions.</td>
</tr>
<tr>
<td><code>GET /_security/_authenticate</code></td>
<td>Authenticate User</td>
<td>Authenticates the current user.</td>
<td>Low (~5ms)</td>
<td>Session management, authentication checks.</td>
</tr>
</tbody>
</table>
<h3 id="additional-notes">Additional Notes<a class="headerlink" href="#additional-notes" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Latency</strong> varies by operation complexity, cluster size, and data volume. Basic CRUD operations and small management tasks typically have lower latencies.</li>
<li><strong>Bulk operations</strong> optimize high-volume data processing by batching requests, but they may slightly increase latency for individual actions due to combined processing.</li>
<li><strong>Search and aggregation latencies</strong> increase with query complexity, the number of documents involved, and the number of shards searched.</li>
</ul>
<hr />
<h2 id="capacity-planning-cluster-design">Capacity Planning &amp; Cluster Design<a class="headerlink" href="#capacity-planning-cluster-design" title="Permanent link">&para;</a></h2>
<table>
<thead>
<tr>
<th><strong>Parameter</strong></th>
<th><strong>Formula / Best Practice</strong></th>
<th><strong>Description</strong></th>
<th><strong>Example Calculation</strong></th>
</tr>
</thead>
<tbody>
<tr>
<td><strong>Total Data Nodes</strong></td>
<td>$ \text{Total Shards} \times \text{Shard Size} / \text{Node Disk Capacity} $</td>
<td>Calculate required data nodes based on total shard size and node storage.</td>
<td>20 shards of 30GB each on 600GB nodes → 1 data node</td>
</tr>
<tr>
<td><strong>Heap Memory Allocation</strong></td>
<td>$ \text{Total Node RAM} \times 0.5 $ (up to 32GB max)</td>
<td>Allocate 50% of node memory to JVM heap, up to 32GB, to optimize memory usage.</td>
<td>Node with 64GB RAM → 32GB heap</td>
</tr>
<tr>
<td><strong>Storage Requirement</strong></td>
<td>$ \text{Total Data Size} \times (1 + \text{Replication Factor}) \times \text{Retention Period (months)} $</td>
<td>Plan storage capacity based on expected data size and replication.</td>
<td>1TB data, 1 replica, 1-month retention → 2TB</td>
</tr>
<tr>
<td><strong>Ideal Shard Size</strong></td>
<td>20-50 GB per shard</td>
<td>Recommended shard size for optimal performance and manageability.</td>
<td>Aim for shards ~30GB each for balanced load</td>
</tr>
<tr>
<td><strong>Shards per Index</strong></td>
<td>$ \text{Total Data Size} / \text{Target Shard Size} $</td>
<td>Calculate shard count to avoid excessive shard management overhead.</td>
<td>500GB index, 25GB target shard size → 20 shards</td>
</tr>
<tr>
<td><strong>Max Shard Count</strong></td>
<td>Avoid more than 20 shards per GB of heap</td>
<td>Ensure shard count doesn’t exceed a level that can cause memory strain.</td>
<td>32GB heap → max ~640 shards across all indices</td>
</tr>
<tr>
<td><strong>Master Nodes</strong></td>
<td>Minimum of 3</td>
<td>Dedicated master nodes ensure quorum-based fault tolerance and cluster stability.</td>
<td>At least 3 master nodes for high availability</td>
</tr>
<tr>
<td><strong>Coordinating Nodes</strong></td>
<td>1 per 10 data nodes in large clusters</td>
<td>Handle query load without adding data nodes, especially with complex aggregation queries.</td>
<td>50 data nodes → 5 coordinating nodes</td>
</tr>
<tr>
<td><strong>CPU Requirement</strong></td>
<td>4-8 CPUs per data node</td>
<td>Allocate enough CPUs to handle search and indexing operations without bottlenecks.</td>
<td>4-8 CPUs per node for typical workloads</td>
</tr>
<tr>
<td><strong>Disk I/O Throughput</strong></td>
<td>Minimum of 300 MB/s (write-heavy)</td>
<td>For write-intensive clusters, ensure sufficient I/O throughput for data nodes.</td>
<td>SSDs or fast disks are recommended</td>
</tr>
<tr>
<td><strong>Disk Usage Threshold</strong></td>
<td>Keep below 75% disk usage per node</td>
<td>Avoid exceeding 75% disk usage on data nodes to prevent performance degradation.</td>
<td>Monitor for 75% threshold, Elasticsearch throttles at ~85%</td>
</tr>
<tr>
<td><strong>Index Throttle State</strong></td>
<td>Throttles at ~85% disk usage</td>
<td>Elasticsearch throttles indexing if nodes exceed 85% disk usage.</td>
<td>Configure alerts to prevent reaching throttle state</td>
</tr>
<tr>
<td><strong>Memory Usage - Field Data Cache</strong></td>
<td><code>indices.fielddata.cache.size</code> based on available heap</td>
<td>Field data cache size impacts sorting and aggregation speed, stored in memory.</td>
<td>Set to 20-30% of available heap for high-aggregation workloads</td>
</tr>
<tr>
<td><strong>Query Cache Size</strong></td>
<td>10% of heap by default (adjustable)</td>
<td>Caches filter queries to speed up repeated search operations.</td>
<td>Increase for clusters with frequent repetitive queries</td>
</tr>
<tr>
<td><strong>Request Cache Size</strong></td>
<td>Enabled per index, LRU-based</td>
<td>Cache complete search requests, especially useful for aggregation-heavy queries on static data.</td>
<td>Enable on indices with frequent aggregation queries</td>
</tr>
<tr>
<td><strong>Cluster Health</strong></td>
<td><code>GET /_cluster/health</code> (monitor green, yellow, red status)</td>
<td>Regularly monitor cluster health to identify potential issues in shard allocation and node status.</td>
<td>Alerts for yellow or red statuses to detect unallocated shards</td>
</tr>
<tr>
<td><strong>Pending Tasks</strong></td>
<td><code>GET /_cluster/pending_tasks</code></td>
<td>Track the number of pending tasks; delays may signal node or cluster overload.</td>
<td>Monitor to ensure tasks are processed promptly</td>
</tr>
<tr>
<td><strong>CPU Usage per Node</strong></td>
<td>Track via <code>node.cpu.percent</code></td>
<td>Monitor CPU load on nodes, especially data and coordinating nodes handling heavy queries.</td>
<td>Keep below 80% for balanced performance</td>
</tr>
<tr>
<td><strong>Search Latency</strong></td>
<td>Monitor <code>search.fetch_time</code> and <code>search.query_time</code></td>
<td>Search latency metrics indicate performance bottlenecks; high values can suggest tuning is needed.</td>
<td>Target &lt;100ms for interactive queries, &lt;500ms for aggregations</td>
</tr>
<tr>
<td><strong>Indexing Latency</strong></td>
<td>Monitor <code>indexing.index_time</code></td>
<td>Tracks indexing speed; high values indicate indexing bottlenecks.</td>
<td>Optimize disk I/O if consistently high</td>
</tr>
<tr>
<td><strong>GC Pause Time</strong></td>
<td>Track <code>jvm.gc.collection_time</code></td>
<td>Excessive GC pause time (&gt;100ms) can degrade performance, especially on data nodes.</td>
<td>Keep heap usage &lt;75% to avoid frequent GC pauses</td>
</tr>
<tr>
<td><strong>Disk Utilization</strong></td>
<td><code>disk.used_percent</code></td>
<td>Ensure disk usage remains within optimal limits to prevent resource contention.</td>
<td>Monitor for high usage, keep below 75%</td>
</tr>
<tr>
<td><strong>Heap Usage per Node</strong></td>
<td><code>jvm.heap_used_percent</code></td>
<td>Monitor heap usage across nodes; values near 100% can trigger frequent GC and degrade performance.</td>
<td>Keep below 75% for stable performance</td>
</tr>
<tr>
<td><strong>Shard Count per Node</strong></td>
<td>Shards should not exceed 50-75 per data node</td>
<td>Optimal shard count balances memory usage and search latency.</td>
<td>Distribute shards evenly to avoid bottlenecks</td>
</tr>
<tr>
<td><strong>Index Rollover Frequency</strong></td>
<td>Based on data ingestion and retention policy</td>
<td>Use index rollover for high-ingestion use cases to manage shard size and count.</td>
<td>Time-based or size-based rollover (e.g., daily, 10GB)</td>
</tr>
<tr>
<td><strong>Snapshot Frequency</strong></td>
<td>Schedule during off-peak hours</td>
<td>Regular snapshots for backup without affecting active workloads.</td>
<td>Daily or weekly snapshots for disaster recovery</td>
</tr>
<tr>
<td><strong>Ingest Node CPU Requirement</strong></td>
<td>Optimize for transformation-heavy workloads</td>
<td>Ingest nodes need higher CPU for ETL tasks before indexing.</td>
<td>~8 CPUs per ingest node for transformation-heavy clusters</td>
</tr>
<tr>
<td><strong>Write Thread Pool Size</strong></td>
<td>Controlled via <code>thread_pool.write.size</code></td>
<td>Configure thread pool size for write-heavy workloads.</td>
<td>Default based on available processors; increase for high-write loads</td>
</tr>
<tr>
<td><strong>Bulk Thread Pool Size</strong></td>
<td>Set via <code>thread_pool.bulk.size</code></td>
<td>Bulk operations often have separate thread pools, useful for high-ingestion clusters.</td>
<td>Default based on processors; increase if high bulk ingestion</td>
</tr>
<tr>
<td><strong>Query Throughput</strong></td>
<td>Measure <code>search.thread_pool.queue</code></td>
<td>The search queue size indicates if the search load is too high, leading to delays.</td>
<td>Keep queue size low to avoid bottlenecks</td>
</tr>
<tr>
<td><strong>Bulk Queue Size</strong></td>
<td>Monitor <code>bulk.thread_pool.queue</code></td>
<td>Large bulk queue size indicates ingestion pressure; tune for high-ingestion needs.</td>
<td>Increase queue size or add ingest nodes for bulk-heavy workloads</td>
</tr>
<tr>
<td><strong>Network Throughput</strong></td>
<td>Monitor network interface utilization</td>
<td>High network usage can impact inter-node communication, especially during replication.</td>
<td>Ensure sufficient network bandwidth for large clusters</td>
</tr>
<tr>
<td><strong>Network Latency</strong></td>
<td>Track round-trip time between nodes</td>
<td>Low-latency network is critical for distributed search and replication.</td>
<td>&lt;1ms recommended within data centers, 1-5ms for cross-regions</td>
</tr>
</tbody>
</table>
<hr />
<h2 id="questions">Questions<a class="headerlink" href="#questions" title="Permanent link">&para;</a></h2>
<h3 id="1-sql-or-nosql">1. <strong>SQL or NoSQL</strong>:<a class="headerlink" href="#1-sql-or-nosql" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>NoSQL</strong>: Elasticsearch is a NoSQL database designed for search and analytics on structured and unstructured data.</li>
<li><strong>Type of NoSQL</strong>: Document-oriented, storing data as JSON documents.</li>
<li><strong>Supports Polymorphic?</strong>: Yes, Elasticsearch can store documents with varying structures, making it flexible for polymorphic data storage.</li>
</ul>
<h3 id="2-main-feature-origin-and-design">2. <strong>Main Feature, Origin, and Design</strong>:<a class="headerlink" href="#2-main-feature-origin-and-design" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Main Feature</strong>: Optimized for full-text search, analytics, and distributed data storage.</li>
<li><strong>Built For</strong>: Real-time search, logging, and analytics, especially for large datasets.</li>
<li><strong>Developer</strong>: Developed by Shay Banon, later maintained by Elastic.co.</li>
<li><strong>Based on</strong>: Built on top of Apache Lucene.</li>
</ul>
<h3 id="3-olap-or-oltp">3. <strong>OLAP or OLTP</strong>:<a class="headerlink" href="#3-olap-or-oltp" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Primarily OLAP</strong>: Elasticsearch is designed for OLAP workloads like analytics, aggregations, and complex search queries.</li>
<li><strong>Reason</strong>: Its architecture optimizes for high-throughput search and analysis rather than transactional processing.</li>
</ul>
<h3 id="4-acid-or-base">4. <strong>ACID or BASE</strong>:<a class="headerlink" href="#4-acid-or-base" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>BASE</strong>: Elasticsearch is eventually consistent and follows BASE principles. It supports near real-time (NRT) search, not strong consistency.</li>
<li><strong>ACID</strong>: Limited ACID compliance, mostly per-document operations.</li>
</ul>
<h3 id="5-cap-theorem">5. <strong>CAP Theorem</strong>:<a class="headerlink" href="#5-cap-theorem" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>CAP Stance</strong>: Elasticsearch prioritizes Availability and Partition tolerance, with eventual Consistency.<ul>
<li><strong>Consistency</strong>: Provides consistency in the sense that all nodes have the latest data after eventual replication.</li>
<li><strong>Availability</strong>: If a node fails, Elasticsearch reroutes shards to ensure continuous availability.</li>
<li><strong>Partition Tolerance</strong>: Designed to operate in distributed environments with node communication issues.</li>
</ul>
</li>
</ul>
<h3 id="6-cluster-structure">6. <strong>Cluster Structure</strong>:<a class="headerlink" href="#6-cluster-structure" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Cluster</strong>: Comprises multiple nodes working together. Nodes store data and perform search and indexing.</li>
<li><strong>From Cluster to Records</strong>:<ul>
<li><strong>Cluster</strong> → <strong>Nodes</strong> (Master, Data, Coordinating, Ingest) → <strong>Indices</strong> → <strong>Shards</strong> → <strong>Documents</strong> → <strong>Fields/Records</strong>.</li>
</ul>
</li>
</ul>
<h3 id="7-fundamental-building-blocks">7. <strong>Fundamental Building Blocks</strong>:<a class="headerlink" href="#7-fundamental-building-blocks" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Cluster</strong> → <strong>Nodes</strong> → <strong>Indices</strong> → <strong>Shards</strong> → <strong>Segments</strong> → <strong>Documents</strong> → <strong>Fields</strong>.</li>
</ul>
<h3 id="8-multi-master-support">8. <strong>Multi-Master Support</strong>:<a class="headerlink" href="#8-multi-master-support" title="Permanent link">&para;</a></h3>
<ul>
<li>No, Elasticsearch supports only a single active master node at any time. Multiple master-eligible nodes can be elected, but only one acts as the master.</li>
</ul>
<h3 id="9-master-data-node-relation">9. <strong>Master-Data Node Relation</strong>:<a class="headerlink" href="#9-master-data-node-relation" title="Permanent link">&para;</a></h3>
<ul>
<li>Follows <strong>Master-Slave</strong> model: The master node manages cluster state and shard allocation, while data nodes store and manage data.</li>
</ul>
<h3 id="10-node-structures-in-cluster">10. <strong>Node Structures in Cluster</strong>:<a class="headerlink" href="#10-node-structures-in-cluster" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Master Nodes</strong>: Manage the cluster state.</li>
<li><strong>Data Nodes</strong>: Store data and execute search and indexing.</li>
<li><strong>Coordinating Nodes</strong>: Route requests and handle query aggregation.</li>
<li><strong>Ingest Nodes</strong>: Pre-process documents before indexing.</li>
</ul>
<h3 id="11-cluster-scaling-support">11. <strong>Cluster Scaling Support</strong>:<a class="headerlink" href="#11-cluster-scaling-support" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Horizontal Scaling</strong>: Adding more nodes is preferred for scalability and balancing.</li>
<li><strong>Vertical Scaling</strong>: Increasing node capacity is less flexible but possible.</li>
</ul>
<h3 id="12-high-availability">12. <strong>High Availability</strong>:<a class="headerlink" href="#12-high-availability" title="Permanent link">&para;</a></h3>
<ul>
<li>High availability is achieved through replicas and shard redistribution. If a node fails, replicas ensure data accessibility.</li>
</ul>
<h3 id="13-fault-tolerance">13. <strong>Fault Tolerance</strong>:<a class="headerlink" href="#13-fault-tolerance" title="Permanent link">&para;</a></h3>
<ul>
<li>If nodes fail, Elasticsearch automatically reallocates shards to other nodes to ensure continued operation.</li>
</ul>
<h3 id="14-replication">14. <strong>Replication</strong>:<a class="headerlink" href="#14-replication" title="Permanent link">&para;</a></h3>
<ul>
<li>Each shard has one or more replicas. Replicas provide redundancy and improve read throughput.</li>
</ul>
<h3 id="15-partition">15. <strong>Partition</strong>:<a class="headerlink" href="#15-partition" title="Permanent link">&para;</a></h3>
<ul>
<li>Data is divided into partitions known as shards, which can be distributed across nodes.</li>
</ul>
<h3 id="16-sharding">16. <strong>Sharding</strong>:<a class="headerlink" href="#16-sharding" title="Permanent link">&para;</a></h3>
<ul>
<li>An index is divided into shards. Sharding allows horizontal scaling by spreading data across nodes.</li>
</ul>
<h3 id="17-caching-in-depth">17. <strong>Caching in Depth</strong>:<a class="headerlink" href="#17-caching-in-depth" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Filesystem Cache</strong>: OS-level cache for segments and indices.</li>
<li><strong>Shard-level Cache</strong>: Field data cache, query cache, and request cache for faster response on repeated queries.</li>
</ul>
<h3 id="18-storage-type">18. <strong>Storage Type</strong>:<a class="headerlink" href="#18-storage-type" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Tree Structure</strong>: Uses BKD trees and inverted indices for fast search on structured and unstructured data.</li>
<li><strong>Heap and Disk Storage</strong>: Field data and segments stored in-memory and disk for efficient retrieval.</li>
</ul>
<h3 id="19-segmentpage-approach">19. <strong>Segment/Page Approach</strong>:<a class="headerlink" href="#19-segmentpage-approach" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Segments</strong>: Data is written to immutable segments, which are merged periodically.</li>
</ul>
<h3 id="20-trees-for-storage">20. <strong>Trees for Storage</strong>:<a class="headerlink" href="#20-trees-for-storage" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>BKD Trees</strong>: Used for indexing numeric and geospatial data.</li>
<li><strong>Inverted Indices</strong>: Store mappings for full-text search.</li>
</ul>
<h3 id="21-indexing">21. <strong>Indexing</strong>:<a class="headerlink" href="#21-indexing" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>How</strong>: Data is indexed via inverted indices and BKD trees.</li>
<li><strong>Trees Used</strong>: BKD trees for numeric and geospatial data.</li>
</ul>
<h3 id="22-routing">22. <strong>Routing</strong>:<a class="headerlink" href="#22-routing" title="Permanent link">&para;</a></h3>
<ul>
<li>Documents are assigned to shards using hashing, ensuring distribution across nodes.</li>
</ul>
<h3 id="23-latency">23. <strong>Latency</strong>:<a class="headerlink" href="#23-latency" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Write Latency</strong>: Typically 5-10ms.</li>
<li><strong>Read Latency</strong>: 5-20ms.</li>
<li><strong>Indexing Latency</strong>: 10-30ms depending on shard count and node capacity.</li>
<li><strong>Replication Latency</strong>: 20-50ms depending on network and shard replication.</li>
</ul>
<h3 id="24-versioning">24. <strong>Versioning</strong>:<a class="headerlink" href="#24-versioning" title="Permanent link">&para;</a></h3>
<ul>
<li>Elasticsearch supports optimistic concurrency control with versioning at the document level.</li>
</ul>
<h3 id="25-locking-and-concurrency">25. <strong>Locking and Concurrency</strong>:<a class="headerlink" href="#25-locking-and-concurrency" title="Permanent link">&para;</a></h3>
<ul>
<li>Optimistic locking, avoiding traditional locks to allow for distributed updates.</li>
</ul>
<h3 id="26-write-ahead-log-wal">26. <strong>Write-Ahead Log (WAL)</strong>:<a class="headerlink" href="#26-write-ahead-log-wal" title="Permanent link">&para;</a></h3>
<ul>
<li>Elasticsearch does not use traditional WAL but relies on translog for write durability.</li>
</ul>
<h3 id="27-change-data-capture-cdc">27. <strong>Change Data Capture (CDC)</strong>:<a class="headerlink" href="#27-change-data-capture-cdc" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>CDC Support</strong>: Limited; CDC can be simulated with the use of versioning and update tracking.</li>
</ul>
<h3 id="28-query-type-and-query">28. <strong>Query Type and Query</strong>:<a class="headerlink" href="#28-query-type-and-query" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Types</strong>: Full-text, term, range, Boolean, geospatial, and aggregations.</li>
<li><strong>In Depth</strong>: Supports complex queries, scoring, and aggregations for analytics.</li>
</ul>
<h3 id="29-query-optimizers">29. <strong>Query Optimizers</strong>:<a class="headerlink" href="#29-query-optimizers" title="Permanent link">&para;</a></h3>
<ul>
<li>Elasticsearch optimizes queries by caching, narrowing the search, and efficiently reading segments.</li>
</ul>
<h3 id="30-sql-support">30. <strong>SQL Support</strong>:<a class="headerlink" href="#30-sql-support" title="Permanent link">&para;</a></h3>
<ul>
<li>Partial SQL support, primarily for querying via Elasticsearch SQL API.</li>
</ul>
<h3 id="31-circuit-breakers">31. <strong>Circuit Breakers</strong>:<a class="headerlink" href="#31-circuit-breakers" title="Permanent link">&para;</a></h3>
<ul>
<li>Protects cluster stability by setting limits on memory use per request, query, or field data.</li>
</ul>
<h3 id="32-data-retention-lifecycle-management">32. <strong>Data Retention / Lifecycle Management</strong>:<a class="headerlink" href="#32-data-retention-lifecycle-management" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Hot-Warm-Cold Architecture</strong>: Data can be moved between hot (frequent access), warm (less frequent access), and cold (archived) nodes.</li>
</ul>
<h3 id="33-other-features">33. <strong>Other Features</strong>:<a class="headerlink" href="#33-other-features" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Use Cases</strong>: Log analysis, monitoring, analytics, and search-based applications.</li>
</ul>
<h3 id="34-modules-or-libraries">34. <strong>Modules or Libraries</strong>:<a class="headerlink" href="#34-modules-or-libraries" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Extensions</strong>: Elasticsearch can be extended with plugins for monitoring, security, and ingestion.</li>
</ul>
<h3 id="35-optimization-and-tuning">35. <strong>Optimization and Tuning</strong>:<a class="headerlink" href="#35-optimization-and-tuning" title="Permanent link">&para;</a></h3>
<ul>
<li>Includes shard allocation, cache configuration, and query tuning.</li>
</ul>
<h3 id="36-backup-and-recovery">36. <strong>Backup and Recovery</strong>:<a class="headerlink" href="#36-backup-and-recovery" title="Permanent link">&para;</a></h3>
<ul>
<li>Snapshots can be created for backup and restored for recovery.</li>
</ul>
<h3 id="37-security">37. <strong>Security</strong>:<a class="headerlink" href="#37-security" title="Permanent link">&para;</a></h3>
<ul>
<li>Role-based access control, SSL/TLS encryption, and audit logging.</li>
</ul>
<h3 id="38-migration">38. <strong>Migration</strong>:<a class="headerlink" href="#38-migration" title="Permanent link">&para;</a></h3>
<ul>
<li>Tools like reindexing API and snapshot/restore enable data migration between clusters.</li>
</ul>
<h3 id="39-recommended-cluster-setup">39. <strong>Recommended Cluster Setup</strong>:<a class="headerlink" href="#39-recommended-cluster-setup" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Ideal Configuration</strong>: Three master-eligible nodes, at least three data nodes, and coordinating nodes as needed.</li>
</ul>
<h3 id="40-basic-cluster-setup">40. <strong>Basic Cluster Setup</strong>:<a class="headerlink" href="#40-basic-cluster-setup" title="Permanent link">&para;</a></h3>
<ul>
<li><strong>Minimum</strong>: Three nodes for a small distributed setup, with roles depending on workload.</li>
</ul>
<hr />
<h2 id="references">References<a class="headerlink" href="#references" title="Permanent link">&para;</a></h2>
<ol>
<li><a href="https://www.elastic.co/guide/en/elasticsearch/reference/8.15/index.html">https://www.elastic.co/guide/en/elasticsearch/reference/8.15/index.html</a></li>
<li><a href="https://www.hellointerview.com/learn/system-design/deep-dives/elasticsearch">https://www.hellointerview.com/learn/system-design/deep-dives/elasticsearch</a></li>
<li><a href="https://j.blaszyk.me/tech-blog/exploring-apache-lucene-index/">https://j.blaszyk.me/tech-blog/exploring-apache-lucene-index/</a></li>
<li><a href="https://medium.com/swlh/bkd-trees-used-in-elasticsearch-40e8afd2a1a4">https://medium.com/swlh/bkd-trees-used-in-elasticsearch-40e8afd2a1a4</a></li>
<li><a href="https://www.paradedb.com/blog/elasticsearch_vs_postgres">https://www.paradedb.com/blog/elasticsearch_vs_postgres</a></li>
<li><a href="https://nsvarun14.medium.com/capacity-planning-for-elasticsearch-cde3c0693add">https://nsvarun14.medium.com/capacity-planning-for-elasticsearch-cde3c0693add</a></li>
<li><a href="https://fdv.github.io/running-elasticsearch-fun-profit/004-cluster-design/004-cluster-design.html">https://fdv.github.io/running-elasticsearch-fun-profit/004-cluster-design/004-cluster-design.html</a></li>
<li><a href="https://medium.com/@sureshkumar.pawar/sizing-your-elk-elasticsearch-logstash-kibana-cluster-for-high-performance-398fe6e591d4">https://medium.com/@sureshkumar.pawar/sizing-your-elk-elasticsearch-logstash-kibana-cluster-for-high-performance-398fe6e591d4</a></li>
<li><a href="https://www.infoq.com/articles/similarity-scoring-elasticsearch/">https://www.infoq.com/articles/similarity-scoring-elasticsearch/</a></li>
<li><a href="https://www.elastic.co/blog/practical-bm25-part-2-the-bm25-algorithm-and-its-variables">https://www.elastic.co/blog/practical-bm25-part-2-the-bm25-algorithm-and-its-variables</a></li>
<li><a href="https://medium.com/@_niteshsaini_/how-elasticsearch-calculates-its-relevance-score-e762c6274004">https://medium.com/@<em>niteshsaini</em>/how-elasticsearch-calculates-its-relevance-score-e762c6274004</a></li>
</ol>
<hr />







  
    
  
  
    
  


  <aside class="md-source-file">
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Last update">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M21 13.1c-.1 0-.3.1-.4.2l-1 1 2.1 2.1 1-1c.2-.2.2-.6 0-.8l-1.3-1.3c-.1-.1-.2-.2-.4-.2m-1.9 1.8-6.1 6V23h2.1l6.1-6.1zM12.5 7v5.2l4 2.4-1 1L11 13V7zM11 21.9c-5.1-.5-9-4.8-9-9.9C2 6.5 6.5 2 12 2c5.3 0 9.6 4.1 10 9.3-.3-.1-.6-.2-1-.2s-.7.1-1 .2C19.6 7.2 16.2 4 12 4c-4.4 0-8 3.6-8 8 0 4.1 3.1 7.5 7.1 7.9l-.1.2z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 2, 2024</span>
  </span>

    
    
      
  <span class="md-source-file__fact">
    <span class="md-icon" title="Created">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M14.47 15.08 11 13V7h1.5v5.25l3.08 1.83c-.41.28-.79.62-1.11 1m-1.39 4.84c-.36.05-.71.08-1.08.08-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8c0 .37-.03.72-.08 1.08.69.1 1.33.32 1.92.64.1-.56.16-1.13.16-1.72 0-5.5-4.5-10-10-10S2 6.5 2 12s4.47 10 10 10c.59 0 1.16-.06 1.72-.16-.32-.59-.54-1.23-.64-1.92M18 15v3h-3v2h3v3h2v-3h3v-2h-3v-3z"/></svg>
    </span>
    <span class="git-revision-date-localized-plugin git-revision-date-localized-plugin-date">November 1, 2024</span>
  </span>

    
    
    
      
  <span class="md-source-file__fact">
    
      
  <span class="md-icon" title="Contributors">
    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M12 2A10 10 0 0 0 2 12c0 4.42 2.87 8.17 6.84 9.5.5.08.66-.23.66-.5v-1.69c-2.77.6-3.36-1.34-3.36-1.34-.46-1.16-1.11-1.47-1.11-1.47-.91-.62.07-.6.07-.6 1 .07 1.53 1.03 1.53 1.03.87 1.52 2.34 1.07 2.91.83.09-.65.35-1.09.63-1.34-2.22-.25-4.55-1.11-4.55-4.92 0-1.11.38-2 1.03-2.71-.1-.25-.45-1.29.1-2.64 0 0 .84-.27 2.75 1.02.79-.22 1.65-.33 2.5-.33s1.71.11 2.5.33c1.91-1.29 2.75-1.02 2.75-1.02.55 1.35.2 2.39.1 2.64.65.71 1.03 1.6 1.03 2.71 0 3.82-2.34 4.66-4.57 4.91.36.31.69.92.69 1.85V21c0 .27.16.59.67.5C19.14 20.16 22 16.42 22 12A10 10 0 0 0 12 2"/></svg>
  </span>
  <span>GitHub</span>

    
    <nav>
      
        <a href="https://github.com/Luci-MG" class="md-author" title="@Luci-MG">
          
          <img src="https://avatars.githubusercontent.com/u/37269568?v=4&size=72" alt="Luci-MG">
        </a>
      
      
      
    </nav>
  </span>

    
  </aside>





                
              </article>
            </div>
          
          
<script>var target=document.getElementById(location.hash.slice(1));target&&target.name&&(target.checked=target.name.startsWith("__tabbed_"))</script>
        </div>
        
          <button type="button" class="md-top md-icon" data-md-component="top" hidden>
  
  <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M13 20h-2V8l-5.5 5.5-1.42-1.42L12 4.16l7.92 7.92-1.42 1.42L13 8z"/></svg>
  Back to top
</button>
        
      </main>
      
        <footer class="md-footer">
  
    
      
      <nav class="md-footer__inner md-grid" aria-label="Footer" >
        
          
          <a href="../Kafka/" class="md-footer__link md-footer__link--prev" aria-label="Previous: Kafka">
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M20 11v2H8l5.5 5.5-1.42 1.42L4.16 12l7.92-7.92L13.5 5.5 8 11z"/></svg>
            </div>
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Previous
              </span>
              <div class="md-ellipsis">
                Kafka
              </div>
            </div>
          </a>
        
        
          
          <a href="../Redis/" class="md-footer__link md-footer__link--next" aria-label="Next: Redis">
            <div class="md-footer__title">
              <span class="md-footer__direction">
                Next
              </span>
              <div class="md-ellipsis">
                Redis
              </div>
            </div>
            <div class="md-footer__button md-icon">
              
              <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24"><path d="M4 11v2h12l-5.5 5.5 1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5 16 11z"/></svg>
            </div>
          </a>
        
      </nav>
    
  
  <div class="md-footer-meta md-typeset">
    <div class="md-footer-meta__inner md-grid">
      <div class="md-copyright">
  
    <div class="md-copyright__highlight">
      Copyright &copy; 2024 Mrudhul Guda
    </div>
  
  
    Made with
    <a href="https://squidfunk.github.io/mkdocs-material/" target="_blank" rel="noopener">
      Material for MkDocs
    </a>
  
</div>
      
        <div class="md-social">
  
    
    
    
    
      
      
    
    <a href="https://github.com/Luci-MG" target="_blank" rel="noopener" title="github.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 496 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M165.9 397.4c0 2-2.3 3.6-5.2 3.6-3.3.3-5.6-1.3-5.6-3.6 0-2 2.3-3.6 5.2-3.6 3-.3 5.6 1.3 5.6 3.6m-31.1-4.5c-.7 2 1.3 4.3 4.3 4.9 2.6 1 5.6 0 6.2-2s-1.3-4.3-4.3-5.2c-2.6-.7-5.5.3-6.2 2.3m44.2-1.7c-2.9.7-4.9 2.6-4.6 4.9.3 2 2.9 3.3 5.9 2.6 2.9-.7 4.9-2.6 4.6-4.6-.3-1.9-3-3.2-5.9-2.9M244.8 8C106.1 8 0 113.3 0 252c0 110.9 69.8 205.8 169.5 239.2 12.8 2.3 17.3-5.6 17.3-12.1 0-6.2-.3-40.4-.3-61.4 0 0-70 15-84.7-29.8 0 0-11.4-29.1-27.8-36.6 0 0-22.9-15.7 1.6-15.4 0 0 24.9 2 38.6 25.8 21.9 38.6 58.6 27.5 72.9 20.9 2.3-16 8.8-27.1 16-33.7-55.9-6.2-112.3-14.3-112.3-110.5 0-27.5 7.6-41.3 23.6-58.9-2.6-6.5-11.1-33.3 2.6-67.9 20.9-6.5 69 27 69 27 20-5.6 41.5-8.5 62.8-8.5s42.8 2.9 62.8 8.5c0 0 48.1-33.6 69-27 13.7 34.7 5.2 61.4 2.6 67.9 16 17.7 25.8 31.5 25.8 58.9 0 96.5-58.9 104.2-114.8 110.5 9.2 7.9 17 22.9 17 46.4 0 33.7-.3 75.4-.3 83.6 0 6.5 4.6 14.4 17.3 12.1C428.2 457.8 496 362.9 496 252 496 113.3 383.5 8 244.8 8M97.2 352.9c-1.3 1-1 3.3.7 5.2 1.6 1.6 3.9 2.3 5.2 1 1.3-1 1-3.3-.7-5.2-1.6-1.6-3.9-2.3-5.2-1m-10.8-8.1c-.7 1.3.3 2.9 2.3 3.9 1.6 1 3.6.7 4.3-.7.7-1.3-.3-2.9-2.3-3.9-2-.6-3.6-.3-4.3.7m32.4 35.6c-1.6 1.3-1 4.3 1.3 6.2 2.3 2.3 5.2 2.6 6.5 1 1.3-1.3.7-4.3-1.3-6.2-2.2-2.3-5.2-2.6-6.5-1m-11.4-14.7c-1.6 1-1.6 3.6 0 5.9s4.3 3.3 5.6 2.3c1.6-1.3 1.6-3.9 0-6.2-1.4-2.3-4-3.3-5.6-2"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://linkedin.com/in/mrudhul-guda" target="_blank" rel="noopener" title="linkedin.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M100.28 448H7.4V148.9h92.88zM53.79 108.1C24.09 108.1 0 83.5 0 53.8a53.79 53.79 0 0 1 107.58 0c0 29.7-24.1 54.3-53.79 54.3M447.9 448h-92.68V302.4c0-34.7-.7-79.2-48.29-79.2-48.29 0-55.69 37.7-55.69 76.7V448h-92.78V148.9h89.08v40.8h1.3c12.4-23.5 42.69-48.3 87.88-48.3 94 0 111.28 61.9 111.28 142.3V448z"/></svg>
    </a>
  
    
    
    
    
      
      
    
    <a href="https://www.instagram.com/_m._._.g/" target="_blank" rel="noopener" title="www.instagram.com" class="md-social__link">
      <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 448 512"><!--! Font Awesome Free 6.7.1 by @fontawesome - https://fontawesome.com License - https://fontawesome.com/license/free (Icons: CC BY 4.0, Fonts: SIL OFL 1.1, Code: MIT License) Copyright 2024 Fonticons, Inc.--><path d="M224.1 141c-63.6 0-114.9 51.3-114.9 114.9s51.3 114.9 114.9 114.9S339 319.5 339 255.9 287.7 141 224.1 141m0 189.6c-41.1 0-74.7-33.5-74.7-74.7s33.5-74.7 74.7-74.7 74.7 33.5 74.7 74.7-33.6 74.7-74.7 74.7m146.4-194.3c0 14.9-12 26.8-26.8 26.8-14.9 0-26.8-12-26.8-26.8s12-26.8 26.8-26.8 26.8 12 26.8 26.8m76.1 27.2c-1.7-35.9-9.9-67.7-36.2-93.9-26.2-26.2-58-34.4-93.9-36.2-37-2.1-147.9-2.1-184.9 0-35.8 1.7-67.6 9.9-93.9 36.1s-34.4 58-36.2 93.9c-2.1 37-2.1 147.9 0 184.9 1.7 35.9 9.9 67.7 36.2 93.9s58 34.4 93.9 36.2c37 2.1 147.9 2.1 184.9 0 35.9-1.7 67.7-9.9 93.9-36.2 26.2-26.2 34.4-58 36.2-93.9 2.1-37 2.1-147.8 0-184.8M398.8 388c-7.8 19.6-22.9 34.7-42.6 42.6-29.5 11.7-99.5 9-132.1 9s-102.7 2.6-132.1-9c-19.6-7.8-34.7-22.9-42.6-42.6-11.7-29.5-9-99.5-9-132.1s-2.6-102.7 9-132.1c7.8-19.6 22.9-34.7 42.6-42.6 29.5-11.7 99.5-9 132.1-9s102.7-2.6 132.1 9c19.6 7.8 34.7 22.9 42.6 42.6 11.7 29.5 9 99.5 9 132.1s2.7 102.7-9 132.1"/></svg>
    </a>
  
</div>
      
    </div>
  </div>
</footer>
      
    </div>
    <div class="md-dialog" data-md-component="dialog">
      <div class="md-dialog__inner md-typeset"></div>
    </div>
    
      <div class="md-progress" data-md-component="progress" role="progressbar"></div>
    
    
    <script id="__config" type="application/json">{"base": "../../..", "features": ["announce.dismiss", "content.action.edit", "content.code.annotate", "content.code.copy", "content.tooltips", "navigation.expand", "navigation.footer", "navigation.indexes", "navigation.instant", "navigation.instant.progress", "navigation.tabs", "navigation.top", "navigation.tracking", "search.highlight", "search.share", "search.suggest", "toc.follow"], "search": "../../../assets/javascripts/workers/search.6ce7567c.min.js", "translations": {"clipboard.copied": "Copied to clipboard", "clipboard.copy": "Copy to clipboard", "search.result.more.one": "1 more on this page", "search.result.more.other": "# more on this page", "search.result.none": "No matching documents", "search.result.one": "1 matching document", "search.result.other": "# matching documents", "search.result.placeholder": "Type to start searching", "search.result.term.missing": "Missing", "select.version": "Select version"}, "version": {"provider": "mike"}}</script>
    
    
  
      <script src="../../../assets/javascripts/bundle.88dd0f4e.min.js"></script>
      
    
  <script src="../../../assets/javascripts/custom.4e50d00f.min.js"></script>

  </body>
</html>